
###### par(mfrow=c(1,1),cex.lab=1.5,cex.axis=1.25,cex=1.25) #configure axis labels

######set work directory and attach relevant libraries#####
#setwd('C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis')
#setwd('C:/Documents and Settings/Jon/Desktop/Project/Datasets for analysis')
 


##### Note for Valkyrie: above should read: setwd('C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis')
##### Note: for Paladin, above should read: setwd('C:/Documents and Settings/Jon/Desktop/Project/Datasets for analysis')
 
library(stats)
library(MASS)
library(nlme)
library(lmtest)
library(mgcv)
library(nlme)

library(chron)
library(lattice)
library(nlstools)
#?nlstools
library(fitdistrplus)
library(fishmethods)
########## Import data and define variables####

Recruits<-read.csv("/data/cb_ebs_pop_juvenile.csv")
Spawners<-read.csv("Repfem_TS.csv")
attach(Recruits)
attach(Spawners)

#######################################################################################################
####################################### AICc formula ##################################################
# Copyright 2008 Alexander W Blocker
# You are free to use, modify, and redistribute this code under the terms of the GNU
# General Public License, version 2
#

AICc <- function(x, ... , k=2) {
	UseMethod("AICc");
}

AICc.default <- function(x, ... , k=2) {
	if ( length( list( ... ) ) ) {
		x <- list( x, ... );
		val <- lapply( x, logLik );
		val <- as.data.frame( t( sapply( val, function(el) c( attr( el, 
            "df"), AICc( el, k = k) ) ) ) )
		names(val) <- c("df", "AICc")
        row.names(val) <- as.character(match.call()[-1])
        return(val)
	}
	AICc( logLik( x ) );
}

AICc.logLik <- function(x, ... , k=2) {
	-2 * c(x) + k * attr( x, "df" ) + 
		2 * attr( x, "df" ) * ( attr( x, "df" ) + 1 )/
		( attr( x, "nobs" ) - attr( x, "df" ) - 1 );
}

#######################################################################################################
####################################### EDA.norm function #############################################

eda.norm <- function(x, ...)
{
# Examine distribution of data and check against normal distribution
# x is a vector of data. Additional graphics parameters can be supplied
# The function creates a histogram with an empirical density estimate, 
# a boxplot, a normal q-q plot, and a plot of the empirical cumulative
# density function with the corresponding normal cdf. 
# In addition, the function returns the results from the 
# Shapiro-Wilks test of normality
#
# Written by Franz Mueter. Last modified February 24, 2006
#

par(mfrow=c(2,2))
if(sum(is.na(x)) > 0)
warning("NA's were removed before plotting")

x <- x[!is.na(x)]
hist(x, main = "Histogram and non-\nparametric density estimate", prob = T)
iqd <- summary(x)[5] - summary(x)[2]
lines(density(x, width = 2 * iqd))
boxplot(x, main = "Boxplot", ...)
qqnorm(x)
qqline(x)
plot.ecdf(x, main="Empirical and normal cdf")
LIM <- par("usr")
y <- seq(LIM[1],LIM[2],length=100)
lines(y, pnorm(y, mean(x), sqrt(var(x))))
shapiro.test(x)
}


#########################################################################################################
################################### Define baseline Ricker model ########################################
#Ricker <- function(S,a,b){
#a*S*exp(-b*S)
#}
#START <- list(a=1, b=0.01)

#########################################################################################################
############################ Define linearized Ricker model--note log(R/S)= #############################

Ricker <- function(S,a,b){
a+b*S
}
START<-list(a=1,b=0.1)


#########################################################################################################
###########################Define experimental inverse model#############################################
################################# Note: Model disabled ##################################################
#Inverse <- function(S,a){
#a+(1/S)
#}
#START<-list(a=4)

#########################################################################################################
##################################### Analyses using UNEDITTED DATA######################################
######################################Plot of recruits vs spawners#######################################

par(mfrow=c(1,1),cex.lab=1.5,cex.axis=1.25,cex=1.25)
R<-Juv_abun
S<-Repfem_abun
log.R<-log(R)

acf(R,main="ACF correlogram for EBS juvenile recruitment estimates")
#?acf()
#########################################################################################################

#Graphically evaluate reproductive female data
for(i in names(Spawners)) {		# cycle through all names in data frame
	x <- Spawners$Year			# convert to numeric variable
	y <- Spawners[,i]
	# Plot time series for variable i using both points and lines. 
	# Suppress default axis labels and add variable name as title:
	plot(x, y, type = "b", xlab="", ylab="", main = i,pch=16)
	# Fit linear time trend and add line to plot:
	abline(lm(y ~ x), col=4)
	# Fit a LOWESS (or LOESS) smooth trend and add to plot:
	fit <- loess(y ~ x)	
	lines(x, fitted(fit), col=2)	# Add fitted line
}
#######################################################################################################

#Graphically evaluate juvenile data
for(i in names(Recruits)) {		# cycle through all names in data frame
	x <- Recruits$Year			# convert to numeric variable
	y <- Recruits[,i]
	# Plot time series for variable i using both points and lines. 
	# Suppress default axis labels and add variable name as title:
	plot(x, y, type = "b", xlab="", ylab="", main = i,pch=16)
	# Fit linear time trend and add line to plot:
	abline(lm(y ~ x), col=4)
	# Fit a LOWESS (or LOESS) smooth trend and add to plot:
	fit <- loess(y ~ x)	
	lines(x, fitted(fit), col=2)	# Add fitted line
}


########################################################################################################################
####################################### EDA.norm analyses of R #########################################################

eda.norm(R)
eda.norm(log.R)

########################################################################################################################

for(i in names(Spawners)) {		# cycle through all names in data frame
	x <- Spawners$Year			# convert to numeric variable
	y <- Spawners[,i]
	# Plot time series for variable i using both points and lines. 
	# Suppress default axis labels and add variable name as title:
	plot(x, y, type = "b", xlab="", ylab="", main = i,pch=16)
	# Fit linear time trend and add line to plot:
}

########################################################################################################################
####################################### Plot all females together ######################################################


y.range<-range(0,4e+08)
par(mfrow=c(1,1),cex.main=1.5, cex.lab=1.5,cex.axis=1.25,cex=1.25) #configure axis labels
names(Spawners)
W166<-Spawners$X166W.abun
EBS<-Spawners$Repfem_abun
E166<-Spawners$X166E.abun
plot(EBS)
plot(EBS,type="b",ylim=y.range, pch=16,col=4,axes=FALSE,ann=FALSE)
lines(W166,type="b",pch=20,col=1)
lines(E166,type="b",pch=22,col=2)

axis(1, at=1:28,lab=Spawners$Year)
axis(2, las=1, at=1e+08*0:4)
legend(8,4e+08,c("EBS female estimate", "166W female estimate", "166E female estimate"),cex=1,col=c(4,1,2),pch=c(16,20,22))


#########################################################################################################################
################################## Plot all juveniles together ##########################################################
EBS.Recruits<-read.csv("Juvenile_abundance.csv")
W166.Recruits<-read.csv("166W_juvenile_abundance.csv")
E166.Recruits<-read.csv("166E_juvenile_abundance.csv")

names(EBS.Recruits)
names(W166.Recruits)
names(E166.Recruits)

W166<-W166.Recruits$Juv_abun
E166<-E166.Recruits$Juv_abun
EBS<-EBS.Recruits$Juv_abun

par(mfrow=c(1,3))
plot(EBS)
plot(E166)
plot(W166)

par(mfrow=c(1,1),cex.lab=1.5,cex.axis=1.25,cex=1.25) #configure axis labels
y.range<-range(0,9e+08)

plot(EBS)
plot(EBS,type="b",ylim=y.range, pch=16,col=4,axes=FALSE,ann=FALSE)
lines(W166,type="b",pch=18,col=1)
lines(E166,type="b",pch=22,col=2)
abline(h=0)

axis(1, at=1:28,lab=Spawners$Year,tck=0.03)
axis(2, las=1, at=1e+08*0:9)
legend(15,9e+08,c("EBS juvenile estimate", "166W juvenile estimate", "166E juvenile estimate"),cex=1,col=c(4,1,2),pch=c(16,18,22))

#########################################################################################################################
###################################### Plot juv abundance separately ####################################################

Year<-Recruits$Year
plot(R~Year, type="b",ylab="Estimated abundance of EBS juvenile bairdi", xlab="Year", main = "Estimated abundance of EBS juvenile bairdi",pch=16)
abline(lm(R ~ Year), col=4)
fit <- loess(R ~ Year)
lines(x, fitted(fit), col=2)






#########################################################################################################################
########################################### Lag=2 #######################################################################
par(mfrow=c(2,2))

plot(R~Recruits$Year, ylab="Estimated juvenile abundance", xlab="Year", pch=16)
plot(S~Spawners$Year, ylab="Estimated reproductive female crab abundance", xlab="Year",pch=16)




#########################################Define data for lag=2####################
par(mfrow=c(2,2))
R<-Juv_abun
S<-Repfem_abun

xi<-S
xyear<-Spawners$Year
yi<-R
yyear<-Recruits$Year
lag <- 2				
n <- length(yi)-1			########Note change from xi and addtion of -1 to allow for different length in yi as compared to xi
xi.k <- xi[1:(n-lag)]       # Select reproductive female estimates values
xyear.k<-xyear[1:(n-lag)]   # Select corresponding years
xyear.k
S<-xi.k 
yi.k <- yi[(lag+1):n]       # Select Juvenile recruitment estimates'lag' years later
R<-yi.k
yyear.k<-yyear[(lag+1):n]   # Select years corresponding to juvenile recruitment estimates
yyear.k
plot(yi.k~xi.k,xlab="Reproductive female abundance", ylab="Lag 2 juvenile recruitment", pch=16,col=4)

###################################EDA.norm analysis of log(R/S)########################
log.RS<-log(R/S)
eda.norm(log.RS)

########################################Fit Ricker model#########################################

Rick.fit<-nls(log(R/S) ~ Ricker(S,a,b),start=START, na.action=na.omit)
summary(Rick.fit)

plot(log(R/S)~S, xlab="Reproductive female abundance",ylab="lag 2 log(Recruits/Repfem)",pch=16)
abline(Rick.fit)

#plot(Rick.fit)
#identify(S,log(R/S))

r0<-resid(Rick.fit)
#plot(r0,pch=16)
r.fit2<-loess(r0~xyear.k)
plot(r.fit2,pch=16,xlab="Hatch year", ylab="Lag 2 S/R residuals")
#lines(r.fit2)
lines(xyear.k,fitted(r.fit2))


####################################Fit gls models with 1st and 2nd order autocorrelation######################

Fit3<-gls(log(R/S)~S,correlation=corAR1(), na.action=na.omit)
summary(Fit3)
plot(log(R/S)~S, xlab="Reproductive female abundance",ylab="lag 3 log(Recruits/Repfem)",pch=16)
abline(Fit3)
plot(Fit3)

r1<-resid(Fit3)
#plot(1r,pch=16)
r.fit3<-loess(r1~xyear.k)
plot(r.fit3,pch=16,xlab="Hatch year", ylab="Lag 2 S/R residuals")
lines(xyear.k,fitted(r.fit3),col=4)


Fit4<-gls(log(R/S)~S,correlation=corARMA(p=2))
summary(Fit4)

########################################################################################################
######################################### Lag=3 ########################################################
par(mfrow=c(1,1),cex.main=1.5, cex.lab=1.25,cex.axis=1.25,cex=1.25) #configure axis labels
R<-Juv_abun
S<-Repfem_abun
release.year<-c(1978:2005)

xi<-S
xyear<-Spawners$Year
yi<-R
yyear<-Recruits$Year
lag <- 3
n <- length(yi)			##########note change from xi as previously employed
xi.k <- xi[1:(n-lag)]       # Select reproductive female ests
S<-xi.k
xyear.k<-xyear[1:(n-lag)]   # Select corresponding years
xyear.k
yi.k <- yi[(lag+1):n]       # Select Juvenile recruitment estimates'lag' years later
R<-yi.k 
yyear.k<-yyear[(lag+1):n]   # Select years corresponding to juvenile recruitment estimates
yyear.k
plot(yi.k~xi.k,xlab="Reproductive female abundance", ylab="Lag 3 juvenile recruitment", main= "EBS lag 3 S/R comparison",pch=16,col=4,cex=1.25)


##############################################EDA.norm analyses of log(R/S)#############################
eda.norm(R)
log.RS<-log(R/S)
eda.norm(log.RS)

##############################################Fit Ricker model##########################################

Rick.fit2<-nls(log(R/S) ~ Ricker(S,a,b),start=START)
summary(Rick.fit2)
plot(log(R/S)~S, xlab="Reproductive female abundance",ylab="lag 3 log(Recruits/Repfem)",main="EBS lag 3 Ricker model",pch=16)
abline(Rick.fit2)


r2<-resid(Rick.fit2)
r.fit2<-loess(r2~xyear.k)
plot(r.fit2,xlab="Hatch year",ylab="EBS lag 3 S/R residuals",pch=16)
lines(xyear.k,fitted(r.fit2))

par(mfrow=c(1,1),cex.main=1.5, cex.lab=1.25,cex.axis=1.25,cex=1.25) #configure axis labels
plot(r.fit2,xlab="Hatch year",ylab="EBS lag 3 S/R residuals",pch=16)
lines(xyear.k,fitted(r.fit2))
par(mfrow=c(2,2))

#lines(r.fit2)
#plot(r2,pch=16)
#identify(S,log(R/S))
#plot(Rick.fit2)

#################################Fit gls model with 1st order autocorrelation#######################################################

Fit3<-gls(log(R/S)~S,correlation=corAR1(), na.action=na.omit)
summary(Fit3)
plot(log(R/S)~S, xlab="Reproductive female abundance",ylab="lag 3 log(Recruits/Repfem)",main="EBS group lag 3 Ricker model",pch=16)
abline(Fit3)
#plot(Fit3)

par(mfrow=c(1,1),cex.main=1.5, cex.lab=1.25,cex.axis=1.25,cex=1.25) #configure axis labels
r3<-resid(Fit3)
#plot(r3,pch=16)
r.fit3<-loess(r3~xyear.k,span=0.25)
plot(r.fit3,pch=16,xlab="Hatch year", ylab="Lag 3 S/R residuals",main="Interdecadal trend in EBS group S/R residuals")
lines(xyear.k,fitted(r.fit3),col=4)


Fit4<-gls(log(R/S)~S,correlation=corARMA(p=2))
summary(Fit4)



#########################################################################################################################
############################################### Drop data point #5  #####################################################
#########################################################################################################################
R2<-R[-5]
R2
R
S2<-S[-5]



Fit5<-gls(log(R2/S2)~S2,correlation=corAR1(), na.action=na.omit)
summary(Fit5)
plot(log(R2/S2)~S2, xlab="Reproductive female abundance",ylab="lag 3 log(Recruits/Repfem)",pch=16)
abline(Fit5)
#plot(Fit5)


par(mfrow=c(1,1))
r6<-resid(Fit5)
xyear<-xyear.k[-5]
#plot(r6,pch=16)
r.fit5<-loess(r6~xyear,span=0.5)
plot(r.fit5,pch=16,xlab="Hatch year", ylab="Lag 3 S/R residuals")
lines(xyear,fitted(r.fit5),col=4)


##############################################################################################################################
################################################# Lag=4 ######################################################################
par(mfrow=c(1,1))
R<-Juv_abun
S<-Repfem_abun
release.year<-c(1978:2004)

xi<-S
xyear<-Spawners$Year
yi<-R
yyear<-Recruits$Year
lag <- 4
n <- length(yi)			##########note change from xi as previously employed
xi.k <- xi[1:(n-lag)]       # Select reproductive female ests
S<-xi.k
xyear.k<-xyear[1:(n-lag)]   # Select corresponding years
xyear.k
yi.k <- yi[(lag+1):n]       # Select Juvenile recruitment estimates'lag' years later
R<-yi.k 
yyear.k<-yyear[(lag+1):n]   # Select years corresponding to juvenile recruitment estimates
yyear.k
plot(yi.k~xi.k,xlab="Reproductive female abundance", ylab="Lag 4 juvenile recruitment",pch=16,col=4)


############################################## EDA.norm analyses of log(R/S)#############################
eda.norm(R)
log.RS<-log(R/S)
eda.norm(log.RS)

##################################################################################################################################
################################################### Fit Ricker model##############################################################

Rick.fit3<-gnls(log(R/S) ~ Ricker(S,a,b),start=START)
summary(Rick.fit3)
plot(log(R/S)~S, xlab="Reproductive female abundance",ylab="lag 4 log(Recruits/Repfem)",pch=16)
abline(Rick.fit2)


r4<-resid(Rick.fit3)
r.fit4<-loess(r4~xyear.k)
plot(r.fit3,xlab="Hatch year",ylab="Lag 4 S/R residuals",pch=16)
lines(xyear.k,fitted(r.fit4))

#lines(r.fit2)
#plot(r2,pch=16)
#identify(S,log(R/S))
#plot(Rick.fit2)

####################################################################################################################################
############################################## Fit gls model with 1st order autocorrelation ########################################

Fit5<-gls(log(R/S)~S,correlation=corAR1(), na.action=na.omit)
summary(Fit5)

plot(log(R/S)~S, xlab="Reproductive female abundance",ylab="lag 4 log(Recruits/Repfem)",pch=16)
abline(Fit5)
#plot(Fit3)

par(mfrow=c(1,1))
r5<-resid(Fit3)
#plot(r5,pch=16)
r.fit5<-loess(r5~xyear.k)
plot(r.fit5,pch=16,xlab="Hatch year", ylab="Lag 4 S/R residuals")
lines(xyear.k,fitted(r.fit5),col=4)


Fit6<-gls(log(R/S)~S,correlation=corARMA(p=2))
summary(Fit6)

###### par(mfrow=c(1,1),cex.lab=1.5,cex.axis=1.25,cex=1.25) #configure axis labels

######set work directory and attach relevant libraries#####

s
#######################################################################################################################################
############################################### Designate residual series to use in modeling##########################################
######################################################################################################################################
r
r<-r3

#########################################################################################################################################
########################################## Analyze S/R residuals against environmental variables ######################################################
#########################################################################################################################################

Year<-c(1981:2008)
resid.series<-cbind(Year,r)  #pairs year of recruitment to index with S/R residual of that pseudocohort
resid.series
plot(resid.series,ylab="Lag 3 S/R residual",xlab="Year",pch=16)



######################################################################################################################################################
################################################### Analyze Lag 3 S/R residuals against NCAR/NCEP wind vector components ##############################
##############################set work directory and attach relevant libraries###############################################
setwd('C:/Documents and Settings/Jon/Desktop/Project/Datasets for analysis')


##### Note for Valkyrie: above should read: setwd('C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis')
##### Note: for Paladin, above should read: setwd('C:/Documents and Settings/Jon/Desktop/Project/Datasets for analysis')

library(MASS)
library(nlme)
library(lmtest)
library(mgcv)
library(nlme)
library(ncdf)
library(chron)
library(lattice)
library(nlstools)

############################################################################################################################
################################################### Import data ############################################################

#ufiles <- choose.files()
#vfiles <- choose.files()

############################################################################################################################
################################################### Check the dataset#######################################################

#ufiles    
#vfiles

############################################################################################################################
################################################### 1978 ###################################################################
################################################### Extract u-component and calculate means by time ########################
#u.wind.1978<-open.ncdf(file.choose())

u.wind.1978<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1978.nc")
u.wind.1978<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1978.nc")
u.wind.1978

get.var.ncdf(u.wind.1978, "lon")     # view longitudes 
get.var.ncdf(u.wind.1978, "lat")     # view latitudes
get.var.ncdf(u.wind.1978, "time")	 # view times
get.var.ncdf(u.wind.1978,"uwnd")


X <- get.var.ncdf(u.wind.1978,"uwnd")


May.78U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.78U
mean(May.78U)
mean.May.78U<-mean(May.78U)

June.78U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.78U
mean(June.78U)
mean.June.78U<-mean(June.78U)

July.78U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.78U
mean(July.78U)
mean.July.78U<-mean(July.78U)

May.June.78U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.78U
mean(May.June.78U)
mean.May.June.78U<-mean(May.June.78U)

JJ.78U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.78U
mean(JJ.78U)
mean.JJ.78U<-mean(JJ.78U)

May.July.78U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.78U
mean(May.July.78U)
mean.May.July.78U<-mean(May.July.78U)


#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1978<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1978.nc")
v.wind.1978<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1978.nc")
#v.wind.1978

#get.var.ncdf(v.wind.1978, "lon")     # view longitudes 
#get.var.ncdf(v.wind.1978, "lat")     # view latitudes
#get.var.ncdf(v.wind.1978, "time")	 # view times
#get.var.ncdf(v.wind.1978,"vwnd")


Y<- get.var.ncdf(v.wind.1978,"vwnd")


May.78V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.78V
mean(May.78V)
mean.May.78V<-mean(May.78V)

June.78V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.78V
mean(June.78V)
mean.June.78V<-mean(June.78V)

July.78V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.78V
mean(July.78V)
mean.July.78V<-mean(July.78V)

May.June.78V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.78V
mean(May.June.78V)
mean.May.June.78V<-mean(May.June.78V)

JJ.78V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.78V
mean(JJ.78V)
mean.JJ.78V<-mean(JJ.78V)

May.July.78V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.78V
mean(May.July.78V)
mean.May.July.78V<-mean(May.July.78V)

############################################################################################################################
################################################### 1979 ###################################################################
################################################### Extract u-component and calculate means by time ########################


u.wind.1979<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1979.nc")
u.wind.1979<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1979.nc")
u.wind.1979

get.var.ncdf(u.wind.1979, "lon")     # view longitudes 
get.var.ncdf(u.wind.1979, "lat")     # view latitudes
get.var.ncdf(u.wind.1979, "time")	 # view times
get.var.ncdf(u.wind.1979,"uwnd")


X <- get.var.ncdf(u.wind.1979,"uwnd")


May.79U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.79U
mean(May.79U)
mean.May.79U<-mean(May.79U)

June.79U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.79U
mean(June.79U)
mean.June.79U<-mean(June.79U)

July.79U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.79U
mean(July.79U)
mean.July.79U<-mean(July.79U)

May.June.79U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.79U
mean(May.June.79U)
mean.May.June.79U<-mean(May.June.79U)

JJ.79U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.79U
mean(JJ.79U)
mean.JJ.79U<-mean(JJ.79U)

May.July.79U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.79U
mean(May.July.79U)
mean.May.July.79U<-mean(May.July.79U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1979<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1979.nc")
v.wind.1979<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1979.nc")
v.wind.1979

get.var.ncdf(v.wind.1979, "lon")     # view longitudes 
get.var.ncdf(v.wind.1979, "lat")     # view latitudes
get.var.ncdf(v.wind.1979, "time")	 # view times
get.var.ncdf(v.wind.1979,"vwnd")


Y<- get.var.ncdf(v.wind.1979,"vwnd")


May.79V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.79V
mean(May.79V)
mean.May.79V<-mean(May.79V)

June.79V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.79V
mean(June.79V)
mean.June.79V<-mean(June.79V)

July.79V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.79V
mean(July.79V)
mean.July.79V<-mean(July.79V)

May.June.79V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.79V
mean(May.June.79V)
mean.May.June.79V<-mean(May.June.79V)

JJ.79V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.79V
mean(JJ.79V)
mean.JJ.79V<-mean(JJ.79V)

May.July.79V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.79V
mean(May.July.79V)
mean.May.July.79V<-mean(May.July.79V)


############################################################################################################################
################################################### 1980 ###################################################################
################################################### Extract u-component and calculate means by time ########################
#u.wind.1978<-open.ncdf(file.choose())

u.wind.1980<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1980.nc")
u.wind.1980<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1980.nc")
u.wind.1980

get.var.ncdf(u.wind.1980, "lon")     # view longitudes 
get.var.ncdf(u.wind.1980, "lat")     # view latitudes
get.var.ncdf(u.wind.1980, "time")	 # view times
get.var.ncdf(u.wind.1980,"uwnd")


X <- get.var.ncdf(u.wind.1980,"uwnd")


May.80U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.80U
mean(May.80U)
mean.May.80U<-mean(May.80U)

June.80U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.80U
mean(June.80U)
mean.June.80U<-mean(June.80U)

July.80U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.80U
mean(July.80U)
mean.July.80U<-mean(July.80U)

May.June.80U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.80U
mean(May.June.80U)
mean.May.June.80U<-mean(May.June.80U)

JJ.80U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.80U
mean(JJ.80U)
mean.JJ.80U<-mean(JJ.80U)

May.July.80U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.80U
mean(May.July.80U)
mean.May.July.80U<-mean(May.July.80U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1980<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1980.nc")
v.wind.1980<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1980.nc")
v.wind.1980

get.var.ncdf(v.wind.1980, "lon")     # view longitudes 
get.var.ncdf(v.wind.1980, "lat")     # view latitudes
get.var.ncdf(v.wind.1980, "time")	 # view times
get.var.ncdf(v.wind.1980,"vwnd")


Y<- get.var.ncdf(v.wind.1980,"vwnd")


May.80V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.80V
mean(May.80V)
mean.May.80V<-mean(May.80V)

June.80V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.80V
mean(June.80V)
mean.June.80V<-mean(June.80V)

July.80V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.80V
mean(July.80V)
mean.July.80V<-mean(July.80V)

May.June.80V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.80V
mean(May.June.80V)
mean.May.June.80V<-mean(May.June.80V)

JJ.80V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.80V
mean(JJ.80V)
mean.JJ.80V<-mean(JJ.80V)

May.July.80V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.80V
mean(May.July.80V)
mean.May.July.80V<-mean(May.July.80V)

############################################################################################################################
################################################### 1981 ###################################################################
################################################### Extract u-component and calculate means by time ########################
#u.wind.1978<-open.ncdf(file.choose())

u.wind.1981<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1981.nc")
u.wind.1981<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1981.nc")
u.wind.1981

get.var.ncdf(u.wind.1981, "lon")     # view longitudes 
get.var.ncdf(u.wind.1981, "lat")     # view latitudes
get.var.ncdf(u.wind.1981, "time")	 # view times
get.var.ncdf(u.wind.1981,"uwnd")


X <- get.var.ncdf(u.wind.1981,"uwnd")


May.81U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.81U
mean(May.81U)
mean.May.81U<-mean(May.81U)

June.81U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.81U
mean(June.81U)
mean.June.81U<-mean(June.81U)

July.81U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.81U
mean(July.81U)
mean.July.81U<-mean(July.81U)

May.June.81U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.81U
mean(May.June.81U)
mean.May.June.81U<-mean(May.June.81U)

JJ.81U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.81U
mean(JJ.81U)
mean.JJ.81U<-mean(JJ.81U)

May.July.81U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.81U
mean(May.July.81U)
mean.May.July.81U<-mean(May.July.81U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1981<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1981.nc")
v.wind.1981<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1981.nc")
v.wind.1981

get.var.ncdf(v.wind.1981, "lon")     # view longitudes 
get.var.ncdf(v.wind.1981, "lat")     # view latitudes
get.var.ncdf(v.wind.1981, "time")	 # view times
get.var.ncdf(v.wind.1981,"vwnd")


Y<- get.var.ncdf(v.wind.1981,"vwnd")


May.81V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.81V
mean(May.81V)
mean.May.81V<-mean(May.81V)

June.81V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.81V
mean(June.81V)
mean.June.81V<-mean(June.81V)

July.81V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.81V
mean(July.81V)
mean.July.81V<-mean(July.81V)

May.June.81V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.81V
mean(May.June.81V)
mean.May.June.81V<-mean(May.June.81V)

JJ.81V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.81V
mean(JJ.81V)
mean.JJ.81V<-mean(JJ.81V)

May.July.81V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.81V
mean(May.July.81V)
mean.May.July.81V<-mean(May.July.81V)

############################################################################################################################
################################################### 1982 ###################################################################
################################################### Extract u-component and calculate means by time ########################
#u.wind.1978<-open.ncdf(file.choose())

u.wind.1982<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1982.nc")
u.wind.1982<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1982.nc")
u.wind.1982

get.var.ncdf(u.wind.1982, "lon")     # view longitudes 
get.var.ncdf(u.wind.1982, "lat")     # view latitudes
get.var.ncdf(u.wind.1982, "time")	 # view times
get.var.ncdf(u.wind.1982,"uwnd")


X <- get.var.ncdf(u.wind.1982,"uwnd")


May.82U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.82U
mean(May.82U)
mean.May.82U<-mean(May.82U)

June.82U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.82U
mean(June.82U)
mean.June.82U<-mean(June.82U)

July.82U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.82U
mean(July.82U)
mean.July.82U<-mean(July.82U)

May.June.82U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.82U
mean(May.June.82U)
mean.May.June.82U<-mean(May.June.82U)

JJ.82U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.82U
mean(JJ.82U)
mean.JJ.82U<-mean(JJ.82U)

May.July.82U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.82U
mean(May.July.82U)
mean.May.July.82U<-mean(May.July.82U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1982<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1982.nc")
v.wind.1982<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1982.nc")
v.wind.1982

get.var.ncdf(v.wind.1982, "lon")     # view longitudes 
get.var.ncdf(v.wind.1982, "lat")     # view latitudes
get.var.ncdf(v.wind.1982, "time")	 # view times
get.var.ncdf(v.wind.1982,"vwnd")


Y<- get.var.ncdf(v.wind.1982,"vwnd")


May.82V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.82V
mean(May.82V)
mean.May.82V<-mean(May.82V)

June.82V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.82V
mean(June.82V)
mean.June.82V<-mean(June.82V)

July.82V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.82V
mean(July.82V)
mean.July.82V<-mean(July.82V)

May.June.82V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.82V
mean(May.June.82V)
mean.May.June.82V<-mean(May.June.82V)

JJ.82V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.82V
mean(JJ.82V)
mean.JJ.82V<-mean(JJ.82V)

May.July.82V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.82V
mean(May.July.82V)
mean.May.July.82V<-mean(May.July.82V)

############################################################################################################################
################################################### 1983 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.1983<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1983.nc")
u.wind.1983<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1983.nc")
u.wind.1983

get.var.ncdf(u.wind.1983, "lon")     # view longitudes 
get.var.ncdf(u.wind.1983, "lat")     # view latitudes
get.var.ncdf(u.wind.1983, "time")	 # view times
get.var.ncdf(u.wind.1983,"uwnd")


X <- get.var.ncdf(u.wind.1983,"uwnd")


May.83U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.83U
mean(May.83U)
mean.May.83U<-mean(May.83U)

June.83U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.83U
mean(June.83U)
mean.June.83U<-mean(June.83U)

July.83U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.83U
mean(July.83U)
mean.July.83U<-mean(July.83U)

May.June.83U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.83U
mean(May.June.83U)
mean.May.June.83U<-mean(May.June.83U)

JJ.83U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.83U
mean(JJ.83U)
mean.JJ.83U<-mean(JJ.83U)

May.July.83U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.83U
mean(May.July.83U)
mean.May.July.83U<-mean(May.July.83U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1983<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1983.nc")
v.wind.1983<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1983.nc")
v.wind.1983

get.var.ncdf(v.wind.1983, "lon")     # view longitudes 
get.var.ncdf(v.wind.1983, "lat")     # view latitudes
get.var.ncdf(v.wind.1983, "time")	 # view times
get.var.ncdf(v.wind.1983,"vwnd")


Y<- get.var.ncdf(v.wind.1983,"vwnd")


May.83V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.83V
mean(May.83V)
mean.May.83V<-mean(May.83V)

June.83V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.83V
mean(June.83V)
mean.June.83V<-mean(June.83V)

July.83V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.83V
mean(July.83V)
mean.July.83V<-mean(July.83V)

May.June.83V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.83V
mean(May.June.83V)
mean.May.June.83V<-mean(May.June.83V)

JJ.83V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.83V
mean(JJ.83V)
mean.JJ.83V<-mean(JJ.83V)

May.July.83V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.83V
mean(May.July.83V)
mean.May.July.83V<-mean(May.July.83V)

############################################################################################################################
################################################### 1984 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.1984<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1984.nc")
u.wind.1984<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1984.nc")
u.wind.1984

get.var.ncdf(u.wind.1984, "lon")     # view longitudes 
get.var.ncdf(u.wind.1984, "lat")     # view latitudes
get.var.ncdf(u.wind.1984, "time")	 # view times
get.var.ncdf(u.wind.1984,"uwnd")


X <- get.var.ncdf(u.wind.1984,"uwnd")


May.84U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.84U
mean(May.84U)
mean.May.84U<-mean(May.84U)

June.84U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.84U
mean(June.84U)
mean.June.84U<-mean(June.84U)

July.84U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.84U
mean(July.84U)
mean.July.84U<-mean(July.84U)

May.June.84U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.84U
mean(May.June.84U)
mean.May.June.84U<-mean(May.June.84U)

JJ.84U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.84U
mean(JJ.84U)
mean.JJ.84U<-mean(JJ.84U)

May.July.84U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.84U
mean(May.July.84U)
mean.May.July.84U<-mean(May.July.84U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1984<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1984.nc")
v.wind.1984<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1984.nc")
v.wind.1984

get.var.ncdf(v.wind.1984, "lon")     # view longitudes 
get.var.ncdf(v.wind.1984, "lat")     # view latitudes
get.var.ncdf(v.wind.1984, "time")	 # view times
get.var.ncdf(v.wind.1984,"vwnd")


Y<- get.var.ncdf(v.wind.1984,"vwnd")


May.84V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.84V
mean(May.84V)
mean.May.84V<-mean(May.84V)

June.84V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.84V
mean(June.84V)
mean.June.84V<-mean(June.84V)

July.84V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.84V
mean(July.84V)
mean.July.84V<-mean(July.84V)

May.June.84V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.84V
mean(May.June.84V)
mean.May.June.84V<-mean(May.June.84V)

JJ.84V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.84V
mean(JJ.84V)
mean.JJ.84V<-mean(JJ.84V)

May.July.84V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.84V
mean(May.July.84V)
mean.May.July.84V<-mean(May.July.84V)

############################################################################################################################
################################################### 1985 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.1985<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1985.nc")
u.wind.1985<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1985.nc")
u.wind.1985

get.var.ncdf(u.wind.1985, "lon")     # view longitudes 
get.var.ncdf(u.wind.1985, "lat")     # view latitudes
get.var.ncdf(u.wind.1985, "time")	 # view times
get.var.ncdf(u.wind.1985,"uwnd")


X <- get.var.ncdf(u.wind.1985,"uwnd")


May.85U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.85U
mean(May.85U)
mean.May.85U<-mean(May.85U)

June.85U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.85U
mean(June.85U)
mean.June.85U<-mean(June.85U)

July.85U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.85U
mean(July.85U)
mean.July.85U<-mean(July.85U)

May.June.85U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.85U
mean(May.June.85U)
mean.May.June.85U<-mean(May.June.85U)

JJ.85U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.85U
mean(JJ.85U)
mean.JJ.85U<-mean(JJ.85U)

May.July.85U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.85U
mean(May.July.85U)
mean.May.July.85U<-mean(May.July.85U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1985<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1985.nc")
v.wind.1985<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1985.nc")
v.wind.1985

get.var.ncdf(v.wind.1985, "lon")     # view longitudes 
get.var.ncdf(v.wind.1985, "lat")     # view latitudes
get.var.ncdf(v.wind.1985, "time")	 # view times
get.var.ncdf(v.wind.1985,"vwnd")


Y<- get.var.ncdf(v.wind.1985,"vwnd")


May.85V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.85V
mean(May.85V)
mean.May.85V<-mean(May.85V)

June.85V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.85V
mean(June.85V)
mean.June.85V<-mean(June.85V)

July.85V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.85V
mean(July.85V)
mean.July.85V<-mean(July.85V)

May.June.85V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.85V
mean(May.June.85V)
mean.May.June.85V<-mean(May.June.85V)

JJ.85V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.85V
mean(JJ.85V)
mean.JJ.85V<-mean(JJ.85V)

May.July.85V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.85V
mean(May.July.85V)
mean.May.July.85V<-mean(May.July.85V)

############################################################################################################################
################################################### 1986 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.1986<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1986.nc")
u.wind.1986<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1986.nc")

u.wind.1986

get.var.ncdf(u.wind.1986, "lon")     # view longitudes 
get.var.ncdf(u.wind.1986, "lat")     # view latitudes
get.var.ncdf(u.wind.1986, "time")	 # view times
get.var.ncdf(u.wind.1986,"uwnd")


X <- get.var.ncdf(u.wind.1986,"uwnd")


May.86U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.86U
mean(May.86U)
mean.May.86U<-mean(May.86U)

June.86U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.86U
mean(June.86U)
mean.June.86U<-mean(June.86U)

July.86U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.86U
mean(July.86U)
mean.July.86U<-mean(July.86U)

May.June.86U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.86U
mean(May.June.86U)
mean.May.June.86U<-mean(May.June.86U)

JJ.86U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.86U
mean(JJ.86U)
mean.JJ.86U<-mean(JJ.86U)

May.July.86U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.86U
mean(May.July.86U)
mean.May.July.86U<-mean(May.July.86U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1986<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1986.nc")
v.wind.1986<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1986.nc")

v.wind.1986

get.var.ncdf(v.wind.1986, "lon")     # view longitudes 
get.var.ncdf(v.wind.1986, "lat")     # view latitudes
get.var.ncdf(v.wind.1986, "time")	 # view times
get.var.ncdf(v.wind.1986,"vwnd")


Y<- get.var.ncdf(v.wind.1986,"vwnd")


May.86V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.86V
mean(May.86V)
mean.May.86V<-mean(May.86V)

June.86V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.86V
mean(June.86V)
mean.June.86V<-mean(June.86V)

July.86V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.86V
mean(July.86V)
mean.July.86V<-mean(July.86V)

May.June.86V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.86V
mean(May.June.86V)
mean.May.June.86V<-mean(May.June.86V)

JJ.86V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.86V
mean(JJ.86V)
mean.JJ.86V<-mean(JJ.86V)

May.July.86V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.86V
mean(May.July.86V)
mean.May.July.86V<-mean(May.July.86V)

############################################################################################################################
################################################### 1987 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.1987<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1987.nc")
u.wind.1987<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1987.nc")

u.wind.1987

get.var.ncdf(u.wind.1987, "lon")     # view longitudes 
get.var.ncdf(u.wind.1987, "lat")     # view latitudes
get.var.ncdf(u.wind.1987, "time")	 # view times
get.var.ncdf(u.wind.1987,"uwnd")


X <- get.var.ncdf(u.wind.1987,"uwnd")


May.87U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.87U
mean(May.87U)
mean.May.87U<-mean(May.87U)

June.87U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.87U
mean(June.87U)
mean.June.87U<-mean(June.87U)

July.87U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.87U
mean(July.87U)
mean.July.87U<-mean(July.87U)

May.June.87U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.87U
mean(May.June.87U)
mean.May.June.87U<-mean(May.June.87U)

JJ.87U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.87U
mean(JJ.87U)
mean.JJ.87U<-mean(JJ.87U)

May.July.87U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.87U
mean(May.July.87U)
mean.May.July.87U<-mean(May.July.87U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1987<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1987.nc")
v.wind.1987<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1987.nc")

v.wind.1987

get.var.ncdf(v.wind.1987, "lon")     # view longitudes 
get.var.ncdf(v.wind.1987, "lat")     # view latitudes
get.var.ncdf(v.wind.1987, "time")	 # view times
get.var.ncdf(v.wind.1987,"vwnd")


Y<- get.var.ncdf(v.wind.1987,"vwnd")


May.87V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.87V
mean(May.87V)
mean.May.87V<-mean(May.87V)

June.87V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.87V
mean(June.87V)
mean.June.87V<-mean(June.87V)

July.87V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.87V
mean(July.87V)
mean.July.87V<-mean(July.87V)

May.June.87V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.87V
mean(May.June.87V)
mean.May.June.87V<-mean(May.June.87V)

JJ.87V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.87V
mean(JJ.87V)
mean.JJ.87V<-mean(JJ.87V)

May.July.87V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.87V
mean(May.July.87V)
mean.May.July.87V<-mean(May.July.87V)

############################################################################################################################
################################################### 1988 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.1988<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1988.nc")
u.wind.1988<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1988.nc")

u.wind.1988

get.var.ncdf(u.wind.1988, "lon")     # view longitudes 
get.var.ncdf(u.wind.1988, "lat")     # view latitudes
get.var.ncdf(u.wind.1988, "time")	 # view times
get.var.ncdf(u.wind.1988,"uwnd")


X <- get.var.ncdf(u.wind.1988,"uwnd")


May.88U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.88U
mean(May.88U)
mean.May.88U<-mean(May.88U)

June.88U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.88U
mean(June.88U)
mean.June.88U<-mean(June.88U)

July.88U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.88U
mean(July.88U)
mean.July.88U<-mean(July.88U)

May.June.88U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.88U
mean(May.June.88U)
mean.May.June.88U<-mean(May.June.88U)

JJ.88U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.88U
mean(JJ.88U)
mean.JJ.88U<-mean(JJ.88U)

May.July.88U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.88U
mean(May.July.88U)
mean.May.July.88U<-mean(May.July.88U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1988<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1988.nc")
v.wind.1988<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1988.nc")

v.wind.1988

get.var.ncdf(v.wind.1988, "lon")     # view longitudes 
get.var.ncdf(v.wind.1988, "lat")     # view latitudes
get.var.ncdf(v.wind.1988, "time")	 # view times
get.var.ncdf(v.wind.1988,"vwnd")


Y<- get.var.ncdf(v.wind.1988,"vwnd")


May.88V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.88V
mean(May.88V)
mean.May.88V<-mean(May.88V)

June.88V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.88V
mean(June.88V)
mean.June.88V<-mean(June.88V)

July.88V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.88V
mean(July.88V)
mean.July.88V<-mean(July.88V)

May.June.88V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.88V
mean(May.June.88V)
mean.May.June.88V<-mean(May.June.88V)

JJ.88V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.88V
mean(JJ.88V)
mean.JJ.88V<-mean(JJ.88V)

May.July.88V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.88V
mean(May.July.88V)
mean.May.July.88V<-mean(May.July.88V)

############################################################################################################################
################################################### 1989 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.1989<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1989.nc")
u.wind.1989<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1989.nc")

u.wind.1989

get.var.ncdf(u.wind.1989, "lon")     # view longitudes 
get.var.ncdf(u.wind.1989, "lat")     # view latitudes
get.var.ncdf(u.wind.1989, "time")	 # view times
get.var.ncdf(u.wind.1989,"uwnd")


X <- get.var.ncdf(u.wind.1989,"uwnd")


May.89U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.89U
mean(May.89U)
mean.May.89U<-mean(May.89U)

June.89U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.89U
mean(June.89U)
mean.June.89U<-mean(June.89U)

July.89U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.89U
mean(July.89U)
mean.July.89U<-mean(July.89U)

May.June.89U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.89U
mean(May.June.89U)
mean.May.June.89U<-mean(May.June.89U)

JJ.89U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.89U
mean(JJ.89U)
mean.JJ.89U<-mean(JJ.89U)

May.July.89U<-X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.89U
mean(May.July.89U)
mean.May.July.89U<-mean(May.July.89U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1989<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1989.nc")
v.wind.1989<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1989.nc")

v.wind.1989

get.var.ncdf(v.wind.1989, "lon")     # view longitudes 
get.var.ncdf(v.wind.1989, "lat")     # view latitudes
get.var.ncdf(v.wind.1989, "time")	 # view times
get.var.ncdf(v.wind.1989,"vwnd")


Y<- get.var.ncdf(v.wind.1989,"vwnd")


May.89V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.89V
mean(May.89V)
mean.May.89V<-mean(May.89V)

June.89V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.89V
mean(June.89V)
mean.June.89V<-mean(June.89V)

July.89V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.89V
mean(July.89V)
mean.July.89V<-mean(July.89V)

May.June.89V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.89V
mean(May.June.89V)
mean.May.June.89V<-mean(May.June.89V)

JJ.89V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.89V
mean(JJ.89V)
mean.JJ.89V<-mean(JJ.89V)

May.July.89V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.89V
mean(May.July.89V)
mean.May.July.89V<-mean(May.July.89V)

############################################################################################################################
################################################### 1990 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.1990<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1990.nc")
u.wind.1990<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1990.nc")

u.wind.1990

get.var.ncdf(u.wind.1990, "lon")     # view longitudes 
get.var.ncdf(u.wind.1990, "lat")     # view latitudes
get.var.ncdf(u.wind.1990, "time")	 # view times
get.var.ncdf(u.wind.1990,"uwnd")


X <- get.var.ncdf(u.wind.1990,"uwnd")


May.90U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.90U
mean(May.90U)
mean.May.90U<-mean(May.90U)

June.90U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.90U
mean(June.90U)
mean.June.90U<-mean(June.90U)

July.90U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.90U
mean(July.90U)
mean.July.90U<-mean(July.90U)

May.June.90U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.90U
mean(May.June.90U)
mean.May.June.90U<-mean(May.June.90U)

JJ.90U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.90U
mean(JJ.90U)
mean.JJ.90U<-mean(JJ.90U)

May.July.90U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.90U
mean(May.July.90U)
mean.May.July.90U<-mean(May.July.90U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1990<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1990.nc")
v.wind.1990<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1990.nc")

v.wind.1990

get.var.ncdf(v.wind.1990, "lon")     # view longitudes 
get.var.ncdf(v.wind.1990, "lat")     # view latitudes
get.var.ncdf(v.wind.1990, "time")	 # view times
get.var.ncdf(v.wind.1990,"vwnd")


Y<- get.var.ncdf(v.wind.1990,"vwnd")


May.90V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.90V
mean(May.90V)
mean.May.90V<-mean(May.90V)

June.90V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.90V
mean(June.90V)
mean.June.90V<-mean(June.90V)

July.90V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.90V
mean(July.90V)
mean.July.90V<-mean(July.90V)

May.June.90V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.90V
mean(May.June.90V)
mean.May.June.90V<-mean(May.June.90V)

JJ.90V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.90V
mean(JJ.90V)
mean.JJ.90V<-mean(JJ.90V)

May.July.90V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.90V
mean(May.July.90V)
mean.May.July.90V<-mean(May.July.90V)


############################################################################################################################
################################################### 1991 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.1991<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1991.nc")
u.wind.1991<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1991.nc")
u.wind.1991

get.var.ncdf(u.wind.1991, "lon")     # view longitudes 
get.var.ncdf(u.wind.1991, "lat")     # view latitudes
get.var.ncdf(u.wind.1991, "time")	 # view times
get.var.ncdf(u.wind.1991,"uwnd")


X <- get.var.ncdf(u.wind.1991,"uwnd")


May.91U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.91U
mean(May.91U)
mean.May.91U<-mean(May.91U)

June.91U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.91U
mean(June.91U)
mean.June.91U<-mean(June.91U)

July.91U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.91U
mean(July.91U)
mean.July.91U<-mean(July.91U)

May.June.91U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.91U
mean(May.June.91U)
mean.May.June.91U<-mean(May.June.91U)

JJ.91U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.91U
mean(JJ.91U)
mean.JJ.91U<-mean(JJ.91U)

May.July.91U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.91U
mean(May.July.91U)
mean.May.July.91U<-mean(May.July.91U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1991<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1991.nc")
v.wind.1991-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1991.nc")
v.wind.1991

get.var.ncdf(v.wind.1991, "lon")     # view longitudes 
get.var.ncdf(v.wind.1991, "lat")     # view latitudes
get.var.ncdf(v.wind.1991, "time")	 # view times
get.var.ncdf(v.wind.1991,"vwnd")


Y<- get.var.ncdf(v.wind.1991,"vwnd")


May.91V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.91V
mean(May.91V)
mean.May.91V<-mean(May.91V)

June.91V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.91V
mean(June.91V)
mean.June.91V<-mean(June.91V)

July.91V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.91V
mean(July.91V)
mean.July.91V<-mean(July.91V)

May.June.91V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.91V
mean(May.June.91V)
mean.May.June.91V<-mean(May.June.91V)

JJ.91V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.91V
mean(JJ.91V)
mean.JJ.91V<-mean(JJ.91V)

May.July.91V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.91V
mean(May.July.91V)
mean.May.July.91V<-mean(May.July.91V)


############################################################################################################################
################################################### 1992 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.1992<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1992.nc")
u.wind.1992<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1992.nc")
u.wind.1992

get.var.ncdf(u.wind.1992, "lon")     # view longitudes 
get.var.ncdf(u.wind.1992, "lat")     # view latitudes
get.var.ncdf(u.wind.1992, "time")	 # view times
get.var.ncdf(u.wind.1992,"uwnd")


X <- get.var.ncdf(u.wind.1992,"uwnd")


May.92U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.92U
mean(May.92U)
mean.May.92U<-mean(May.92U)

June.92U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.92U
mean(June.92U)
mean.June.92U<-mean(June.92U)

July.92U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.92U
mean(July.92U)
mean.July.92U<-mean(July.92U)

May.June.92U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.92U
mean(May.June.92U)
mean.May.June.92U<-mean(May.June.92U)

JJ.92U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.92U
mean(JJ.92U)
mean.JJ.92U<-mean(JJ.92U)

May.July.92U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.92U
mean(May.July.92U)
mean.May.July.92U<-mean(May.July.92U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1992<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1992.nc")
v.wind.1992<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1992.nc")
v.wind.1992

get.var.ncdf(v.wind.1992, "lon")     # view longitudes 
get.var.ncdf(v.wind.1992, "lat")     # view latitudes
get.var.ncdf(v.wind.1992, "time")	 # view times
get.var.ncdf(v.wind.1992,"vwnd")


Y<- get.var.ncdf(v.wind.1992,"vwnd")


May.92V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.92V
mean(May.92V)
mean.May.92V<-mean(May.92V)

June.92V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.92V
mean(June.92V)
mean.June.92V<-mean(June.92V)

July.92V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.92V
mean(July.92V)
mean.July.92V<-mean(July.92V)

May.June.92V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.92V
mean(May.June.92V)
mean.May.June.92V<-mean(May.June.92V)

JJ.92V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.92V
mean(JJ.92V)
mean.JJ.92V<-mean(JJ.92V)

May.July.92V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.92V
mean(May.July.92V)
mean.May.July.92V<-mean(May.July.92V)

############################################################################################################################
################################################### 1993 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.1993<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1993.nc")
u.wind.1993<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1993.nc")
u.wind.1993

get.var.ncdf(u.wind.1993, "lon")     # view longitudes 
get.var.ncdf(u.wind.1993, "lat")     # view latitudes
get.var.ncdf(u.wind.1993, "time")	 # view times
get.var.ncdf(u.wind.1993,"uwnd")


X <- get.var.ncdf(u.wind.1993,"uwnd")


May.93U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.93U
mean(May.93U)
mean.May.93U<-mean(May.93U)

June.93U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.93U
mean(June.93U)
mean.June.93U<-mean(June.93U)

July.93U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.93U
mean(July.93U)
mean.July.93U<-mean(July.93U)

May.June.93U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.93U
mean(May.June.93U)
mean.May.June.93U<-mean(May.June.93U)

JJ.93U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.93U
mean(JJ.93U)
mean.JJ.93U<-mean(JJ.93U)

May.July.93U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.93U
mean(May.July.93U)
mean.May.July.93U<-mean(May.July.93U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1993<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1993.nc")
v.wind.1993<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1993.nc")
v.wind.1993

get.var.ncdf(v.wind.1993, "lon")     # view longitudes 
get.var.ncdf(v.wind.1993, "lat")     # view latitudes
get.var.ncdf(v.wind.1993, "time")	 # view times
get.var.ncdf(v.wind.1993,"vwnd")


Y<- get.var.ncdf(v.wind.1993,"vwnd")


May.93V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.93V
mean(May.93V)
mean.May.93V<-mean(May.93V)

June.93V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.93V
mean(June.93V)
mean.June.93V<-mean(June.93V)

July.93V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.93V
mean(July.93V)
mean.July.93V<-mean(July.93V)

May.June.93V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.93V
mean(May.June.93V)
mean.May.June.93V<-mean(May.June.93V)

JJ.93V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.93V
mean(JJ.93V)
mean.JJ.93V<-mean(JJ.93V)

May.July.93V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.93V
mean(May.July.93V)
mean.May.July.93V<-mean(May.July.93V)


############################################################################################################################
################################################### 1994 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.1994<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1994.nc")
u.wind.1994<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1994.nc")
u.wind.1994

get.var.ncdf(u.wind.1994, "lon")     # view longitudes 
get.var.ncdf(u.wind.1994, "lat")     # view latitudes
get.var.ncdf(u.wind.1994, "time")	 # view times
get.var.ncdf(u.wind.1994,"uwnd")


X <- get.var.ncdf(u.wind.1994,"uwnd")


May.94U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.94U
mean(May.94U)
mean.May.94U<-mean(May.94U)

June.94U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.94U
mean(June.94U)
mean.June.94U<-mean(June.94U)

July.94U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.94U
mean(July.94U)
mean.July.94U<-mean(July.94U)

May.June.94U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.94U
mean(May.June.94U)
mean.May.June.94U<-mean(May.June.94U)

JJ.94U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.94U
mean(JJ.94U)
mean.JJ.94U<-mean(JJ.94U)

May.July.94U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.94U
mean(May.July.94U)
mean.May.July.94U<-mean(May.July.94U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1994<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1994.nc")
v.wind.1994<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1994.nc")
v.wind.1994

get.var.ncdf(v.wind.1994, "lon")     # view longitudes 
get.var.ncdf(v.wind.1994, "lat")     # view latitudes
get.var.ncdf(v.wind.1994, "time")	 # view times
get.var.ncdf(v.wind.1994,"vwnd")


Y<- get.var.ncdf(v.wind.1994,"vwnd")


May.94V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.94V
mean(May.94V)
mean.May.94V<-mean(May.94V)

June.94V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.94V
mean(June.94V)
mean.June.94V<-mean(June.94V)

July.94V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.94V
mean(July.94V)
mean.July.94V<-mean(July.94V)

May.June.94V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.94V
mean(May.June.94V)
mean.May.June.94V<-mean(May.June.94V)

JJ.94V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.94V
mean(JJ.94V)
mean.JJ.94V<-mean(JJ.94V)

May.July.94V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.94V
mean(May.July.94V)
mean.May.July.94V<-mean(May.July.94V)


############################################################################################################################
################################################### 1995 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.1995<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1995.nc")
u.wind.1995<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1995.nc")
u.wind.1995

get.var.ncdf(u.wind.1995, "lon")     # view longitudes 
get.var.ncdf(u.wind.1995, "lat")     # view latitudes
get.var.ncdf(u.wind.1995, "time")	 # view times
get.var.ncdf(u.wind.1995,"uwnd")


X <- get.var.ncdf(u.wind.1995,"uwnd")


May.95U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.95U
mean(May.95U)
mean.May.95U<-mean(May.95U)

June.95U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.95U
mean(June.95U)
mean.June.95U<-mean(June.95U)

July.95U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.95U
mean(July.95U)
mean.July.95U<-mean(July.95U)

May.June.95U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.95U
mean(May.June.95U)
mean.May.June.95U<-mean(May.June.95U)

JJ.95U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.95U
mean(JJ.95U)
mean.JJ.95U<-mean(JJ.95U)

May.July.95U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.95U
mean(May.July.95U)
mean.May.July.95U<-mean(May.July.95U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1995<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1995.nc")
v.wind.1995<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1995.nc")
v.wind.1995

get.var.ncdf(v.wind.1995, "lon")     # view longitudes 
get.var.ncdf(v.wind.1995, "lat")     # view latitudes
get.var.ncdf(v.wind.1995, "time")	 # view times
get.var.ncdf(v.wind.1995,"vwnd")


Y<- get.var.ncdf(v.wind.1995,"vwnd")


May.95V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.95V
mean(May.95V)
mean.May.95V<-mean(May.95V)

June.95V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.95V
mean(June.95V)
mean.June.95V<-mean(June.95V)

July.95V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.95V
mean(July.95V)
mean.July.95V<-mean(July.95V)

May.June.95V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.95V
mean(May.June.95V)
mean.May.June.95V<-mean(May.June.95V)

JJ.95V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.95V
mean(JJ.95V)
mean.JJ.95V<-mean(JJ.95V)

May.July.95V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.95V
mean(May.July.95V)
mean.May.July.95V<-mean(May.July.95V)

############################################################################################################################
################################################### 1996 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.1996<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1996.nc")
u.wind.1996<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1996.nc")
u.wind.1996

get.var.ncdf(u.wind.1996, "lon")     # view longitudes 
get.var.ncdf(u.wind.1996, "lat")     # view latitudes
get.var.ncdf(u.wind.1996, "time")	 # view times
get.var.ncdf(u.wind.1996,"uwnd")


X <- get.var.ncdf(u.wind.1996,"uwnd")


May.96U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.96U
mean(May.96U)
mean.May.96U<-mean(May.96U)

June.96U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.96U
mean(June.96U)
mean.June.96U<-mean(June.96U)

July.96U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.96U
mean(July.96U)
mean.July.96U<-mean(July.96U)

May.June.96U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.96U
mean(May.June.96U)
mean.May.June.96U<-mean(May.June.96U)

JJ.96U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.96U
mean(JJ.96U)
mean.JJ.96U<-mean(JJ.96U)

May.July.96U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.96U
mean(May.July.96U)
mean.May.July.96U<-mean(May.July.96U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1996<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1996.nc")
v.wind.1996<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1996.nc")
v.wind.1996

get.var.ncdf(v.wind.1996, "lon")     # view longitudes 
get.var.ncdf(v.wind.1996, "lat")     # view latitudes
get.var.ncdf(v.wind.1996, "time")	 # view times
get.var.ncdf(v.wind.1996,"vwnd")


Y<- get.var.ncdf(v.wind.1996,"vwnd")


May.96V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.96V
mean(May.96V)
mean.May.96V<-mean(May.96V)

June.96V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.96V
mean(June.96V)
mean.June.96V<-mean(June.96V)

July.96V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.96V
mean(July.96V)
mean.July.96V<-mean(July.96V)

May.June.96V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.96V
mean(May.June.96V)
mean.May.June.96V<-mean(May.June.96V)

JJ.96V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.96V
mean(JJ.96V)
mean.JJ.96V<-mean(JJ.96V)

May.July.96V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.96V
mean(May.July.96V)
mean.May.July.96V<-mean(May.July.96V)

############################################################################################################################
################################################### 1997 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.1997<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1997.nc")
u.wind.1997<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1997.nc")
u.wind.1997

get.var.ncdf(u.wind.1997, "lon")     # view longitudes 
get.var.ncdf(u.wind.1997, "lat")     # view latitudes
get.var.ncdf(u.wind.1997, "time")	 # view times
get.var.ncdf(u.wind.1997,"uwnd")


X <- get.var.ncdf(u.wind.1997,"uwnd")


May.97U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.97U
mean(May.97U)
mean.May.97U<-mean(May.97U)

June.97U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.97U
mean(June.97U)
mean.June.97U<-mean(June.97U)

July.97U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.97U
mean(July.97U)
mean.July.97U<-mean(July.97U)

May.June.97U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.97U
mean(May.June.97U)
mean.May.June.97U<-mean(May.June.97U)

JJ.97U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.97U
mean(JJ.97U)
mean.JJ.97U<-mean(JJ.97U)

May.July.97U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.97U
mean(May.July.97U)
mean.May.July.97U<-mean(May.July.97U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1997<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1997.nc")
v.wind.1997<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1997.nc")
v.wind.1997

get.var.ncdf(v.wind.1997, "lon")     # view longitudes 
get.var.ncdf(v.wind.1997, "lat")     # view latitudes
get.var.ncdf(v.wind.1997, "time")	 # view times
get.var.ncdf(v.wind.1997,"vwnd")


Y<- get.var.ncdf(v.wind.1997,"vwnd")


May.97V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.97V
mean(May.97V)
mean.May.97V<-mean(May.97V)

June.97V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.97V
mean(June.97V)
mean.June.97V<-mean(June.97V)

July.97V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.97V
mean(July.97V)
mean.July.97V<-mean(July.97V)

May.June.97V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.97V
mean(May.June.97V)
mean.May.June.97V<-mean(May.June.97V)

JJ.97V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.97V
mean(JJ.97V)
mean.JJ.97V<-mean(JJ.97V)

May.July.97V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.97V
mean(May.July.97V)
mean.May.July.97V<-mean(May.July.97V)

############################################################################################################################
################################################### 1998 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.1998<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1998.nc")
u.wind.1998<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1998.nc")
u.wind.1998

get.var.ncdf(u.wind.1998, "lon")     # view longitudes 
get.var.ncdf(u.wind.1998, "lat")     # view latitudes
get.var.ncdf(u.wind.1998, "time")	 # view times
get.var.ncdf(u.wind.1998,"uwnd")


X <- get.var.ncdf(u.wind.1998,"uwnd")


May.98U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.98U
mean(May.98U)
mean.May.98U<-mean(May.98U)

June.98U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.98U
mean(June.98U)
mean.June.98U<-mean(June.98U)

July.98U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.98U
mean(July.98U)
mean.July.98U<-mean(July.98U)

May.June.98U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.98U
mean(May.June.98U)
mean.May.June.98U<-mean(May.June.98U)

JJ.98U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.98U
mean(JJ.98U)
mean.JJ.98U<-mean(JJ.98U)

May.July.98U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.98U
mean(May.July.98U)
mean.May.July.98U<-mean(May.July.98U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1998<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1998.nc")
v.wind.1998<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1998.nc")
v.wind.1998

get.var.ncdf(v.wind.1998, "lon")     # view longitudes 
get.var.ncdf(v.wind.1998, "lat")     # view latitudes
get.var.ncdf(v.wind.1998, "time")	 # view times
get.var.ncdf(v.wind.1998,"vwnd")


Y<- get.var.ncdf(v.wind.1998,"vwnd")


May.98V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.98V
mean(May.98V)
mean.May.98V<-mean(May.98V)

June.98V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.98V
mean(June.98V)
mean.June.98V<-mean(June.98V)

July.98V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.98V
mean(July.98V)
mean.July.98V<-mean(July.98V)

May.June.98V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.98V
mean(May.June.98V)
mean.May.June.98V<-mean(May.June.98V)

JJ.98V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.98V
mean(JJ.98V)
mean.JJ.98V<-mean(JJ.98V)

May.July.98V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.98V
mean(May.July.98V)
mean.May.July.98V<-mean(May.July.98V)


############################################################################################################################
################################################### 1999 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.1999<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.1999.nc")
u.wind.1999<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.1999.nc")
u.wind.1999

get.var.ncdf(u.wind.1999, "lon")     # view longitudes 
get.var.ncdf(u.wind.1999, "lat")     # view latitudes
get.var.ncdf(u.wind.1999, "time")	 # view times
get.var.ncdf(u.wind.1999,"uwnd")


X <- get.var.ncdf(u.wind.1999,"uwnd")


May.99U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.99U
mean(May.99U)
mean.May.99U<-mean(May.99U)

June.99U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.99U
mean(June.99U)
mean.June.99U<-mean(June.99U)

July.99U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.99U
mean(July.99U)
mean.July.99U<-mean(July.99U)

May.June.99U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.99U
mean(May.June.99U)
mean.May.June.99U<-mean(May.June.99U)

JJ.99U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.99U
mean(JJ.99U)
mean.JJ.99U<-mean(JJ.99U)

May.July.99U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.99U
mean(May.July.99U)
mean.May.July.99U<-mean(May.July.99U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.1999<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.1999.nc")
v.wind.1999<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.1999.nc")
v.wind.1999

get.var.ncdf(v.wind.1999, "lon")     # view longitudes 
get.var.ncdf(v.wind.1999, "lat")     # view latitudes
get.var.ncdf(v.wind.1999, "time")	 # view times
get.var.ncdf(v.wind.1999,"vwnd")


Y<- get.var.ncdf(v.wind.1999,"vwnd")


May.99V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.99V
mean(May.99V)
mean.May.99V<-mean(May.99V)

June.99V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.99V
mean(June.99V)
mean.June.99V<-mean(June.99V)

July.99V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.99V
mean(July.99V)
mean.July.99V<-mean(July.99V)

May.June.99V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.99V
mean(May.June.99V)
mean.May.June.99V<-mean(May.June.99V)

JJ.99V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.99V
mean(JJ.99V)
mean.JJ.99V<-mean(JJ.99V)

May.July.99V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.99V
mean(May.July.99V)
mean.May.July.99V<-mean(May.July.99V)


############################################################################################################################
################################################### 2000 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.2000<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.2000.nc")
u.wind.2000<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.2000.nc")
u.wind.2000

get.var.ncdf(u.wind.2000, "lon")     # view longitudes 
get.var.ncdf(u.wind.2000, "lat")     # view latitudes
get.var.ncdf(u.wind.2000, "time")	 # view times
get.var.ncdf(u.wind.2000,"uwnd")


X <- get.var.ncdf(u.wind.2000,"uwnd")


May.00U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.00U
mean(May.00U)
mean.May.00U<-mean(May.00U)

June.00U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.00U
mean(June.00U)
mean.June.00U<-mean(June.00U)

July.00U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.00U
mean(July.00U)
mean.July.00U<-mean(July.00U)

May.June.00U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.00U
mean(May.June.00U)
mean.May.June.00U<-mean(May.June.00U)

JJ.00U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.00U
mean(JJ.00U)
mean.JJ.00U<-mean(JJ.00U)

May.July.00U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.00U
mean(May.July.00U)
mean.May.July.00U<-mean(May.July.00U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.2000<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.2000.nc")
v.wind.2000<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.2000.nc")
v.wind.2000

get.var.ncdf(v.wind.2000, "lon")     # view longitudes 
get.var.ncdf(v.wind.2000, "lat")     # view latitudes
get.var.ncdf(v.wind.2000, "time")	 # view times
get.var.ncdf(v.wind.2000,"vwnd")


Y<- get.var.ncdf(v.wind.2000,"vwnd")


May.00V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.00V
mean(May.00)
mean.May.00V<-mean(May.00V)

June.00V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.00V
mean(June.00V)
mean.June.00V<-mean(June.00V)

July.00V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.00V
mean(July.00V)
mean.July.00V<-mean(July.00V)

May.June.00V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.00V
mean(May.June.00V)
mean.May.June.00V<-mean(May.June.00V)

JJ.00V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.00V
mean(JJ.00V)
mean.JJ.00V<-mean(JJ.00V)

May.July.00V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.00V
mean(May.July.00V)
mean.May.July.00V<-mean(May.July.00V)



############################################################################################################################
################################################### 2001 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.2001<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.2001.nc")
u.wind.2001<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.2001.nc")
u.wind.2001

get.var.ncdf(u.wind.2001, "lon")     # view longitudes 
get.var.ncdf(u.wind.2001, "lat")     # view latitudes
get.var.ncdf(u.wind.2001, "time")	 # view times
get.var.ncdf(u.wind.2001,"uwnd")


X <- get.var.ncdf(u.wind.2001,"uwnd")


May.01U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.01U
mean(May.01U)
mean.May.01U<-mean(May.01U)

June.01U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.01U
mean(June.01U)
mean.June.01U<-mean(June.01U)

July.01U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.01U
mean(July.01U)
mean.July.01U<-mean(July.01U)

May.June.01U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.01U
mean(May.June.01U)
mean.May.June.01U<-mean(May.June.01U)

JJ.01U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.01U
mean(JJ.01U)
mean.JJ.01U<-mean(JJ.01U)

May.July.01U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.01U
mean(May.July.01U)
mean.May.July.01U<-mean(May.July.01U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.2001<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.2001.nc")
v.wind.2001<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.2001.nc")
v.wind.2001

get.var.ncdf(v.wind.2001, "lon")     # view longitudes 
get.var.ncdf(v.wind.2001, "lat")     # view latitudes
get.var.ncdf(v.wind.2001, "time")	 # view times
get.var.ncdf(v.wind.2001,"vwnd")


Y<- get.var.ncdf(v.wind.2001,"vwnd")


May.01V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.01V
mean(May.01V)
mean.May.01V<-mean(May.01V)

June.01V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.01V
mean(June.01V)
mean.June.01V<-mean(June.01V)

July.01V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.01V
mean(July.01V)
mean.July.01V<-mean(July.01V)

May.June.01V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.01V
mean(May.June.01V)
mean.May.June.01V<-mean(May.June.01V)

JJ.01V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.01V
mean(JJ.01V)
mean.JJ.01V<-mean(JJ.01V)

May.July.01V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.01V
mean(May.July.01V)
mean.May.July.01V<-mean(May.July.01V)


############################################################################################################################
################################################### 2002 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.2002<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.2002.nc")
u.wind.2002<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.2002.nc")
u.wind.2002

get.var.ncdf(u.wind.2002, "lon")     # view longitudes 
get.var.ncdf(u.wind.2002, "lat")     # view latitudes
get.var.ncdf(u.wind.2002, "time")	 # view times
get.var.ncdf(u.wind.2002,"uwnd")


X <- get.var.ncdf(u.wind.2002,"uwnd")


May.02U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.02U
mean(May.02U)
mean.May.02U<-mean(May.02U)

June.02U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.02U
mean(June.02U)
mean.June.02U<-mean(June.02U)

July.02U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.02U
mean(July.02U)
mean.July.02U<-mean(July.02U)

May.June.02U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.02U
mean(May.June.02U)
mean.May.June.02U<-mean(May.June.02U)

JJ.02U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.02U
mean(JJ.02U)
mean.JJ.02U<-mean(JJ.02U)

May.July.02U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.02U
mean(May.July.02U)
mean.May.July.02U<-mean(May.July.02U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.2002<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.2002.nc")
v.wind.2002<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.2002.nc")
v.wind.2002

get.var.ncdf(v.wind.2002, "lon")     # view longitudes 
get.var.ncdf(v.wind.2002, "lat")     # view latitudes
get.var.ncdf(v.wind.2002, "time")	 # view times
get.var.ncdf(v.wind.2002,"vwnd")


Y<- get.var.ncdf(v.wind.2002,"vwnd")


May.02V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.02V
mean(May.02V)
mean.May.02V<-mean(May.02V)

June.02V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.02V
mean(June.02V)
mean.June.02V<-mean(June.02V)

July.02V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.02V
mean(July.02V)
mean.July.02V<-mean(July.02V)

May.June.02V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.02V
mean(May.June.02V)
mean.May.June.02V<-mean(May.June.02V)

JJ.02V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.02V
mean(JJ.02V)
mean.JJ.02V<-mean(JJ.02V)

May.July.02V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.02V
mean(May.July.02V)
mean.May.July.02V<-mean(May.July.02V)


############################################################################################################################
################################################### 2003 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.2003<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.2003.nc")
u.wind.2003<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.2003.nc")
#u.wind.2003

#get.var.ncdf(u.wind.2003, "lon")     # view longitudes 
#get.var.ncdf(u.wind.2003, "lat")     # view latitudes
#get.var.ncdf(u.wind.2003, "time")	 # view times
#get.var.ncdf(u.wind.2003,"uwnd")


X <- get.var.ncdf(u.wind.2003,"uwnd")


May.03U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.03U
mean(May.03U)
mean.May.03U<-mean(May.03U)

June.03U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.03U
mean(June.03U)
mean.June.03U<-mean(June.03U)

July.03U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.03U
mean(July.03U)
mean.July.03U<-mean(July.03U)

May.June.03U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.03U
mean(May.June.03U)
mean.May.June.03U<-mean(May.June.03U)

JJ.03U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.03U
mean(JJ.03U)
mean.JJ.03U<-mean(JJ.03U)

May.July.03U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.03U
mean(May.July.03U)
mean.May.July.03U<-mean(May.July.03U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.2003<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.2003.nc")
v.wind.2003<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.2003.nc")
#v.wind.2003

#get.var.ncdf(v.wind.2003, "lon")     # view longitudes 
#get.var.ncdf(v.wind.2003, "lat")     # view latitudes
#get.var.ncdf(v.wind.2003, "time")	 # view times
#get.var.ncdf(v.wind.2003,"vwnd")


Y<- get.var.ncdf(v.wind.2003,"vwnd")


May.03V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.03V
mean(May.03V)
mean.May.03V<-mean(May.03V)

June.03V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.03V
mean(June.03V)
mean.June.03V<-mean(June.03V)

July.03V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.03V
mean(July.03V)
mean.July.03V<-mean(July.03V)

May.June.03V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.03V
mean(May.June.03V)
mean.May.June.03V<-mean(May.June.03V)

JJ.03V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.03V
mean(JJ.03V)
mean.JJ.03V<-mean(JJ.03V)

May.July.03V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.03V
mean(May.July.03V)
mean.May.July.03V<-mean(May.July.03V)


############################################################################################################################
################################################### 2004 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.2004<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.2004.nc")
u.wind.2004<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.2004.nc")
#u.wind.2004

#get.var.ncdf(u.wind.2004, "lon")     # view longitudes 
#get.var.ncdf(u.wind.2004, "lat")     # view latitudes
#get.var.ncdf(u.wind.2004, "time")	 # view times
#get.var.ncdf(u.wind.2004,"uwnd")


X <- get.var.ncdf(u.wind.2004,"uwnd")


May.04U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.04U
mean(May.04U)
mean.May.04U<-mean(May.04U)

June.04U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.04U
mean(June.04U)
mean.June.04U<-mean(June.04U)

July.04U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.04U
mean(July.04U)
mean.July.04U<-mean(July.04U)

May.June.04U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.04U
mean(May.June.04U)
mean.May.June.04U<-mean(May.June.04U)

JJ.04U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.04U
mean(JJ.04U)
mean.JJ.04U<-mean(JJ.04U)

May.July.04U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.04U
mean(May.July.04U)
mean.May.July.04U<-mean(May.July.04U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.2004<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.2004.nc")
v.wind.2004<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.2004.nc")
#v.wind.2004

#get.var.ncdf(v.wind.2004, "lon")     # view longitudes 
#get.var.ncdf(v.wind.2004, "lat")     # view latitudes
#get.var.ncdf(v.wind.2004, "time")	 # view times
#get.var.ncdf(v.wind.2004,"vwnd")


Y<- get.var.ncdf(v.wind.2004,"vwnd")


May.04V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.04V
mean(May.04V)
mean.May.04V<-mean(May.04V)

June.04V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.04V
mean(June.04V)
mean.June.04V<-mean(June.04V)

July.04V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.04V
mean(July.04V)
mean.July.04V<-mean(July.04V)

May.June.04V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.04V
mean(May.June.04V)
mean.May.June.04V<-mean(May.June.04V)

JJ.04V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.04V
mean(JJ.04V)
mean.JJ.04V<-mean(JJ.04V)

May.July.04V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.04V
mean(May.July.04V)
mean.May.July.04V<-mean(May.July.04V)


############################################################################################################################
################################################### 2005 ###################################################################
################################################### Extract u-component and calculate means by time ########################

u.wind.2005<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\u.winds\\uwnd.10m.gauss.2005.nc")
u.wind.2005<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/u.winds/uwnd.10m.gauss.2005.nc")
#u.wind.2005

#get.var.ncdf(u.wind.2005, "lon")     # view longitudes 
#get.var.ncdf(u.wind.2005, "lat")     # view latitudes
#get.var.ncdf(u.wind.2005, "time")	 # view times
#get.var.ncdf(u.wind.2005,"uwnd")


X <- get.var.ncdf(u.wind.2005,"uwnd")


May.05U<-X[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.05U
mean(May.05U)
mean.May.05U<-mean(May.05U)

June.05U<-X[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.05U
mean(June.05U)
mean.June.05U<-mean(June.05U)

July.05U<-X[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.05U
mean(July.05U)
mean.July.05U<-mean(July.05U)

May.June.05U<-X[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.05U
mean(May.June.05U)
mean.May.June.05U<-mean(May.June.05U)

JJ.05U<-X[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.05U
mean(JJ.05U)
mean.JJ.05U<-mean(JJ.05U)

May.July.05U <- X[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.05U
mean(May.July.05U)
mean.May.July.05U<-mean(May.July.05U)



#####################################################################################################################################
###############################################Repeat above for v-component #########################################################

v.wind.2005<-open.ncdf("C:\\Documents and Settings\\Jon\\Desktop\\Project\\Datasets for analysis\\v.winds\\vwnd.10m.gauss.2005.nc")
v.wind.2005<-open.ncdf("C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/v.winds/vwnd.10m.gauss.2005.nc")
#v.wind.2005

#get.var.ncdf(v.wind.2005, "lon")     # view longitudes 
#get.var.ncdf(v.wind.2005, "lat")     # view latitudes
#get.var.ncdf(v.wind.2005, "time")	 # view times
#get.var.ncdf(v.wind.2005,"vwnd")


Y<- get.var.ncdf(v.wind.2005,"vwnd")


May.05V<-Y[87:93,17:18, 135:150]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-May 30
May.05V
mean(May.05V)
mean.May.05V<-mean(May.05V)

June.05V<-Y[87:93,17:18, 151:180]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-June 30
June.05V
mean(June.05V)
mean.June.05V<-mean(June.05V)

July.05V<-Y[87:93,17:18, 181:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, July 1-July 15
July.05V
mean(July.05V)
mean.July.05V<-mean(July.05V)

May.June.05V<-Y[87:93,17:18, 135:180]		 # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-June 30
May.June.05V
mean(May.June.05V)
mean.May.June.05V<-mean(May.June.05V)

JJ.05V<-Y[87:93,17:18, 151:195]			 # Extracts data for 56.189-58.093N, 161.250-172.5W, June 1-July 15
JJ.05V
mean(JJ.05V)
mean.JJ.05V<-mean(JJ.05V)

May.July.05V <- Y[87:93,17:18, 135:195]	       # Extracts data for 56.189-58.093N, 161.250-172.5W, May 15-July 15
May.July.05V
mean(May.July.05V)
mean.May.July.05V<-mean(May.July.05V)




############################################################################################################################
############################################################################################################################
#############################################Define radian measurements as angles###########################################
#0<-0
#30<-pi/6
#45<-pi/4
#60<-pi/3
#90<-pi/2
#120<-2/3pi
#150<-5/6pi
#180<-pi
#210<-7/6pi
#225<-5/4pi
#240<-4/3pi
#270<-3/2pi
#300<-5/3pi
#315<-7/4pi
#330<-11/6pi
#360<-2pi=0
###########################################################################################################################
############################################# generate histograms to check distribution ###################################

hist(May.July.78U)
hist(May.July.78V)

hist(May.July.79U)
hist(May.July.79V)

hist(May.July.80U)
hist(May.July.80V)

hist(May.July.81U)
hist(May.July.81V)

hist(May.July.82U)
hist(May.July.82V)

hist(May.July.83U)
hist(May.July.83V)

hist(May.July.84U)
hist(May.July.84V)

hist(May.July.85U)
hist(May.July.85V)

hist(May.July.86U)
hist(May.July.86V)

hist(May.July.87U)
hist(May.July.87V)

hist(May.July.88U)
hist(May.July.88V)

hist(May.July.89U)
hist(May.July.89V)

hist(May.July.90U)
hist(May.July.90V)

hist(May.July.91U)
hist(May.July.91V)

hist(May.July.92U)
hist(May.July.92V)

hist(May.July.93U)
hist(May.July.93V)

hist(May.July.94U)
hist(May.July.94V)


###########################################################################################################################
################################################ Data vectors #############################################################
################################################# U component #############################################################

May.U<-c(mean.May.78U,mean.May.79U,mean.May.80U,mean.May.81U,mean.May.82U,mean.May.83U,mean.May.84U,mean.May.85U,mean.May.86U,mean.May.87U,
mean.May.88U,mean.May.89U,mean.May.90U,mean.May.91U,mean.May.92U,mean.May.93U,mean.May.94U,mean.May.95U,mean.May.96U,mean.May.97U,mean.May.98U,
mean.May.99U,mean.May.00U,mean.May.01U,mean.May.02U,mean.May.03U,mean.May.04U,mean.May.05U)

June.U<-c(mean.June.78U,mean.June.79U,mean.June.80U,mean.June.81U,mean.June.82U,mean.June.83U,mean.June.84U,mean.June.85U,mean.June.86U,mean.June.87U,
mean.June.88U,mean.June.89U,mean.June.90U,mean.June.91U,mean.June.92U,mean.June.93U,mean.June.94U,mean.June.95U,mean.June.96U,mean.June.97U,mean.June.98U,
mean.June.99U,mean.June.00U,mean.June.01U,mean.June.02U,mean.June.03U,mean.June.04U,mean.June.05U)

July.U<-c(mean.July.78U,mean.July.79U,mean.July.80U,mean.July.81U,mean.July.82U,mean.July.83U,mean.July.84U,mean.July.85U,mean.July.86U,mean.July.87U,
mean.July.88U,mean.July.89U,mean.July.90U,mean.July.91U,mean.July.92U,mean.July.93U,mean.July.94U,mean.July.95U,mean.July.96U,mean.July.97U,mean.July.98U,
mean.July.99U,mean.July.00U,mean.July.01U,mean.July.02U,mean.July.03U,mean.July.04U,mean.July.05U)

May.June.U<-c(mean.May.June.78U,mean.May.June.79U,mean.May.June.80U,mean.May.June.81U,mean.May.June.82U,mean.May.June.83U,mean.May.June.84U,mean.May.June.85U,
mean.May.June.86U,mean.May.June.87U,mean.May.June.88U,mean.May.June.89U,mean.May.June.90U,mean.May.June.91U,mean.May.June.92U,mean.May.June.93U,mean.May.June.94U,
mean.May.June.95U,mean.May.June.96U,mean.May.June.97U,mean.May.June.98U,mean.May.June.99U,mean.May.June.00U,mean.May.June.01U,mean.May.June.02U,mean.May.June.03U,
mean.May.June.04U,mean.May.June.05U)

June.July.U<-c(mean.JJ.78U,mean.JJ.79U,mean.JJ.80U,mean.JJ.81U,mean.JJ.82U,mean.JJ.83U,mean.JJ.84U,mean.JJ.85U,mean.JJ.86U,mean.JJ.87U,mean.JJ.88U,mean.JJ.89U,
mean.JJ.90U,mean.JJ.91U,mean.JJ.92U,mean.JJ.93U,mean.JJ.94U,mean.JJ.95U,mean.JJ.96U,mean.JJ.97U,mean.JJ.98U,mean.JJ.99U,mean.JJ.00U,mean.JJ.01U,mean.JJ.02U,
mean.JJ.03U,mean.JJ.04U,mean.JJ.05U)

May.July.U<-c(mean.May.July.78U,mean.May.July.79U,mean.May.July.80U,mean.May.July.81U,mean.May.July.82U,mean.May.July.83U,mean.May.July.84U,mean.May.July.85U,
mean.May.July.86U,mean.May.July.87U,mean.May.July.88U,mean.May.July.89U,mean.May.July.90U,mean.May.July.91U,mean.May.July.92U,mean.May.July.93U,mean.May.July.94U,
mean.May.July.95U,mean.May.July.96U,mean.May.July.97U,mean.May.July.98U,mean.May.July.99U,mean.May.July.00U,mean.May.July.01U,mean.May.July.02U,mean.May.July.03U,
mean.May.July.04U,mean.May.July.05U)

##########################################################################################################################
############################################### V component ##############################################################

May.V<- c(mean.May.78V,mean.May.79V,mean.May.80V,mean.May.81V,mean.May.82V,mean.May.83V,mean.May.84V,mean.May.85V,mean.May.86V,mean.May.87V,
mean.May.88V,mean.May.89V,mean.May.90V,mean.May.91V,mean.May.92V,mean.May.93V,mean.May.94V,mean.May.95V,mean.May.96V,mean.May.97V,mean.May.98V,
mean.May.99V,mean.May.00V,mean.May.01V,mean.May.02V,mean.May.03V,mean.May.04V,mean.May.05V)

June.V<-c(mean.June.78V,mean.June.79V,mean.June.80V,mean.June.81V,mean.June.82V,mean.June.83V,mean.June.84V,mean.June.85V,mean.June.86V,mean.June.87V,
mean.June.88V,mean.June.89V,mean.June.90V,mean.June.91V,mean.June.92V,mean.June.93V,mean.June.94V,mean.June.95V,mean.June.96V,mean.June.97V,mean.June.98V,
mean.June.99V,mean.June.00V,mean.June.01V,mean.June.02V,mean.June.03V,mean.June.04V,mean.June.05V)

July.V<-c(mean.July.78V,mean.July.79V,mean.July.80V,mean.July.81V,mean.July.82V,mean.July.83V,mean.July.84V,mean.July.85V,mean.July.86V,mean.July.87V,
mean.July.88V,mean.July.89V,mean.July.90V,mean.July.91V,mean.July.92V,mean.July.93V,mean.July.94V,mean.July.95V,mean.July.96V,mean.July.97V,mean.July.98V,
mean.July.99V,mean.July.00V,mean.July.01V,mean.July.02V,mean.July.03V,mean.July.04V,mean.July.05V)

May.June.V<-c(mean.May.June.78V,mean.May.June.79V,mean.May.June.80V,mean.May.June.81V,mean.May.June.82V,mean.May.June.83V,mean.May.June.84V,mean.May.June.85V,
mean.May.June.86V,mean.May.June.87V,mean.May.June.88V,mean.May.June.89V,mean.May.June.90V,mean.May.June.91V,mean.May.June.92V,mean.May.June.93V,mean.May.June.94V,
mean.May.June.95V,mean.May.June.96V,mean.May.June.97V,mean.May.June.98V,mean.May.June.99V,mean.May.June.00V,mean.May.June.01V,mean.May.June.02V,mean.May.June.03V,
mean.May.June.04V,mean.May.June.05V)

June.July.V<-c(mean.JJ.78V,mean.JJ.79V,mean.JJ.80V,mean.JJ.81V,mean.JJ.82V,mean.JJ.83V,mean.JJ.84V,mean.JJ.85V,mean.JJ.86V,mean.JJ.87V,mean.JJ.88V,mean.JJ.89V,
mean.JJ.90V,mean.JJ.91V,mean.JJ.92V,mean.JJ.93V,mean.JJ.94V,mean.JJ.95V,mean.JJ.96V,mean.JJ.97V,mean.JJ.98V,mean.JJ.99V,mean.JJ.00V,mean.JJ.01V,mean.JJ.02V,
mean.JJ.03V,mean.JJ.04V,mean.JJ.05V)

May.July.V<-c(mean.May.July.78V,mean.May.July.79V,mean.May.July.80V,mean.May.July.81V,mean.May.July.82V,mean.May.July.83V,mean.May.July.84V,mean.May.July.85V,
mean.May.July.86V,mean.May.July.87V,mean.May.July.88V,mean.May.July.89V,mean.May.July.90V,mean.May.July.91V,mean.May.July.92V,mean.May.July.93V,mean.May.July.94V,
mean.May.July.95V,mean.May.July.96V,mean.May.July.97V,mean.May.July.98V,mean.May.July.99V,mean.May.July.00V,mean.May.July.01V,mean.May.July.02V,mean.May.July.03V,
mean.May.July.04V,mean.May.July.05V)


###########################################################################################################################
################################################ Theta vector for Rosenkranz formula#######################################

theta.vector<-c(5*pi/12,4*pi/12,3*pi/12,2*pi/12,pi/12,-pi/12,-2*pi/12,-3*pi/12,-4*pi/12,-5*pi/12)
theta.vector

for(i in theta.vector[1:10]){
D=i*180/pi
print(D)
}

###########################################################################################################################
############################################### Employ Rosenkranz formula to calculate directional components #############
################################################### directional vector = x*cos(theta)+y*sin(theta)#########################

############################### 90 degree component ##########################################
for(i in May.U){
D.90.May=May.U * cos(6*pi/12)+ May.V * sin(6*pi/12)
}

for(i in June.U){
D.90.June=June.U * cos(6*pi/12)+ June.V * sin(6*pi/12)
}

for(i in July.U){
D.90.July=July.U * cos(6*pi/12)+ July.V * sin(6*pi/12)
}

for(i in May.June.U){
D.90.May.June=May.June.U * cos(6*pi/12)+ May.June.V * sin(6*pi/12)
}

for(i in June.July.U){
D.90.JJ=June.July.U * cos(6*pi/12)+ June.July.V * sin(6*pi/12)
}

for(i in May.July.U){
D.90.MJ=May.July.U * cos(6*pi/12)+ May.July.V * sin(6*pi/12)
}
############################### 75 degree component ##########################################

for(i in May.U){
D.75.May=May.U * cos(5*pi/12)+ May.V * sin(5*pi/12)
}

for(i in June.U){
D.75.June=June.U * cos(5*pi/12)+ June.V * sin(5*pi/12)
}

for(i in July.U){
D.75.July=July.U * cos(5*pi/12)+ July.V * sin(5*pi/12)
}

for(i in May.June.U){
D.75.May.June=May.June.U * cos(5*pi/12)+ May.June.V * sin(5*pi/12)
}

for(i in June.July.U){
D.75.JJ=June.July.U * cos(5*pi/12)+ June.July.V * sin(5*pi/12)
}

for(i in May.July.U){
D.75.MJ=May.July.U * cos(5*pi/12)+ May.July.V * sin(5*pi/12)
}

############################### 60 degree component #########################################


for(i in May.U){
D.60.May=May.U * cos(4*pi/12)+ May.V * sin(4*pi/12)
}

for(i in June.U){
D.60.June=June.U * cos(4*pi/12)+ June.V * sin(4*pi/12)
}

for(i in July.U){
D.60.July=July.U * cos(4*pi/12)+ July.V * sin(4*pi/12)
}

for(i in May.June.U){
D.60.May.June=May.June.U * cos(4*pi/12)+ May.June.V * sin(4*pi/12)
}

for(i in June.July.U){
D.60.JJ=June.July.U * cos(4*pi/12)+ June.July.V * sin(4*pi/12)
}

for(i in May.July.U){
D.60.MJ=May.July.U * cos(4*pi/12)+ May.July.V * sin(4*pi/12)
}


############################### 45 degree component ###########################################


for(i in May.U){
D.45.May=May.U * cos(3*pi/12)+ May.V * sin(3*pi/12)
}

for(i in June.U){
D.45.June=June.U * cos(3*pi/12)+ June.V * sin(3*pi/12)
}

for(i in July.U){
D.45.July=July.U * cos(3*pi/12)+ July.V * sin(3*pi/12)
}

for(i in May.June.U){
D.45.May.June=May.June.U * cos(3*pi/12)+ May.June.V * sin(3*pi/12)
}

for(i in June.July.U){
D.45.JJ=June.July.U * cos(3*pi/12)+ June.July.V * sin(3*pi/12)
}

for(i in May.July.U){
D.45.MJ=May.July.U * cos(3*pi/12)+ May.July.V * sin(3*pi/12)
}


############################# 30 degree component ###############################################

for(i in May.U){
D.30.May=May.U * cos(2*pi/12)+ May.V * sin(2*pi/12)
}

for(i in June.U){
D.30.June=June.U * cos(2*pi/12)+ June.V * sin(2*pi/12)
}

for(i in July.U){
D.30.July=July.U * cos(2*pi/12)+ July.V * sin(2*pi/12)
}

for(i in May.June.U){
D.30.May.June=May.June.U * cos(2*pi/12)+ May.June.V * sin(2*pi/12)
}

for(i in June.July.U){
D.30.JJ=June.July.U * cos(2*pi/12)+ June.July.V * sin(2*pi/12)
}

for(i in May.July.U){
D.30.MJ=May.July.U * cos(2*pi/12)+ May.July.V * sin(2*pi/12)
}



############################# 15 degree component ###############################################

for(i in May.U){
D.15.May=May.U * cos(pi/12)+ May.V * sin(pi/12)
}

for(i in June.U){
D.15.June=June.U * cos(pi/12)+ June.V * sin(pi/12)
}

for(i in July.U){
D.15.July=July.U * cos(pi/12)+ July.V * sin(pi/12)
}

for(i in May.June.U){
D.15.May.June=May.June.U * cos(pi/12)+ May.June.V * sin(pi/12)
}

for(i in June.July.U){
D.15.JJ=June.July.U * cos(pi/12)+ June.July.V * sin(pi/12)
}

for(i in May.July.U){
D.15.MJ=May.July.U * cos(pi/12)+ May.July.V * sin(pi/12)
}


############################# 0 degree component #################################################
for(i in May.U){
D.0.May=May.U * cos(0*pi/12)+ May.V * sin(0*pi/12)
}

for(i in June.U){
D.0.June=June.U * cos(0*pi/12)+ June.V * sin(0*pi/12)
}

for(i in July.U){
D.0.July=July.U * cos(0*pi/12)+ July.V * sin(0*pi/12)
}

for(i in May.June.U){
D.0.May.June=May.June.U * cos(0*pi/12)+ May.June.V * sin(0*pi/12)
}

for(i in June.July.U){
D.0.JJ=June.July.U * cos(0*pi/12)+ June.July.V * sin(0*pi/12)
}

for(i in May.July.U){
D.0.MJ=May.July.U * cos(0*pi/12)+ May.July.V * sin(0*pi/12)
}


############################# -15 degree component ###############################################

for(i in May.U){
D.neg.15.May=May.U * cos(-pi/12)+ May.V * sin(-pi/12)
}

for(i in June.U){
D.neg.15.June=June.U * cos(-pi/12)+ June.V * sin(-pi/12)
}

for(i in July.U){
D.neg.15.July=July.U * cos(-pi/12)+ July.V * sin(-pi/12)
}

for(i in May.June.U){
D.neg.15.May.June=May.June.U * cos(-pi/12)+ May.June.V * sin(-pi/12)
}

for(i in June.July.U){
D.neg.15.JJ=June.July.U * cos(-pi/12)+ June.July.V * sin(-pi/12)
}

for(i in May.July.U){
D.neg.15.MJ=May.July.U * cos(-pi/12)+ May.July.V * sin(-pi/12)
}


############################# -30 degree component ###############################################

for(i in May.U){
D.neg.30.May=May.U * cos(-2*pi/12)+ May.V * sin(-2*pi/12)
}

for(i in June.U){
D.neg.30.June=June.U * cos(-2*pi/12)+ June.V * sin(-2*pi/12)
}

for(i in July.U){
D.neg.30.July=July.U * cos(-2*pi/12)+ July.V * sin(-2*pi/12)
}

for(i in May.June.U){
D.neg.30.May.June=May.June.U * cos(-2*pi/12)+ May.June.V * sin(-2*pi/12)
}

for(i in June.July.U){
D.neg.30.JJ=June.July.U * cos(-2*pi/12)+ June.July.V * sin(-2*pi/12)
}

for(i in May.July.U){
D.neg.30.MJ=May.July.U * cos(-2*pi/12)+ May.July.V * sin(-2*pi/12)
}


############################### -45 degree component ###########################################


for(i in May.U){
D.neg.45.May=May.U * cos(-3*pi/12)+ May.V * sin(-3*pi/12)
}

for(i in June.U){
D.neg.45.June=June.U * cos(-3*pi/12)+ June.V * sin(-3*pi/12)
}

for(i in July.U){
D.neg.45.July=July.U * cos(-3*pi/12)+ July.V * sin(-3*pi/12)
}

for(i in May.June.U){
D.neg.45.May.June=May.June.U * cos(-3*pi/12)+ May.June.V * sin(-3*pi/12)
}

for(i in June.July.U){
D.neg.45.JJ=June.July.U * cos(-3*pi/12)+ June.July.V * sin(-3*pi/12)
}

for(i in May.July.U){
D.neg.45.MJ=May.July.U * cos(-3*pi/12)+ May.July.V * sin(-3*pi/12)
}


############################### -60 degree component #########################################


for(i in May.U){
D.neg.60.May=May.U * cos(-4*pi/12)+ May.V * sin(-4*pi/12)
}

for(i in June.U){
D.neg.60.June=June.U * cos(-4*pi/12)+ June.V * sin(-4*pi/12)
}

for(i in July.U){
D.neg.60.July=July.U * cos(-4*pi/12)+ July.V * sin(-4*pi/12)
}

for(i in May.June.U){
D.neg.60.May.June=May.June.U * cos(-4*pi/12)+ May.June.V * sin(-4*pi/12)
}

for(i in June.July.U){
D.neg.60.JJ=June.July.U * cos(-4*pi/12)+ June.July.V * sin(-4*pi/12)
}

for(i in May.July.U){
D.neg.60.MJ=May.July.U * cos(-4*pi/12)+ May.July.V * sin(-4*pi/12)
}

############################### -75 degree component ##########################################

for(i in May.U){
D.neg.75.May=May.U * cos(-5*pi/12)+ May.V * sin(-5*pi/12)
}

for(i in June.U){
D.neg.75.June=June.U * cos(-5*pi/12)+ June.V * sin(-5*pi/12)
}

for(i in July.U){
D.neg.75.July=July.U * cos(-5*pi/12)+ July.V * sin(-5*pi/12)
}

for(i in May.June.U){
D.neg.75.May.June=May.June.U * cos(-5*pi/12)+ May.June.V * sin(-5*pi/12)
}

for(i in June.July.U){
D.neg.75.JJ=June.July.U * cos(-5*pi/12)+ June.July.V * sin(-5*pi/12)
}

for(i in May.July.U){
D.neg.75.MJ=May.July.U * cos(-5*pi/12)+ May.July.V * sin(-5*pi/12)
}


################################ -90 degree component #########################################
for(i in May.U){
D.neg.90.May=May.U * cos(-6*pi/12)+ May.V * sin(-6*pi/12)
}

for(i in June.U){
D.neg.90.June=June.U * cos(-6*pi/12)+ June.V * sin(-6*pi/12)
}

for(i in July.U){
D.neg.90.July=July.U * cos(-6*pi/12)+ July.V * sin(-6*pi/12)
}

for(i in May.June.U){
D.neg.90.May.June=May.June.U * cos(-6*pi/12)+ May.June.V * sin(-6*pi/12)
}

for(i in June.July.U){
D.neg.90.JJ=June.July.U * cos(-6*pi/12)+ June.July.V * sin(-6*pi/12)
}

for(i in May.July.U){
D.neg.90.MJ=May.July.U * cos(-6*pi/12)+ May.July.V * sin(-6*pi/12)
}


###############################################################################################################
########################################### output directional component time series ##########################

D.90.May
D.90.June
D.90.July
D.90.May.June
D.90.JJ
D.90.MJ

D.75.May
D.75.June
D.75.July
D.75.May.June
D.75.JJ
D.75.MJ

D.60.May
D.60.June
D.60.July
D.60.May.June
D.60.JJ
D.60.MJ

D.45.May
D.45.June
D.45.July
D.45.May.June
D.45.JJ
D.45.MJ

D.30.May
D.30.June
D.30.July
D.30.May.June
D.30.JJ
D.30.MJ

D.15.May
D.15.June
D.15.July
D.15.May.June
D.15.JJ
D.15.MJ

D.0.May
D.0.June
D.0.July
D.0.May.June
D.0.JJ
D.0.MJ

D.neg.15.May
D.neg.15.June
D.neg.15.July
D.neg.15.May.June
D.neg.15.JJ
D.neg.15.MJ

D.neg.30.May
D.neg.30.June
D.neg.30.July
D.neg.30.May.June
D.neg.30.JJ
D.neg.30.MJ

D.neg.45.May
D.neg.45.June
D.neg.45.July
D.neg.45.May.June
D.neg.45.JJ
D.neg.45.MJ

D.neg.60.May
D.neg.60.June
D.neg.60.July
D.neg.60.May.June
D.neg.60.JJ
D.neg.60.MJ


D.neg.75.May
D.neg.75.June
D.neg.75.July
D.neg.75.May.June
D.neg.75.JJ
D.neg.75.MJ

D.neg.90.May
D.neg.90.June
D.neg.90.July
D.neg.90.May.June
D.neg.90.JJ
D.neg.90.MJ

###############################################################################################################
########################################### generate editted series ###############################################

D.90.May.ed<-D.90.May[-5]
D.90.June.ed<-D.90.June[-5]
D.90.July.ed<-D.90.July[-5]
D.90.May.June.ed<-D.90.May.June[-5]
D.90.JJ.ed<-D.90.JJ[-5]
D.90.MJ.ed<-D.90.MJ[-5]

D.75.May.ed<-D.75.May[-5]
D.75.June.ed<-D.75.June[-5]
D.75.July.ed<-D.75.July[-5]
D.75.May.June.ed<-D.75.May.June[-5]
D.75.JJ.ed<-D.75.JJ[-5]
D.75.MJ.ed<-D.75.MJ[-5]


D.60.May.ed<-D.60.May[-5]
D.60.June.ed<-D.60.June[-5]
D.60.July.ed<-D.60.July[-5]
D.60.May.June.ed<-D.60.May.June[-5]
D.60.JJ.ed<-D.60.JJ[-5]
D.60.MJ.ed<-D.60.MJ[-5]

D.45.May.ed<-D.45.May[-5]
D.45.June.ed<-D.45.June[-5]
D.45.July.ed<-D.45.July[-5]
D.45.May.June.ed<-D.45.May.June[-5]
D.45.JJ.ed<-D.45.JJ[-5]
D.45.MJ.ed<-D.45.MJ[-5]

D.30.May.ed<-D.30.May[-5]
D.30.June.ed<-D.30.June[-5]
D.30.July.ed<-D.30.July[-5]
D.30.May.June.ed<-D.30.May.June[-5]
D.30.JJ.ed<-D.30.JJ[-5]
D.30.MJ.ed<-D.30.MJ[-5]

D.15.May.ed<-D.15.May[-5]
D.15.June.ed<-D.15.June[-5]
D.15.July.ed<-D.15.July[-5]
D.15.May.June.ed<-D.15.May.June[-5]
D.15.JJ.ed<-D.15.JJ[-5]
D.15.MJ.ed<-D.15.MJ[-5]

D.0.May.ed<-D.0.May[-5]
D.0.June.ed<-D.0.June[-5]
D.0.July.ed<-D.0.July[-5]
D.0.May.June.ed<-D.0.May.June[-5]
D.0.JJ.ed<-D.0.JJ[-5]
D.0.MJ.ed<-D.0.MJ[-5]

D.neg.15.May.ed<-D.neg.15.May[-5]
D.neg.15.June.ed<-D.neg.15.June[-5]
D.neg.15.July.ed<-D.neg.15.July[-5]
D.neg.15.May.June.ed<-D.neg.15.May.June[-5]
D.neg.15.JJ.ed<-D.neg.15.JJ[-5]
D.neg.15.MJ.ed<-D.neg.15.MJ[-5]

D.neg.30.May.ed<-D.neg.30.May[-5]
D.neg.30.June.ed<-D.neg.30.June[-5]
D.neg.30.July.ed<-D.neg.30.July[-5]
D.neg.30.May.June.ed<-D.neg.30.May.June[-5]
D.neg.30.JJ.ed<-D.neg.30.JJ[-5]
D.neg.30.MJ.ed<-D.neg.30.MJ[-5]


D.neg.45.May.ed<-D.neg.45.May[-5]
D.neg.45.June.ed<-D.neg.45.June[-5]
D.neg.45.July.ed<-D.neg.45.July[-5]
D.neg.45.May.June.ed<-D.neg.45.May.June[-5]
D.neg.45.JJ.ed<-D.neg.45.JJ[-5]
D.neg.45.MJ.ed<-D.neg.45.MJ[-5]

D.neg.60.May.ed<-D.neg.60.May[-5]
D.neg.60.June.ed<-D.neg.60.June[-5]
D.neg.60.July.ed<-D.neg.60.July[-5]
D.neg.60.May.June.ed<-D.neg.60.May.June[-5]
D.neg.60.JJ.ed<-D.neg.60.JJ[-5]
D.neg.60.MJ.ed<-D.neg.60.MJ[-5]


D.neg.75.May.ed<-D.neg.75.May[-5]
D.neg.75.June.ed<-D.neg.75.June[-5]
D.neg.75.July.ed<-D.neg.75.July[-5]
D.neg.75.May.June.ed<-D.neg.75.May.June[-5]
D.neg.75.JJ.ed<-D.neg.75.JJ[-5]
D.neg.75.MJ.ed<-D.neg.75.MJ[-5]

D.neg.90.May.ed<-D.neg.90.May[-5]
D.neg.90.June.ed<-D.neg.90.June[-5]
D.neg.90.July.ed<-D.neg.90.July[-5]
D.neg.90.May.June.ed<-D.neg.90.May.June[-5]
D.neg.90.JJ.ed<-D.neg.90.JJ[-5]
D.neg.90.MJ.ed<-D.neg.90.MJ[-5]


#####################################################################################################################################
#################################################     ERSST SST     #################################################################
#################################################import data set and define vars#####################################################

# Extract Bering Sea SST data from netCDF file of global monthly temperatures
# on 2x2 degree grid estimated by interpolation of available data by NOAA's Climate Data Center  


###########################################################################################################################################
########################################## Set work directory and attach libraries ########################################################
par(mfrow=c(1,1),cex.lab=1.5,cex.axis=1.25,cex=1.25) #configure axis labels

#setwd('C:/Users/Jon Richar/Desktop/Project/Datasets for analysis')			#Valkrie
setwd('C:/Documents and Settings/Jon/Desktop/Project/Datasets for analysis')		#Paladin

library(ncdf)
library(chron)
library(maps)
library(mapdata)
library(lmtest)          ####for durbin-watson AR test
library(nlme)            ##### for gls models with autoregression
library(lattice)

##########################################################################################################################################
########################################## Attach and define data ########################################################################

# Open netCDF file:
ersst <- open.ncdf("sst.mnmean.nc")



########################################### Check the dataset:############################################################

 ersst    # basic info about dimensions and variables
 get.var.ncdf(ersst, "lon")     # view longitudes (degrees East) - every 2 degrees

 get.var.ncdf(ersst, "lat")     # view latitudes - every 2 degrees

# view dates (middle of month):
 get.var.ncdf(ersst, "time")  # Days since January 1, 1800 
 d <- dates(get.var.ncdf(ersst, "time"), origin=c(1,15,1800)) #converts dates to mid-month (15th) for every month since 1954 to 2009
 d 
 
  
#d[1504]
#d[1516]
#d[1528]
#d[1540]
#d[1552]
#d[1564]
#d[1576]
#d[1588]
#d[1600]
#d[1612]
#d[1624]
#d[1636]
#d[1648]
#d[1660]
#d[1672]
#d[1684]
#d[1696]
#d[1708]
#d[1720]
#d[1732]
#d[1744]
#d[1756]
#d[1768]
#d[1780]
#d[1792]
#d[1804]
#d[1816]

SST <- get.var.ncdf(ersst, "sst")
sst<-na.omit(SST)

################################## 1978 ########################################
April.78<-sst[95:101,15:18,1492]
May.78<-sst[95:101,15:18,1493]
June.78<-sst[95:101,15:18,1494]
July.78<-sst[95:101,15:18,1495]
April.May.78<-sst[95:101,15:18,1492:1493]
May.June.78<-sst[95:101,15:18,1493:1494]
June.July.78<-sst[95:101,15:18,1494:1495]
April.July.78<-sst[95:101,15:18,1492:1495]
May.July.78<-sst[95:101,15:18,1493:1495]

mean.April.78<-mean(April.78, na.rm=T)
mean.May.78<-mean(May.78,na.rm=T)
mean.June.78<-mean(June.78,na.rm=T)
mean.July.78<-mean(July.78,na.rm=T)
mean.April.May.78<-mean(April.May.78,na.rm=T)
mean.May.June.78<-mean(May.June.78,na.rm=T)
mean.June.July.78<-mean(June.July.78,na.rm=T)
mean.April.July.78<-mean(April.July.78,na.rm=T)
mean.May.July.78<-mean(May.July.78,na.rm=T)

################################## 1979 ########################################
April.79<-sst[95:101,15:18,1504]
May.79<-sst[95:101,15:18,1505]
June.79<-sst[95:101,15:18,1506]
July.79<-sst[95:101,15:18,1507]
April.May.79<-sst[95:101,15:18,1504:1505]
May.June.79<-sst[95:101,15:18,1505:1506]
June.July.79<-sst[95:101,15:18,1506:1507]
April.July.79<-sst[95:101,15:18,1504:1507]
May.July.79<-sst[95:101,15:18,1505:1507]


mean.April.79<-mean(April.79, na.rm=T)
mean.May.79<-mean(May.79,na.rm=T)
mean.June.79<-mean(June.79,na.rm=T)
mean.July.79<-mean(July.79,na.rm=T)
mean.April.May.79<-mean(April.May.79,na.rm=T)
mean.May.June.79<-mean(May.June.79,na.rm=T)
mean.June.July.79<-mean(June.July.79,na.rm=T)
mean.April.July.79<-mean(April.July.79,na.rm=T)
mean.May.July.79<-mean(May.July.79,na.rm=T)

################################## 1980 ########################################
April.80<-sst[95:101,15:18,1516]
May.80<-sst[95:101,15:18,1517]
June.80<-sst[95:101,15:18,1518]
July.80<-sst[95:101,15:18,1519]
April.May.80<-sst[95:101,15:18,1516:1517]
May.June.80<-sst[95:101,15:18,1517:1518]
June.July.80<-sst[95:101,15:18,1518:1519]
April.July.80<-sst[95:101,15:18,1516:1519]
May.July.80<-sst[95:101,15:18,1517:1519]

mean.April.80<-mean(April.80, na.rm=T)
mean.May.80<-mean(May.80,na.rm=T)
mean.June.80<-mean(June.80,na.rm=T)
mean.July.80<-mean(July.80,na.rm=T)
mean.April.May.80<-mean(April.May.80,na.rm=T)
mean.May.June.80<-mean(May.June.80,na.rm=T)
mean.June.July.80<-mean(June.July.80,na.rm=T)
mean.April.July.80<-mean(April.July.80,na.rm=T)
mean.May.July.80<-mean(May.July.80,na.rm=T)

################################## 1981 ########################################
April.81<-sst[95:101,15:18,1528]
May.81<-sst[95:101,15:18,1529]
June.81<-sst[95:101,15:18,1530]
July.81<-sst[95:101,15:18,1531]
April.May.81<-sst[95:101,15:18,1528:1529]
May.June.81<-sst[95:101,15:18,1529:1530]
June.July.81<-sst[95:101,15:18,1530:1531]
April.July.81<-sst[95:101,15:18,1528:1531]
May.July.81<-sst[95:101,15:18,1529:1531]


mean.April.81<-mean(April.81, na.rm=T)
mean.May.81<-mean(May.81,na.rm=T)
mean.June.81<-mean(June.81,na.rm=T)
mean.July.81<-mean(July.81,na.rm=T)
mean.April.May.81<-mean(April.May.81,na.rm=T)
mean.May.June.81<-mean(May.June.81,na.rm=T)
mean.June.July.81<-mean(June.July.81,na.rm=T)
mean.April.July.81<-mean(April.July.81,na.rm=T)
mean.May.July.81<-mean(May.July.81,na.rm=T)

################################## 1982 ########################################
April.82<-sst[95:101,15:18,1540]
May.82<-sst[95:101,15:18,1541]
June.82<-sst[95:101,15:18,1542]
July.82<-sst[95:101,15:18,1543]
April.May.82<-sst[95:101,15:18,1540:1541]
May.June.82<-sst[95:101,15:18,1541:1542]
June.July.82<-sst[95:101,15:18,1542:1543]
April.July.82<-sst[95:101,15:18,1540:1543]
May.July.82<-sst[95:101,15:18,1541:1543]


mean.April.82<-mean(April.82, na.rm=T)
mean.May.82<-mean(May.82,na.rm=T)
mean.June.82<-mean(June.82,na.rm=T)
mean.July.82<-mean(July.82,na.rm=T)
mean.April.May.82<-mean(April.May.82,na.rm=T)
mean.May.June.82<-mean(May.June.82,na.rm=T)
mean.June.July.82<-mean(June.July.82,na.rm=T)
mean.April.July.82<-mean(April.July.82,na.rm=T)
mean.May.July.82<-mean(May.July.82,na.rm=T)

################################## 1983 ########################################
April.83<-sst[95:101,15:18,1552]
May.83<-sst[95:101,15:18,1553]
June.83<-sst[95:101,15:18,1554]
July.83<-sst[95:101,15:18,1555]
April.May.83<-sst[95:101,15:18,1552:1553]
May.June.83<-sst[95:101,15:18,1553:1554]
June.July.83<-sst[95:101,15:18,1554:1555]
April.July.83<-sst[95:101,15:18,1552:1555]
May.July.83<-sst[95:101,15:18,1553:1555]


mean.April.83<-mean(April.83, na.rm=T)
mean.May.83<-mean(May.83,na.rm=T)
mean.June.83<-mean(June.83,na.rm=T)
mean.July.83<-mean(July.83,na.rm=T)
mean.April.May.83<-mean(April.May.83,na.rm=T)
mean.May.June.83<-mean(May.June.83,na.rm=T)
mean.June.July.83<-mean(June.July.83,na.rm=T)
mean.April.July.83<-mean(April.July.83,na.rm=T)
mean.May.July.83<-mean(May.July.83,na.rm=T)

################################## 1984 ########################################
April.84<-sst[95:101,15:18,1564]
May.84<-sst[95:101,15:18,1565]
June.84<-sst[95:101,15:18,1566]
July.84<-sst[95:101,15:18,1567]
April.May.84<-sst[95:101,15:18,1564:1565]
May.June.84<-sst[95:101,15:18,1565:1566]
June.July.84<-sst[95:101,15:18,1566:1567]
April.July.84<-sst[95:101,15:18,1564:1567]
May.July.84<-sst[95:101,15:18,1565:1567]


mean.April.84<-mean(April.84, na.rm=T)
mean.May.84<-mean(May.84,na.rm=T)
mean.June.84<-mean(June.84,na.rm=T)
mean.July.84<-mean(July.84,na.rm=T)
mean.April.May.84<-mean(April.May.84,na.rm=T)
mean.May.June.84<-mean(May.June.84,na.rm=T)
mean.June.July.84<-mean(June.July.84,na.rm=T)
mean.April.July.84<-mean(April.July.84,na.rm=T)
mean.May.July.84<-mean(May.July.84,na.rm=T)


################################## 1985 ########################################
April.85<-sst[95:101,15:18,1576]
May.85<-sst[95:101,15:18,1577]
June.85<-sst[95:101,15:18,1578]
July.85<-sst[95:101,15:18,1579]
April.May.85<-sst[95:101,15:18,1576:1577]
May.June.85<-sst[95:101,15:18,1577:1578]
June.July.85<-sst[95:101,15:18,1578:1579]
April.July.85<-sst[95:101,15:18,1576:1579]
May.July.85<-sst[95:101,15:18,1577:1579]


mean.April.85<-mean(April.85, na.rm=T)
mean.May.85<-mean(May.85,na.rm=T)
mean.June.85<-mean(June.85,na.rm=T)
mean.July.85<-mean(July.85,na.rm=T)
mean.April.May.85<-mean(April.May.85,na.rm=T)
mean.May.June.85<-mean(May.June.85,na.rm=T)
mean.June.July.85<-mean(June.July.85,na.rm=T)
mean.April.July.85<-mean(April.July.85,na.rm=T)
mean.May.July.85<-mean(May.July.85,na.rm=T)

################################## 1986 ########################################
April.86<-sst[95:101,15:18,1588]
May.86<-sst[95:101,15:18,1589]
June.86<-sst[95:101,15:18,1590]
July.86<-sst[95:101,15:18,1591]
April.May.86<-sst[95:101,15:18,1588:1589]
May.June.86<-sst[95:101,15:18,1589:1590]
June.July.86<-sst[95:101,15:18,1590:1591]
April.July.86<-sst[95:101,15:18,1588:1591]
May.July.86<-sst[95:101,15:18,1589:1591]


mean.April.86<-mean(April.86, na.rm=T)
mean.May.86<-mean(May.86,na.rm=T)
mean.June.86<-mean(June.86,na.rm=T)
mean.July.86<-mean(July.86,na.rm=T)
mean.April.May.86<-mean(April.May.86,na.rm=T)
mean.May.June.86<-mean(May.June.86,na.rm=T)
mean.June.July.86<-mean(June.July.86,na.rm=T)
mean.April.July.86<-mean(April.July.86,na.rm=T)
mean.May.July.86<-mean(May.July.86,na.rm=T)


################################## 1987 ########################################
April.87<-sst[95:101,15:18,1600]
May.87<-sst[95:101,15:18,1601]
June.87<-sst[95:101,15:18,1602]
July.87<-sst[95:101,15:18,1603]
April.May.87<-sst[95:101,15:18,1600:1601]
May.June.87<-sst[95:101,15:18,1601:1602]
June.July.87<-sst[95:101,15:18,1602:1603]
April.July.87<-sst[95:101,15:18,1600:1603]
May.July.87<-sst[95:101,15:18,1601:1603]


mean.April.87<-mean(April.87, na.rm=T)
mean.May.87<-mean(May.87,na.rm=T)
mean.June.87<-mean(June.87,na.rm=T)
mean.July.87<-mean(July.87,na.rm=T)
mean.April.May.87<-mean(April.May.87,na.rm=T)
mean.May.June.87<-mean(May.June.87,na.rm=T)
mean.June.July.87<-mean(June.July.87,na.rm=T)
mean.April.July.87<-mean(April.July.87,na.rm=T)
mean.May.July.87<-mean(May.July.87,na.rm=T)


################################## 1988 ########################################
April.88<-sst[95:101,15:18,1612]
May.88<-sst[95:101,15:18,1613]
June.88<-sst[95:101,15:18,1614]
July.88<-sst[95:101,15:18,1615]
April.May.88<-sst[95:101,15:18,1612:1613]
May.June.88<-sst[95:101,15:18,1613:1614]
June.July.88<-sst[95:101,15:18,1614:1615]
April.July.88<-sst[95:101,15:18,1612:1615]
May.July.88<-sst[95:101,15:18,1613:1615]


mean.April.88<-mean(April.88, na.rm=T)
mean.May.88<-mean(May.88,na.rm=T)
mean.June.88<-mean(June.88,na.rm=T)
mean.July.88<-mean(July.88,na.rm=T)
mean.April.May.88<-mean(April.May.88,na.rm=T)
mean.May.June.88<-mean(May.June.88,na.rm=T)
mean.June.July.88<-mean(June.July.88,na.rm=T)
mean.April.July.88<-mean(April.July.88,na.rm=T)
mean.May.July.88<-mean(May.July.88,na.rm=T)


################################## 1989 ########################################
April.89<-sst[95:101,15:18,1624]
May.89<-sst[95:101,15:18,1625]
June.89<-sst[95:101,15:18,1626]
July.89<-sst[95:101,15:18,1627]
April.May.89<-sst[95:101,15:18,1624:1625]
May.June.89<-sst[95:101,15:18,1625:1626]
June.July.89<-sst[95:101,15:18,1626:1627]
April.July.89<-sst[95:101,15:18,1624:1627]
May.July.89<-sst[95:101,15:18,1625:1627]


mean.April.89<-mean(April.89, na.rm=T)
mean.May.89<-mean(May.89,na.rm=T)
mean.June.89<-mean(June.89,na.rm=T)
mean.July.89<-mean(July.89,na.rm=T)
mean.April.May.89<-mean(April.May.89,na.rm=T)
mean.May.June.89<-mean(May.June.89,na.rm=T)
mean.June.July.89<-mean(June.July.89,na.rm=T)
mean.April.July.89<-mean(April.July.89,na.rm=T)
mean.May.July.89<-mean(May.July.89,na.rm=T)


################################## 1990 ########################################
April.90<-sst[95:101,15:18,1636]
May.90<-sst[95:101,15:18,1637]
June.90<-sst[95:101,15:18,1638]
July.90<-sst[95:101,15:18,1639]
April.May.90<-sst[95:101,15:18,1636:1637]
May.June.90<-sst[95:101,15:18,1637:1638]
June.July.90<-sst[95:101,15:18,1638:1639]
April.July.90<-sst[95:101,15:18,1636:1639]
May.July.90<-sst[95:101,15:18,1637:1639]


mean.April.90<-mean(April.90, na.rm=T)
mean.May.90<-mean(May.90,na.rm=T)
mean.June.90<-mean(June.90,na.rm=T)
mean.July.90<-mean(July.90,na.rm=T)
mean.April.May.90<-mean(April.May.90,na.rm=T)
mean.May.June.90<-mean(May.June.90,na.rm=T)
mean.June.July.90<-mean(June.July.90,na.rm=T)
mean.April.July.90<-mean(April.July.90,na.rm=T)
mean.May.July.90<-mean(May.July.90,na.rm=T)



################################## 1991 ########################################
April.91<-sst[95:101,15:18,1648]
May.91<-sst[95:101,15:18,1649]
June.91<-sst[95:101,15:18,1650]
July.91<-sst[95:101,15:18,1651]
April.May.91<-sst[95:101,15:18,1648:1649]
May.June.91<-sst[95:101,15:18,1649:1650]
June.July.91<-sst[95:101,15:18,1650:1651]
April.July.91<-sst[95:101,15:18,1648:1651]
May.July.91<-sst[95:101,15:18,1649:1651]



mean.April.91<-mean(April.91, na.rm=T)
mean.May.91<-mean(May.91,na.rm=T)
mean.June.91<-mean(June.91,na.rm=T)
mean.July.91<-mean(July.91,na.rm=T)
mean.April.May.91<-mean(April.May.91,na.rm=T)
mean.May.June.91<-mean(May.June.91,na.rm=T)
mean.June.July.91<-mean(June.July.91,na.rm=T)
mean.April.July.91<-mean(April.July.91,na.rm=T)
mean.May.July.91<-mean(May.July.91,na.rm=T)


################################## 1992 ########################################
April.92<-sst[95:101,15:18,1660]
May.92<-sst[95:101,15:18,1661]
June.92<-sst[95:101,15:18,1662]
July.92<-sst[95:101,15:18,1663]
April.May.92<-sst[95:101,15:18,1660:1661]
May.June.92<-sst[95:101,15:18,1661:1662]
June.July.92<-sst[95:101,15:18,1662:1663]
April.July.92<-sst[95:101,15:18,1660:1663]
May.July.92<-sst[95:101,15:18,1661:1663]


mean.April.92<-mean(April.92, na.rm=T)
mean.May.92<-mean(May.92,na.rm=T)
mean.June.92<-mean(June.92,na.rm=T)
mean.July.92<-mean(July.92,na.rm=T)
mean.April.May.92<-mean(April.May.92,na.rm=T)
mean.May.June.92<-mean(May.June.92,na.rm=T)
mean.June.July.92<-mean(June.July.92,na.rm=T)
mean.April.July.92<-mean(April.July.92,na.rm=T)
mean.May.July.92<-mean(May.July.92,na.rm=T)


################################## 1993 ########################################
April.93<-sst[95:101,15:18,1672]
May.93<-sst[95:101,15:18,1673]
June.93<-sst[95:101,15:18,1674]
July.93<-sst[95:101,15:18,1675]
April.May.93<-sst[95:101,15:18,1672:1673]
May.June.93<-sst[95:101,15:18,1673:1674]
June.July.93<-sst[95:101,15:18,1674:1675]
April.July.93<-sst[95:101,15:18,1672:1675]
May.July.93<-sst[95:101,15:18,1673:1675]


mean.April.93<-mean(April.93, na.rm=T)
mean.May.93<-mean(May.93,na.rm=T)
mean.June.93<-mean(June.93,na.rm=T)
mean.July.93<-mean(July.93,na.rm=T)
mean.April.May.93<-mean(April.May.93,na.rm=T)
mean.May.June.93<-mean(May.June.93,na.rm=T)
mean.June.July.93<-mean(June.July.93,na.rm=T)
mean.April.July.93<-mean(April.July.93,na.rm=T)
mean.May.July.93<-mean(May.July.93,na.rm=T)

################################## 1994 ########################################
April.94<-sst[95:101,15:18,1684]
May.94<-sst[95:101,15:18,1685]
June.94<-sst[95:101,15:18,1686]
July.94<-sst[95:101,15:18,1687]
April.May.94<-sst[95:101,15:18,1684:1685]
May.June.94<-sst[95:101,15:18,1685:1686]
June.July.94<-sst[95:101,15:18,1686:1687]
April.July.94<-sst[95:101,15:18,1684:1687]
May.July.94<-sst[95:101,15:18,1685:1687]

mean.April.94<-mean(April.94, na.rm=T)
mean.May.94<-mean(May.94,na.rm=T)
mean.June.94<-mean(June.94,na.rm=T)
mean.July.94<-mean(July.94,na.rm=T)
mean.April.May.94<-mean(April.May.94,na.rm=T)
mean.May.June.94<-mean(May.June.94,na.rm=T)
mean.June.July.94<-mean(June.July.94,na.rm=T)
mean.April.July.94<-mean(April.July.94,na.rm=T)
mean.May.July.94<-mean(May.July.94,na.rm=T)


################################## 1995 ########################################
April.95<-sst[95:101,15:18,1696]
May.95<-sst[95:101,15:18,1697]
June.95<-sst[95:101,15:18,1698]
July.95<-sst[95:101,15:18,1699]
April.May.95<-sst[95:101,15:18,1696:1697]
May.June.95<-sst[95:101,15:18,1697:1698]
June.July.95<-sst[95:101,15:18,1698:1699]
April.July.95<-sst[95:101,15:18,1696:1699]
May.July.95<-sst[95:101,15:18,1697:1699]


mean.April.95<-mean(April.95, na.rm=T)
mean.May.95<-mean(May.95,na.rm=T)
mean.June.95<-mean(June.95,na.rm=T)
mean.July.95<-mean(July.95,na.rm=T)
mean.April.May.95<-mean(April.May.95,na.rm=T)
mean.May.June.95<-mean(May.June.95,na.rm=T)
mean.June.July.95<-mean(June.July.95,na.rm=T)
mean.April.July.95<-mean(April.July.95,na.rm=T)
mean.May.July.95<-mean(May.July.95,na.rm=T)

################################## 1996 ########################################
April.96<-sst[95:101,15:18,1708]
May.96<-sst[95:101,15:18,1709]
June.96<-sst[95:101,15:18,1710]
July.96<-sst[95:101,15:18,1711]
April.May.96<-sst[95:101,15:18,1708:1709]
May.June.96<-sst[95:101,15:18,1709:1710]
June.July.96<-sst[95:101,15:18,1710:1711]
April.July.96<-sst[95:101,15:18,1708:1711]
May.July.96<-sst[95:101,15:18,1709:1711]

mean.April.96<-mean(April.96, na.rm=T)
mean.May.96<-mean(May.96,na.rm=T)
mean.June.96<-mean(June.96,na.rm=T)
mean.July.96<-mean(July.96,na.rm=T)
mean.April.May.96<-mean(April.May.96,na.rm=T)
mean.May.June.96<-mean(May.June.96,na.rm=T)
mean.June.July.96<-mean(June.July.96,na.rm=T)
mean.April.July.96<-mean(April.July.96,na.rm=T)
mean.May.July.96<-mean(May.July.96,na.rm=T)


################################## 1997 ########################################
April.97<-sst[95:101,15:18,1720]
May.97<-sst[95:101,15:18,1721]
June.97<-sst[95:101,15:18,1722]
July.97<-sst[95:101,15:18,1723]
April.May.97<-sst[95:101,15:18,1720:1721]
May.June.97<-sst[95:101,15:18,1721:1722]
June.July.97<-sst[95:101,15:18,1722:1723]
April.July.97<-sst[95:101,15:18,1720:1723]
May.July.97<-sst[95:101,15:18,1721:1723]


mean.April.97<-mean(April.97, na.rm=T)
mean.May.97<-mean(May.97,na.rm=T)
mean.June.97<-mean(June.97,na.rm=T)
mean.July.97<-mean(July.97,na.rm=T)
mean.April.May.97<-mean(April.May.97,na.rm=T)
mean.May.June.97<-mean(May.June.97,na.rm=T)
mean.June.July.97<-mean(June.July.97,na.rm=T)
mean.April.July.97<-mean(April.July.97,na.rm=T)
mean.May.July.97<-mean(May.July.97,na.rm=T)

################################## 1998 ########################################
April.98<-sst[95:101,15:18,1732]
May.98<-sst[95:101,15:18,1733]
June.98<-sst[95:101,15:18,1734]
July.98<-sst[95:101,15:18,1735]
April.May.98<-sst[95:101,15:18,1732:1733]
May.June.98<-sst[95:101,15:18,1733:1734]
June.July.98<-sst[95:101,15:18,1734:1735]
April.July.98<-sst[95:101,15:18,1732:1735]
May.July.98<-sst[95:101,15:18,1733:1735]

mean.April.98<-mean(April.98, na.rm=T)
mean.May.98<-mean(May.98,na.rm=T)
mean.June.98<-mean(June.98,na.rm=T)
mean.July.98<-mean(July.98,na.rm=T)
mean.April.May.98<-mean(April.May.98,na.rm=T)
mean.May.June.98<-mean(May.June.98,na.rm=T)
mean.June.July.98<-mean(June.July.98,na.rm=T)
mean.April.July.98<-mean(April.July.98,na.rm=T)
mean.May.July.98<-mean(May.July.98,na.rm=T)



################################## 1999 ########################################
April.99<-sst[95:101,15:18,1744]
May.99<-sst[95:101,15:18,1745]
June.99<-sst[95:101,15:18,1746]
July.99<-sst[95:101,15:18,1747]
April.May.99<-sst[95:101,15:18,1744:1745]
May.June.99<-sst[95:101,15:18,1745:1746]
June.July.99<-sst[95:101,15:18,1746:1747]
April.July.99<-sst[95:101,15:18,1744:1747]
May.July.99<-sst[95:101,15:18,1745:1747]


mean.April.99<-mean(April.99, na.rm=T)
mean.May.99<-mean(May.99,na.rm=T)
mean.June.99<-mean(June.99,na.rm=T)
mean.July.99<-mean(July.99,na.rm=T)
mean.April.May.99<-mean(April.May.99,na.rm=T)
mean.May.June.99<-mean(May.June.99,na.rm=T)
mean.June.July.99<-mean(June.July.99,na.rm=T)
mean.April.July.99<-mean(April.July.99,na.rm=T)
mean.May.July.99<-mean(May.July.99,na.rm=T)

################################## 2000 ########################################
April.00<-sst[95:101,15:18,1756]
May.00<-sst[95:101,15:18,1757]
June.00<-sst[95:101,15:18,1758]
July.00<-sst[95:101,15:18,1759]
April.May.00<-sst[95:101,15:18,1756:1757]
May.June.00<-sst[95:101,15:18,1757:1758]
June.July.00<-sst[95:101,15:18,1758:1759]
April.July.00<-sst[95:101,15:18,1756:1759]
May.July.00<-sst[95:101,15:18,1757:1759]


mean.April.00<-mean(April.00, na.rm=T)
mean.May.00<-mean(May.00,na.rm=T)
mean.June.00<-mean(June.00,na.rm=T)
mean.July.00<-mean(July.00,na.rm=T)
mean.April.May.00<-mean(April.May.00,na.rm=T)
mean.May.June.00<-mean(May.June.00,na.rm=T)
mean.June.July.00<-mean(June.July.00,na.rm=T)
mean.April.July.00<-mean(April.July.00,na.rm=T)
mean.May.July.00<-mean(May.July.00,na.rm=T)


################################## 2001 ########################################
April.01<-sst[95:101,15:18,1768]
May.01<-sst[95:101,15:18,1769]
June.01<-sst[95:101,15:18,1770]
July.01<-sst[95:101,15:18,1771]
April.May.01<-sst[95:101,15:18,1768:1769]
May.June.01<-sst[95:101,15:18,1769:1770]
June.July.01<-sst[95:101,15:18,1770:1771]
April.July.01<-sst[95:101,15:18,1768:1771]
May.July.01<-sst[95:101,15:18,1769:1771]


mean.April.01<-mean(April.01, na.rm=T)
mean.May.01<-mean(May.01,na.rm=T)
mean.June.01<-mean(June.01,na.rm=T)
mean.July.01<-mean(July.01,na.rm=T)
mean.April.May.01<-mean(April.May.01,na.rm=T)
mean.May.June.01<-mean(May.June.01,na.rm=T)
mean.June.July.01<-mean(June.July.01,na.rm=T)
mean.April.July.01<-mean(April.July.01,na.rm=T)
mean.May.July.01<-mean(May.July.01,na.rm=T)


################################## 2002 ########################################
April.02<-sst[95:101,15:18,1780]
May.02<-sst[95:101,15:18,1781]
June.02<-sst[95:101,15:18,1782]
July.02<-sst[95:101,15:18,1783]
April.May.02<-sst[95:101,15:18,1780:1781]
May.June.02<-sst[95:101,15:18,1781:1782]
June.July.02<-sst[95:101,15:18,1782:1783]
April.July.02<-sst[95:101,15:18,1780:1783]
May.July.02<-sst[95:101,15:18,1781:1783]


mean.April.02<-mean(April.02, na.rm=T)
mean.May.02<-mean(May.02,na.rm=T)
mean.June.02<-mean(June.02,na.rm=T)
mean.July.02<-mean(July.02,na.rm=T)
mean.April.May.02<-mean(April.May.02,na.rm=T)
mean.May.June.02<-mean(May.June.02,na.rm=T)
mean.June.July.02<-mean(June.July.02,na.rm=T)
mean.April.July.02<-mean(April.July.02,na.rm=T)
mean.May.July.02<-mean(May.July.02,na.rm=T)


################################## 2003 ########################################
April.03<-sst[95:101,15:18,1792]
May.03<-sst[95:101,15:18,1793]
June.03<-sst[95:101,15:18,1794]
July.03<-sst[95:101,15:18,1795]
April.May.03<-sst[95:101,15:18,1792:1793]
May.June.03<-sst[95:101,15:18,1793:1794]
June.July.03<-sst[95:101,15:18,1794:1795]
April.July.03<-sst[95:101,15:18,1792:1795]
May.July.03<-sst[95:101,15:18,1793:1795]


mean.April.03<-mean(April.03, na.rm=T)
mean.May.03<-mean(May.03,na.rm=T)
mean.June.03<-mean(June.03,na.rm=T)
mean.July.03<-mean(July.03,na.rm=T)
mean.April.May.03<-mean(April.May.03,na.rm=T)
mean.May.June.03<-mean(May.June.03,na.rm=T)
mean.June.July.03<-mean(June.July.03,na.rm=T)
mean.April.July.03<-mean(April.July.03,na.rm=T)
mean.May.July.03<-mean(May.July.03,na.rm=T)


################################## 2004 ########################################
April.04<-sst[95:101,15:18,1804]
May.04<-sst[95:101,15:18,1805]
June.04<-sst[95:101,15:18,1806]
July.04<-sst[95:101,15:18,1807]
April.May.04<-sst[95:101,15:18,1804:1805]
May.June.04<-sst[95:101,15:18,1805:1806]
June.July.04<-sst[95:101,15:18,1806:1807]
April.July.04<-sst[95:101,15:18,1804:1807]
May.July.04<-sst[95:101,15:18,1805:1807]


mean.April.04<-mean(April.04, na.rm=T)
mean.May.04<-mean(May.04,na.rm=T)
mean.June.04<-mean(June.04,na.rm=T)
mean.July.04<-mean(July.04,na.rm=T)
mean.April.May.04<-mean(April.May.04,na.rm=T)
mean.May.June.04<-mean(May.June.04,na.rm=T)
mean.June.July.04<-mean(June.July.04,na.rm=T)
mean.April.July.04<-mean(April.July.04,na.rm=T)
mean.May.July.04<-mean(May.July.04,na.rm=T)



################################## 2005 ########################################
April.05<-sst[95:101,15:18,1816]
May.05<-sst[95:101,15:18,1817]
June.05<-sst[95:101,15:18,1818]
July.05<-sst[95:101,15:18,1819]
April.May.05<-sst[95:101,15:18,1816:1817]
May.June.05<-sst[95:101,15:18,1817:1818]
June.July.05<-sst[95:101,15:18,1818:1819]
April.July.05<-sst[95:101,15:18,1816:1819]
May.July.05<-sst[95:101,15:18,1817:1819]


mean.April.05<-mean(April.05, na.rm=T)
mean.May.05<-mean(May.05,na.rm=T)
mean.June.05<-mean(June.05,na.rm=T)
mean.July.05<-mean(July.05,na.rm=T)
mean.April.May.05<-mean(April.May.05,na.rm=T)
mean.May.June.05<-mean(May.June.05,na.rm=T)
mean.June.July.05<-mean(June.July.05,na.rm=T)
mean.April.July.05<-mean(April.July.05,na.rm=T)
mean.May.July.05<-mean(May.July.05,na.rm=T)



#####################################################################################################################################
################################################### Combine into vectors for analysis ###############################################

April.sst<-c(mean.April.78,mean.April.79,mean.April.80,mean.April.81,mean.April.82,mean.April.83,mean.April.84,mean.April.85,mean.April.86,
mean.April.87,mean.April.88,mean.April.89,mean.April.90,mean.April.91,mean.April.92,mean.April.93,mean.April.94,mean.April.95,mean.April.96,
mean.April.97,mean.April.98,mean.April.99,mean.April.00,mean.April.01,mean.April.02,mean.April.03,mean.April.04,mean.April.05)

May.sst<-c(mean.May.78,mean.May.79,mean.May.80,mean.May.81,mean.May.82,mean.May.83,mean.May.84,mean.May.85,mean.May.86,mean.May.87,mean.May.88,
mean.May.89,mean.May.90,mean.May.91,mean.May.92,mean.May.93,mean.May.94,mean.May.95,mean.May.96,mean.May.97,mean.May.98,mean.May.99,mean.May.00,
mean.May.01,mean.May.02,mean.May.03,mean.May.04,mean.May.05)

June.sst<-c(mean.June.78,mean.June.79,mean.June.80,mean.June.81,mean.June.82,mean.June.83,mean.June.84,mean.June.85,mean.June.86,mean.June.87,
mean.June.88,mean.June.89,mean.June.90,mean.June.91,mean.June.92,mean.June.93,mean.June.94,mean.June.95,mean.June.96,mean.June.97,mean.June.98,
mean.June.99,mean.June.00,mean.June.01,mean.June.02,mean.June.03,mean.June.04,mean.June.05)

July.sst<-c(mean.July.78,mean.July.79,mean.July.80,mean.July.81,mean.July.82,mean.July.83,mean.July.84,mean.July.85,mean.July.86,mean.July.87,
mean.July.88,mean.July.89,mean.July.90,mean.July.91,mean.July.92,mean.July.93,mean.July.94,mean.July.95,mean.July.96,mean.July.97,mean.July.98,
mean.July.99,mean.July.00,mean.July.01,mean.July.02,mean.July.03,mean.July.04,mean.July.05)

April.May.sst<-c(mean.April.May.78,mean.April.May.79,mean.April.May.80,mean.April.May.81,mean.April.May.82,mean.April.May.83,mean.April.May.84,mean.April.May.85,
mean.April.May.86,mean.April.May.87,mean.April.May.88,mean.April.May.89,mean.April.May.90,mean.April.May.91,mean.April.May.92,mean.April.May.93,mean.April.May.94,
mean.April.May.95,mean.April.May.96,mean.April.May.97,mean.April.May.98,mean.April.May.99,mean.April.May.00,mean.April.May.01,mean.April.May.02,mean.April.May.03,
mean.April.May.04,mean.April.May.05)

May.June.sst<-c(mean.May.June.78,mean.May.June.79,mean.May.June.80,mean.May.June.81,mean.May.June.82,mean.May.June.83,mean.May.June.84,mean.May.June.85,mean.May.June.86,
mean.May.June.87,mean.May.June.88,mean.May.June.89,mean.May.June.90,mean.May.June.91,mean.May.June.92,mean.May.June.93,mean.May.June.94,mean.May.June.95,mean.May.June.96,
mean.May.June.97,mean.May.June.98,mean.May.June.99,mean.May.June.00,mean.May.June.01,mean.May.June.02,mean.May.June.03,mean.May.June.04,mean.May.June.05)

June.July.sst<-c(mean.June.July.78,mean.June.July.79,mean.June.July.80,mean.June.July.81,mean.June.July.82,mean.June.July.83,mean.June.July.84,mean.June.July.85,mean.June.July.86,
mean.June.July.87,mean.June.July.88,mean.June.July.89,mean.June.July.90,mean.June.July.91,mean.June.July.92,mean.June.July.93,mean.June.July.94,mean.June.July.95,mean.June.July.96,
mean.June.July.97,mean.June.July.98,mean.June.July.99,mean.June.July.00,mean.June.July.01,mean.June.July.02,mean.June.July.03,mean.June.July.04,mean.June.July.05)

April.July.sst<-c(mean.April.July.78,mean.April.July.79,mean.April.July.80,mean.April.July.81,mean.April.July.82,mean.April.July.83,mean.April.July.84,mean.April.July.85,
mean.April.July.86,mean.April.July.87,mean.April.July.88,mean.April.July.89,mean.April.July.90,mean.April.July.91,mean.April.July.92,mean.April.July.93,mean.April.July.94,
mean.April.July.95,mean.April.July.96,mean.April.July.97,mean.April.July.98,mean.April.July.99,mean.April.July.00,mean.April.July.01,mean.April.July.02,mean.April.July.03,
mean.April.July.04,mean.April.July.05)

May.July.sst<-c(mean.May.July.78,mean.May.July.79,mean.May.July.80,mean.May.July.81,mean.May.July.82,mean.May.July.83,mean.May.July.84,mean.May.July.85,mean.May.July.86,
mean.May.July.87,mean.May.July.88,mean.May.July.89,mean.May.July.90,mean.May.July.91,mean.May.July.92,mean.May.July.93,mean.May.July.94,mean.May.July.95,mean.May.July.96,
mean.May.July.97,mean.May.July.98,mean.May.July.99,mean.May.July.00,mean.May.July.01,mean.May.July.02,mean.May.July.03,mean.May.July.04,mean.May.July.05)




 
#############################################################################################################################################
#################################################### Plot ###################################################################################
par(mfrow=c(2,2))
Year<-c(1978:2005)
plot(April.sst~Year,pch=16)
plot(May.sst~Year,pch=16)
plot(June.sst~Year,pch=16)
plot(July.sst~Year,pch=16)
plot(April.May.sst~Year,pch=16)
plot(May.June.sst~Year,pch=16)
plot(June.July.sst~Year,pch=16)
plot(April.July.sst~Year,pch=16)
plot(May.July.sst~Year,pch=16)

#############################################################################################################################################
#################################################### Calculate anomolies ####################################################################
#############################################################################################################################################
April.series.mean<-mean(April.sst)
April.series.mean
April.anom<-April.sst-April.series.mean
April.sst
April.anom

May.series.mean<-mean(May.sst)
May.series.mean
May.anom<-May.sst-May.series.mean
May.sst
May.anom

June.series.mean<-mean(June.sst)
June.series.mean
June.anom<-June.sst-June.series.mean
June.sst
June.anom

July.series.mean<-mean(July.sst)
July.series.mean
July.anom<-July.sst-July.series.mean
July.sst
July.anom

April.May.series.mean<-mean(April.May.sst)
April.May.series.mean
April.May.anom<-April.May.sst-April.May.series.mean
April.May.sst
April.May.anom

May.June.series.mean<-mean(May.June.sst)
May.June.series.mean
May.June.anom<-May.June.sst-May.June.series.mean
May.June.sst
May.June.anom

June.July.series.mean<-mean(June.July.sst)
June.July.series.mean
June.July.anom<-June.July.sst-June.July.series.mean
June.July.sst
June.July.anom

April.July.series.mean<-mean(April.July.sst)
April.July.series.mean
April.July.anom<-April.July.sst-April.July.series.mean
April.July.sst
April.July.anom

May.July.series.mean<-mean(May.July.sst)
May.July.series.mean
May.July.anom<-May.July.sst-May.July.series.mean
May.July.sst
May.July.anom

#####################################################################################################################################
############################################### Plot anomalies ######################################################################
plot(April.anom, pch=16)
plot(May.anom, pch=16)
plot(June.anom, pch=16)
plot(July.anom, pch=16)
plot(April.May.anom, pch=16)
plot(May.June.anom, pch=16)
plot(June.July.anom, pch=16)
plot(April.July.anom, pch=16)
plot(May.July.anom, pch=16)

####################################### Series for multivasriate analyses ######################################
################################################################################################################
April.anom
May.anom
June.anom
July.anom
April.May.anom
May.June.anom
June.July.anom
April.July.anom
May.July.anom

#################################################################################################################
######################################## Series for analyses using editted residual series ######################
May.ed<-May.anom[-5]
June.ed<-June.anom[-5]
July.ed<-July.anom[-5]
April.May.ed<-April.May.anom[-5]
May.June.ed<-May.June.anom[-5]
June.July.ed<-June.July.anom[-5]
April.July.ed<-April.July.anom[-5]
May.July.ed<-May.July.anom[-5]


#####################################################################################################################
#################################################     Survey SST     ################################################
#################################################import data set#####################################################
par(mfrow=c(2,2))
SST<-read.csv("EBS_SST.csv")
attach(SST)

###############################################define variables#####################################################

names(SST)
#Year<-SST$Year
SST.avg<-Avg.SST
SST.Anom<-SST.Anom
SST$Year
plot(SST.Anom~SST$Year,pch=16,ylab="SST anomoly",xlab="Year")
abline(h=0)



#######################################  Lag=3 for effects in first summer######################################
######################################## Note: below only works for lag=3#######################################
xi<-SST.Anom
xyear<-SST$Year
yi<-r
yyear<-Year

n <- length(yi)
xi.t<-xi[1:n]
xyear.t<-xyear[1:n]
yi
Year
xi.t
xyear.t


##############################################################################################################################################
#################################################     NBT        #############################################################################
#################################################import data set##############################################################################
par(mfrow=c(2,2))
NBT<-read.csv("NBT_Anomoly.csv")
attach(NBT)

yi<-r
n <- length(yi)
##############################################3#define variables#####################################################

names(NBT)
#Year<-NBT$Year
NBT.mean<-Mean_NBT
NBT.Anom<-NBT_Anom
NBT$Year
plot(NBT.Anom~NBT$Year,pch=16,ylab="NBT anomoly",xlab="Year")
abline(h=0)



###################################Lag=4 for effects during embryonic stage##########################################

xi<-NBT.Anom
xyear<-NBT$Year

lag.4.juvs<-yi[2:n]
yyear.t4<-Year[2:n]


NBT.lag.4<-xi[1:(n-1)]
xyear.lag.4<-xyear[1:(n-1)]

NBT.lag.4
xyear.lag.4
lag.4.juvs
yyear.t4

#######################################  Lag=3 for effects in first summer######################################
######################################## Note: below only works for lag=3#######################################
xi<-NBT.Anom
xyear<-NBT$Year

NBT.lag.3<-xi[1:n]
xyear.lag.3<-xyear[1:n]

NBT.lag.3
xyear.t3

NBT.lag.3

#####################################################################################################################################################################################
######################################################### Lag=2 for effects over course of first winter##############################################################################
names(NBT)
xi<-NBT.Anom
xyear<-NBT$Year
xyear
NBT.lag.2<-xi[2:(n+1)]
NBT.lag.2
xyear.t2<-xyear[2:(n+1)]
xyear.t2


NBT.lag.2

######################################################################################################################################################################################
##################################### 3 year rolling average of NBT anomoly for ffects during juvenile stages, note: temp in year y= mean((y-1)+y+(y+1) ##############################

anom1<-NBT$RA_3[1:29]
anom1
Mid.Year<-c(1979:2007)
Mid.Year
RA.3<-cbind(Mid.Year,anom1)
RA.3
NBT.RA.3a<-anom1[1:28]
NBT.RA.3a
xyear<-Mid.Year[1:28]
xyear


NBT.RA.3a

#######################################################################################################################################################################################
##################################### 3 year rolling average of NBT anomoly for effects during embryonic and early juvenile stages, note: temp in year y= mean((y-1)+y+(y+1)###########

anom2<-NBT$RA_3[1:29]
anom2
Mid.Year<-c(1979:2007)
Mid.Year
RA.3<-cbind(Mid.Year,anom2)
RA.3
NBT.RA.3b<-anom2[1:27]
xyear<-Mid.Year[1:27]



NBT.RA.3b

########################################################################################################################################################################################
##################################### 2 year rolling average of NBT anomoly for effects during juvenile stages, note: temp in year y= mean((y-1)+y+(y+1) ################################

NBT$RA_2
anom3<-NBT$RA_2[1:30]
anom3
First.Year<-c(1978:2007)
First.Year
RA.2<-cbind(First.Year,anom3)
RA.2
NBT.RA.2a<-anom3[1:28]
xyear<-First.Year[1:28]
xyear


RA.2a.temp<-cbind(xyear,NBT.RA.2a)
RA.2a.temp


NBT.RA.2a

####################################################################################################################################################################################
##################################### 2 year rolling average of NBT anomoly for effects during embryonic and 1st juvenile year, note: temp in year y= mean((y-1)+y+(y+1)############

NBT$RA_2
anom<-NBT$RA_2[1:30]
anom
Embryo.Year<-c(1978:2007)
Embryo.Year

NBT.RA.2b<-anom[1:27]
xyear<-Embryo.Year[1:27]
xyear
yi<-r[2:28]
yyear<-Year[2:28]
yi
yyear

RA.2b.temp<-cbind(xyear,NBT.RA.2b)
RA.2b.temp
RA.2b.recruit<-cbind(yyear,yi)
RA.2b.recruit


NBT.RA.2b


##############################################################################################################################################
#################################################   NBT using editted residual series  #############################################################################
#################################################import data set##############################################################################

par(mfrow=c(2,2))
NBT<-read.csv("NBT_Anomaly.csv")
attach(NBT)

##############################################3#define variables#####################################################

names(NBT)
#Year<-NBT$Year
NBT.mean<-Mean_NBT
NBT.Anom<-NBT_Anom
NBT$Year
plot(NBT.Anom~NBT$Year,pch=16,ylab="NBT anomoly",xlab="Year")
abline(h=0)



###################################Lag=4 for effects during embryonic stage##########################################

xi<-NBT.Anom
xyear<-NBT$Year

NBT.lag.4<-xi[1:27]
NBT.lag.4.ed<-NBT.lag.4[-4]

xyear
xyear.t4a<-xyear[1:27]
xyear.t4<-xyear.t4a[-4]


NBT4.series<-cbind(xyear.t4,NBT.4)
NBT4.series


NBT.lag.4.ed

##############################################################################################################
#######################################  Lag=3 for effects in first summer######################################
######################################## Note: below only works for lag=3#######################################
xi<-NBT.Anom
xyear<-NBT$Year



#n <- length(yi)
NBT.lag.3<-xi[1:28]
NBT.lag.3.ed<-NBT.lag.3[-5]

xyear
xyear.t3<-xyear[1:28]
NBTyear.lag.3.ed<-xyear.t3a[-5]


NBT.3
NBT.3a

NBT3.series<-cbind(xyear.t3,NBT.lag.3)
NBT3a.series<-cbind(xyear.t3a,NBT.lag.3a.edit)

NBT3.series
NBT3a.series



NBT.lag.3.ed

###################################################################################################################################################################################
######################################################### Lag=2 for effects over course of first winter##############################################################################
names(NBT)
xi<-NBT.Anom
xyear<-NBT$Year
xi
xyear

NBT.series<-cbind(xyear,xi)
NBT.series


NBT.lag.2<-xi[2:29]
NBT.lag.2.ed<-NBT.lag.2[-6]
xyear.t2<-xyear[2:29]
xyear.t2a<-xyear.t2a[-6]


NBT2.series<-cbind(xyear.t2,NBT.lag.2.edit)
NBT2.series


NBT.lag.2.ed

######################################################################################################################################################################################
##################################### 3 year rolling average of NBT anomoly for effects during juvenile stages, note: temp in year y= mean((y-1)+y+(y+1) ##############################

anom<-NBT$RA_3[1:29]
anom
Mid.Year<-c(1979:2007)
Mid.Year
RA.3<-cbind(Mid.Year,anom)
RA.3

NBT.RA.3a<-anom[1:28]
NBT.RA.3a.ed<-NBT.RA.3a[-5]
xyear.3<-Mid.Year[1:28]
xyear<-xyear.3[-5]
xyear


RA.3.series<-cbind(xyear.3,RA.3)
RA.3a.series<-cbind(xyear.3a,RA.3a)



NBT.RA.3a.ed

#######################################################################################################################################################################################
####################################1 3 year rolling average of NBT anomoly for effects during embryonic and early juvenile stages, note: temp in year y= mean((y-1)+y+(y+1)###########

anom<-NBT$RA_3[1:29]
anom
Mid.Year<-c(1979:2007)
Mid.Year
RA.3<-cbind(Mid.Year,anom)
RA.3
NBT.RA.3b<-anom[1:27]
NBT.RA.3b.ed<-NBT.RA.3b[-4]
xyear.3<-Mid.Year[1:27]
xyear<-xyear.3[-4]
xi
xyear



NBT.RA.3b.ed

########################################################################################################################################################################################
##################################### 2 year rolling average of NBT anomoly for effects during juvenile stages, note: temp in year y= mean((y-1)+y+(y+1) ################################

NBT$RA_2
anom2a<-NBT$RA_2[1:30]
anom2a
First.Year<-c(1978:2007)
First.Year
RA.2<-cbind(First.Year,anom2a)
RA.2
NBT.RA.2a<-anom2a[1:28]
NBT.RA.2a.ed<-NBT.RA.2a[-5]
xyear.2<-First.Year[1:28]
xyear<-xyear.2[-5]
xyear




RA.2a.temp<-cbind(xyear,xi)
RA.2a.temp



NBT.RA.2a.ed

####################################################################################################################################################################################
##################################### 2 year rolling average of NBT anomoly for effects during embryonic and 1st juvenile year, note: temp in year y= mean(y+y+1)############

NBT$RA_2
anom2b<-NBT$RA_2[1:30]
anom2b
Embryo.Year<-c(1978:2007)
Embryo.Year

NBT.RA.2b<-anom2b[1:27]
NBT.RA.2b

NBT.RA.2b.ed<-NBT.RA.2a[-4]
NBT.RA.2b.ed

xyear.2<-Embryo.Year[1:27]
xyear.2
xyear<-xyear.2[-4]
xyear



NBT.RA.2b.ed



##############################################################################################################################################
#################################################     Large males         #############################################################################
#################################################import data set##############################################################################

par(mfrow=c(1,1),cex.lab=1.25,cex.axis=1.25,cex=1.25) #configure axis labels
Males<-read.csv("Large_males_TS.csv")
attach(Males)
names(Males)

#Year<-Males$Year
males<-Male_abun
male.anom<-Male_anom
Males$Year
plot(males~Males$Year,pch=16,ylab="Large male abundance",xlab="Year")
abline(h=0)

yi<-r
n <- length(yi)

#######################################  Lag=3 for predation on settling #######################################
######################################## Note: below only works for lag=3#######################################
xi<-males
xyear<-Males$Year

lag.3.males<-xi[1:n]
xyear.t3<-xyear[1:n]

lag.3.males
xyear.t3


#####################################################################################################################################################################################
######################################################### Lag=2 for predation during first juve year ##############################################################################
names(Males)
xi<-males
xyear<-Males$Year
xyear

lag.2.males<-xi[2:29]
lag.2.males
xyear.t2<-xyear[2:29]
xyear.t2


lag.2.males

#####################################################################################################################################################################################
######################################################### Lag=1 for predation during second juv year ##############################################################################
names(Males)
xi<-males
xyear<-Males$Year
xyear

lag.1.males<-xi[3:30]
lag.1.males
xyear.t1<-xyear[3:30]
xyear.t1

lag1.males<-cbind(xyear.t1,lag.1.males)
lag1.males

######################################################################################################################################################################################
##################################### 3 year rolling average of male abundance for predation through juvenile stages, note: abundance in year y= mean((y-1)+y+(y+1) ##################
Males$RA.3

RA.3.a<-Males$RA.3[1:29]
RA.3.a
Mid.Year<-c(1979:2007)
Mid.Year
RA.3<-cbind(Mid.Year,RA.3.a)
RA.3

RA.3.males<-RA.3.a[2:29]
xyear<-Mid.Year[2:29]

RA.3.b<-cbind(xyear,RA.3.males)
RA.3.b

RA.3.males

########################################################################################################################################################################################
##################################### 2 year rolling average of male abundance for predation throughout juvenile stages, note: abun in year y= mean((y-1)+y+(y+1) ################################
Males$RA.2
anom1<-Males$RA.2[1:30]
anom1

First.Year<-c(1978:2007)
First.Year

xyear<-First.Year[1:28]
xyear



RA.2a.males<-anom1[1:28]

RA.2<-cbind(First.Year,anom1)
RA.2
RA.2a.males.check<-cbind(xyear,RA.2a.males)
RA.2a.males.check


RA.2a.males

#######################################################################################################################################################################################
##################################### 2 year rolling average of male abundance for effects during 2nd juvenile year and beginning of third, note: temp in year y= mean((y-1)+y+(y+1)###

Males$RA.2
anom2<-Males$RA.2[1:30]
anom2
Second.Year<-c(1979:2007)
Second.Year

RA.2bb<-cbind(Second.Year,anom2)
RA.2bb

xi.b<-anom2[2:30]

xyear<-Second.Year
xyear

RA.2b.check<-cbind(xyear,xi.b)
RA.2b.check

RA.2b.males<-xi.b[2:29]
RA.2b.males


RA.2b.recruit<-cbind(yyear,yi)
RA.2b.recruit

###############################################################################################################################################
################################################## Generate editted series for use with editted residual set ##################################

lag.3.males.ed<-lag.3.males[-5]	
lag.2.males.ed<-lag.2.males[-5]	
lag.1.males.ed<-lag.1.males[-5]
RA.3.males.ed<-RA.3.males[-5]
RA.2a.males.ed<-RA.2a.males[-5]	
RA.2b.males.ed<-RA.2b.males[-5] 

#########################################################################################################################################################################################
############################################################# Flathead sole model abundance vs. S/R residuals ##########################################################################
################################################################ Import data and define vatiables #######################################################################################

FHS.TS<-read.csv("FHS_SAFE.csv")
names(FHS.TS)
FHS.TS
attach(FHS.TS)
FHS<-Tot_biomass
FHS.anom<-BM_anom
FHS.Year<-FHS.TS$Year
FHS.rec<-Rec_anom

plot(FHS.anom~FHS.Year,ylab="flathead sole age 3+ model biomass anomoly",xlab="model year",pch=16)
abline(h=0)

plot(FHS~FHS.Year,ylab="flathead sole age 3+ model biomass",xlab="model year",pch=16)
plot(FHS.rec~FHS.Year,ylab="flathead sole age 3 recruitment anomoly",xlab="model year",pch=16)
abline(h=0)



###############################################################################################################################################################################
#################################################### Lag=3: Select data for effects during year of settling #########################################################

FHS.anom
FHS.lag.3<-FHS.anom[2:29]
FHS.lag.3
FHS.lag.3.ed<-FHS.lag.3[-5]
settle.year<-c(1978:2005)
settle.year
FHS.a<-cbind(settle.year,FHS.lag.3)
FHS.a


FHS.lag.3
FHS.lag.3.ed
###############################################################################################################################################################################
#################################################### Lag=2: Select data for effects during first year after settling #########################################################
r
FHS.anom
FHS.lag.2<-FHS.anom[3:30]
FHS.lag.2
FHS.lag.2.ed<-FHS.lag.2[-5]
First.year<-c(1979:2006)
First.year
FHS.a<-cbind(First.year,FHS.lag.2)
FHS.a


FHS.lag.2
FHS.lag.2.ed

###############################################################################################################################################################################
#################################################### Lag=1: Select data for effects during second year after settling #########################################################

FHS.anom
FHS.lag.1<-FHS.anom[4:31]
FHS.lag.1
FHS.lag.1.ed<-FHS.lag.1[-5]
Second.year<-c(1980:2007)
Second.year
FHS.a<-cbind(Second.year,FHS.lag.1)
FHS.a


FHS.lag.1
FHS.lag.1.ed
###########################################################################################################################################
########################################## Set work directory and attach libraries ########################################################
		
setwd('C:/Users/Jon Richar/Desktop/Project/Datasets for Analysis/BSC.data')#Valkrie		
setwd('C:/Documents and Settings/Jon/Desktop/Project/Datasets for analysis/BSC.data')#Paladin

############################################# PDO ##########################################################################################
pdo<-read.csv("PDO.csv")
pdo
attach(pdo)

pdos<-PDOs[79:106]

pdos

pdos.ed<-pdos[-5]
pdos.ed
############################################## Arctic oscillation #########################################################################


Arctic.osc<-read.csv("Arctic_oscillation.csv")
Arctic.osc
attach(Arctic.osc)
AO<-AOIa[28:55]


AO

AO.ed<-AO[-5]

AO.ed
##################################################################################################################################################################################
######################################################### Factors for models##################################################################################################
par(mfrow=c(1,1),cex.lab=1.5,cex.axis=1.25,cex=1.25) #configure axis labels

################################ Residual series ################
r
r6
################################ SST ############################

April.anom #28 entries 1978-
May.anom	#28 entries 1978-
June.anom	#28 entries 1978-
July.anom	#28 entries 1978-
April.May.anom	#28 entries 1978-
May.June.anom	#28 entries 1978-
June.July.anom	#28 entries 1978-
April.July.anom	#28 entries 1978-
May.July.anom	#28 entries 1978-

############################### NBT ##############################

NBT.lag.4	#27 enties beginning w/ 1978
NBT.lag.3	#28 entries beginning w/1978
NBT.lag.2 	#27 entries beginning w/1979
NBT.RA.3a	#28 entries
NBT.RA.3b	#27 entries
NBT.RA.2a	#28 entries
NBT.RA.2b	#27 entries

############################## Large males ######################

lag.3.males	#28 entries
lag.2.males	#28 entries
lag.1.males #28 entries
RA.3.males #28 entries
RA.2a.males	#28 entries
RA.2b.males #28 entries

############################## Flathead sole #######################

FHS.lag.3	#28 entries
FHS.lag.2	#28 entries
FHS.lag.1	#28 entries

############################## Wind vector components ##############

D.90.May
D.90.June
D.90.July
D.90.May.June
D.90.JJ
D.90.MJ

D.75.May
D.75.June
D.75.July
D.75.May.June
D.75.JJ
D.75.MJ

D.60.May
D.60.June
D.60.July
D.60.May.June
D.60.JJ
D.60.MJ

D.45.May
D.45.June
D.45.July
D.45.May.June
D.45.JJ
D.45.MJ

D.30.May
D.30.June
D.30.July
D.30.May.June
D.30.JJ
D.30.MJ

D.15.May
D.15.June
D.15.July
D.15.May.June
D.15.JJ
D.15.MJ

D.0.May
D.0.June
D.0.July
D.0.May.June
D.0.JJ
D.0.MJ

D.neg.15.May
D.neg.15.June
D.neg.15.July
D.neg.15.May.June
D.neg.15.JJ
D.neg.15.MJ

D.neg.30.May
D.neg.30.June
D.neg.30.July
D.neg.30.May.June
D.neg.30.JJ
D.neg.30.MJ

D.neg.45.May
D.neg.45.June
D.neg.45.July
D.neg.45.May.June
D.neg.45.JJ
D.neg.45.MJ

D.neg.60.May
D.neg.60.June
D.neg.60.July
D.neg.60.May.June
D.neg.60.JJ
D.neg.60.MJ


D.neg.75.May
D.neg.75.June
D.neg.75.July
D.neg.75.May.June
D.neg.75.JJ
D.neg.75.MJ

D.neg.90.May
D.neg.90.June
D.neg.90.July
D.neg.90.May.June
D.neg.90.JJ
D.neg.90.MJ
########################################################################################
############################### potential variables ####################################
May.anom	#28 entries 1978-
June.anom	#28 entries 1978-
May.June.anom	#28 entries 1978-

FHS.lag.3	#28 entries
FHS.lag.2	#28 entries
FHS.lag.1	#28 entries

D.neg.60.May.June
D.neg.90.May.June
D.90.May.June
#############################################################################################################################
#############################################################################################################################

par(mfrow=c(1,1),cex.lab=1.5,cex.axis=1.25,cex=1.25) #configure axis labels
Year<-c(1978:2005)
#############################################################################################################################
################################# Fit multivariate models models ###########################################################
r


############################################################################################################################
###################### Minus 90 degree component and lag 1 FHS with interaction term  #######################################

fit.1aa<-gls(r~D.neg.90.May.June+I(FHS.lag.1^2)+D.neg.90.May.June*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.1aa)
D<-resid(fit.1aa)
plot(D~Year, ylab="EBS reduced model residuals",xlab="Release Year",pch=16)

AIC(fit.1aa)
AICc(fit.1aa)
aic.1<-AIC(fit.1aa)



############################################################################################################################
################### Drop lag 1 FHS #########################################################################################

fit.1a<-gls(r~D.neg.90.May.June,correlation=corAR1(),method="ML")
summary(fit.1a)
D<-resid(fit.1a)
plot(D)
AIC(fit.1a)
AICc(fit.1a)
aic.1a<-AIC(fit.1a)

############################################################################################################################
################### Drop minus 90 degree and add lag 1 FHS #################################################################

fit.1b<-gls(r~I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.1b)
D<-resid(fit.1b)
plot(D)
AIC(fit.1b)
AICc(fit.1b)
aic.1b<-AIC(fit.1b)
############################################################################################################################
################### Drop lag 1 FHS and add lag 2 FHS #################################################################

fit.1bb<-gls(r~I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.1bb)
D<-resid(fit.1bb)
plot(D)
AIC(fit.1bb)
AICc(fit.1bb)
aic.1b<-AIC(fit.1bb)
############################################################################################################################
################### Add minus 90 degree component #########################################################################

fit.1c<-gls(r~D.neg.90.May.June+I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.1c)
D<-resid(fit.1c)
plot(D)
AIC(fit.1c)
AICc(fit.1c)
aic.1c<-AIC(fit.1c)


model.1.aic<-c(aic.1,aic.1a,aic.1b,aic.1c)
model.1.aic

##################################################################################################################################
##################### Add interaction term between minus 90 degree component and lag 2 FHS ####################################

fit.1d<-gls(r~D.neg.90.May.June+I(FHS.lag.2^2)+D.neg.90.May.June*I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.1d)
D<-resid(fit.1d)
plot(D)

AIC(fit.1d)
AICc(fit.1d)

###############################################################################################################################
##################### Add arctic oscillation  #################################################################################

fit.1e<-gls(r~D.neg.90.May.June+I(FHS.lag.2^2)+D.neg.90.May.June*I(FHS.lag.2^2)+AO,correlation=corAR1(),method="ML")
summary(fit.1e)
D<-resid(fit.1e)
plot(D)

AIC(fit.1e)
AICc(fit.1e)

###############################################################################################################################
##################### swap lag 1 FHS for lag 2 FHS  #################################################################################

fit.1ee<-gls(r~D.neg.90.May.June+I(FHS.lag.1^2)+D.neg.90.May.June*I(FHS.lag.1^2)+AO,correlation=corAR1(),method="ML")
summary(fit.1ee)
D<-resid(fit.1ee)
plot(D)

AIC(fit.1ee)
AICc(fit.1ee)

###############################################################################################################################
##################### Add lag 2 FHS with interaction with lag 1  #################################################################################
#####################       NOTE: BAD model         ###########################################################################

fit.1e3<-gls(r~D.neg.90.May.June+I(FHS.lag.1^2)+D.neg.90.May.June*I(FHS.lag.1^2)+AO+I(FHS.lag.2^2)*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.1e3)
D<-resid(fit.1e3)
plot(D)

AIC(fit.1e3)
AICc(fit.1e3)

###############################################################################################################################
##################### swap lag 2 FHS for lag 1 FHS  #################################################################################

fit.1e4<-gls(r~D.neg.90.May.June+I(FHS.lag.2^2)+D.neg.90.May.June*I(FHS.lag.2^2)+AO,correlation=corAR1(),method="ML")
summary(fit.1e4)
D<-resid(fit.1e4)
plot(D)

AIC(fit.1e4)
AICc(fit.1e4)

###############################################################################################################################
##################### Add interaction term between arctic oscillation and minus 90 degree component ###########################

fit.1f<-gls(r~D.neg.90.May.June+I(FHS.lag.2^2)+D.neg.90.May.June*I(FHS.lag.2^2)+AO+AO*D.neg.90.May.June,correlation=corAR1(),method="ML")
summary(fit.1f)
D<-resid(fit.1f)
plot(D)

AIC(fit.1f)
AICc(fit.1f)
###############################################################################################################################
##################### Add interaction term between arctic oscillation and minus 90 degree component AND swap in FHS lag 1 ###########################

fit.1ff<-gls(r~D.neg.90.May.June+I(FHS.lag.1^2)+D.neg.90.May.June*I(FHS.lag.1^2)+AO+AO*D.neg.90.May.June,correlation=corAR1(),method="ML")
summary(fit.1ff)
D<-resid(fit.1ff)
plot(D)

AIC(fit.1ff)
AICc(fit.1ff)
##################################################################################################################################
##################### Add Summer PDO #############################################################################################

fit.1g<-gls(r~D.neg.90.May.June+I(FHS.lag.2^2)+D.neg.90.May.June*I(FHS.lag.2^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.1g)
D<-resid(fit.1g)
plot(D)

AIC(fit.1g)
AICc(fit.1g)

lm.1g<-glm(r~D.neg.90.May.June+I(FHS.lag.2^2)+D.neg.90.May.June*I(FHS.lag.2^2)+AO+pdos)
step(lm.1g)

##################################################################################################################################
##################### Add Summer PDO and swap in lag 1 FHS #############################################################################################

fit.1gg<-gls(r~D.neg.90.May.June+I(FHS.lag.1^2)+D.neg.90.May.June*I(FHS.lag.1^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.1gg)
D<-resid(fit.1gg)
plot(D)

AIC(fit.1gg)
AICc(fit.1gg)

lm.1g<-glm(r~D.neg.90.May.June+I(FHS.lag.2^2)+D.neg.90.May.June*I(FHS.lag.2^2)+AO+pdos)
step(lm.1g)
###############################################################################################################################
##################### Add uinteraction term between Summer PDO and minus 90 degree component ########################################################

fit.1h<-gls(r~D.neg.90.May.June+I(FHS.lag.2^2)+D.neg.90.May.June*I(FHS.lag.2^2)+AO+pdos+pdos*D.neg.90.May.June,correlation=corAR1(),method="ML")
summary(fit.1h)
D<-resid(fit.1h)
plot(D)

AIC(fit.1h)
AICc(fit.1h)

###############################################################################################################################
#################### Reinstate interaction term between minus 90 and AO #######################################################
fit.1i<-gls(r~D.neg.90.May.June+I(FHS.lag.2^2)+D.neg.90.May.June*I(FHS.lag.2^2)+AO+pdos+pdos*D.neg.90.May.June+AO*D.neg.90.May.June,correlation=corAR1(),method="ML")
summary(fit.1i)
D<-resid(fit.1i)
plot(D)
AIC(fit.1i)
AICc(fit.1i)

################################################################################################################################
#####################  Drop all interaction terms ##############################################################################

fit.1j<-gls(r~D.neg.90.May.June+I(FHS.lag.2^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.1j)
D<-resid(fit.1j)
plot(D)
AIC(fit.1j)
AICc(fit.1j)

################################################################################################################################
#####################  Drop all interaction terms and swap in lag 1 FHS ##############################################################################

fit.1jj<-gls(r~D.neg.90.May.June+I(FHS.lag.1^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.1jj)
D<-resid(fit.1jj)
plot(D)
AIC(fit.1jj)
AICc(fit.1jj)

################################################################################################################################
#####################  Drop all interaction terms and pdos and swap in lag 1 FHS ##############################################################################

fit.1jjj<-gls(r~D.neg.90.May.June+I(FHS.lag.1^2)+AO,correlation=corAR1(),method="ML")
summary(fit.1jjj)
D<-resid(fit.1jjj)
plot(D)
AIC(fit.1jjj)
AICc(fit.1jjj)

################################################################################################################################
#####################  Drop all interaction terms and pdos and neg.90 and swap in lag 1 FHS ##############################################################################

fit.1jjjj<-gls(r~I(FHS.lag.1^2)+AO,correlation=corAR1(),method="ML")
summary(fit.1jjjj)
D<-resid(fit.1jjjj)
plot(D)
AIC(fit.1jjjj)
AICc(fit.1jjjj)

###############################################################################################################################
##################### Add May-June SST #########################################################################################

fit.1k<-gls(r~D.neg.90.May.June+I(FHS.lag.2^2)+May.June.anom+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.1k)
D<-resid(fit.1k)
plot(D)

AIC(fit.1k)
AICc(fit.1k)

################################################################################################################################
##################### Add interaction term for FHS and May-June -90 #########################################################################################

fit.1m<-gls(r~D.neg.90.May.June+I(FHS.lag.2^2)+May.June.anom+AO+pdos+D.neg.90.May.June*I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.1m)
D<-resid(fit.1m)
plot(D)

AIC(fit.1m)
AICc(fit.1m)

lm.5m<-glm(r~D.neg.90.May.June+I(FHS.lag.1^2)+May.June.anom+AO+pdos+D.neg.90.May.June*I(FHS.lag.1^2)+May.anom+lag.2.males+lag.1.males)
step(lm.5m)

summary(lm.5m)


###########################################################################################################################################
##################### Exchange neg 75 for neg 90 ###########################################################################################
#############################################################################################################################################

#############################################################################################################################
###################### Minus 75 degree component and lag 1 FHS with interaction term  #######################################

fit.2aa<-gls(r~D.neg.75.May.June+I(FHS.lag.1^2)+D.neg.75.May.June*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.2aa)
D<-resid(fit.2aa)
plot(D)

AIC(fit.2aa)
AICc(fit.2aa)
aic.1<-AIC(fit.2aa)



############################################################################################################################
################### Drop lag 1 FHS #########################################################################################

fit.2a<-gls(r~D.neg.75.May.June,correlation=corAR1(),method="ML")
summary(fit.2a)
D<-resid(fit.2a)
plot(D)
AIC(fit.2a)
AICc(fit.2a)
aic.1a<-AIC(fit.2a)

############################################################################################################################
################### Drop minus 75 degree and add lag 1 FHS #################################################################

fit.2b<-gls(r~I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.2b)
D<-resid(fit.2b)
plot(D)
AIC(fit.2b)
AICc(fit.2b)
aic.1b<-AIC(fit.2b)

############################################################################################################################
################### Drop minus 75 degree and add AO #################################################################

fit.2ba<-gls(r~AO,correlation=corAR1(),method="ML")
summary(fit.2ba)
D<-resid(fit.2ba)
plot(D)
AIC(fit.2ba)
AICc(fit.2ba)
aic.1b<-AIC(fit.2ba)
############################################################################################################################
################### Drop lag 1 FHS and add lag 2 FHS #################################################################

fit.2bb<-gls(r~I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.2bb)
D<-resid(fit.2bb)
plot(D)
AIC(fit.2bb)
AICc(fit.2bb)
aic.1b<-AIC(fit.2bb)
############################################################################################################################
################### Add minus 75 degree component #########################################################################

fit.2c<-gls(r~D.neg.75.May.June+I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.2c)
D<-resid(fit.2c)
plot(D)
AIC(fit.2c)
AICc(fit.2c)

aic.1c<-AIC(fit.1c)


model.1.aic<-c(aic.1,aic.1a,aic.1b,aic.1c)
model.1.aic

##################################################################################################################################
##################### Add interaction term between minus 75 degree component and lag 2 FHS ####################################

fit.2d<-gls(r~D.neg.75.May.June+I(FHS.lag.2^2)+D.neg.75.May.June*I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.2d)
D<-resid(fit.2d)
plot(D)

AIC(fit.2d)
AICc(fit.2d)

###############################################################################################################################
##################### Add arctic oscillation  #################################################################################

fit.2e<-gls(r~D.neg.75.May.June+I(FHS.lag.2^2)+D.neg.75.May.June*I(FHS.lag.2^2)+AO,correlation=corAR1(),method="ML")
summary(fit.2e)
D<-resid(fit.2e)
plot(D)

AIC(fit.2e)
AICc(fit.2e)

###############################################################################################################################
##################### swap lag 1 FHS for lag 2 FHS  #################################################################################

fit.2ee<-gls(r~D.neg.75.May.June+I(FHS.lag.1^2)+D.neg.75.May.June*I(FHS.lag.1^2)+AO,correlation=corAR1(),method="ML")
summary(fit.2ee)
D<-resid(fit.2ee)
plot(D)

AIC(fit.2ee)
AICc(fit.2ee)

###############################################################################################################################
##################### Add lag 2 FHS with interaction with lag 1  #################################################################################
#####################       NOTE: BAD model         ###########################################################################

fit.2e3<-gls(r~D.neg.75.May.June+I(FHS.lag.1^2)+D.neg.75.May.June*I(FHS.lag.1^2)+AO+I(FHS.lag.2^2)*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.2e3)
D<-resid(fit.2e3)
plot(D)

AIC(fit.2e3)
AICc(fit.2e3)
###############################################################################################################################
##################### Add interaction term between arctic oscillation and minus 75 degree component ###########################

fit.2f<-gls(r~D.neg.75.May.June+I(FHS.lag.2^2)+D.neg.75.May.June*I(FHS.lag.2^2)+AO+AO*D.neg.75.May.June,correlation=corAR1(),method="ML")
summary(fit.2f)
D<-resid(fit.2f)
plot(D)

AIC(fit.2f)
AICc(fit.2f)
###############################################################################################################################
##################### Add interaction term between arctic oscillation and minus 75 degree component AND swap in FHS lag 1 ###########################

fit.2ff<-gls(r~D.neg.75.May.June+I(FHS.lag.1^2)+D.neg.75.May.June*I(FHS.lag.1^2)+AO+AO*D.neg.75.May.June,correlation=corAR1(),method="ML")
summary(fit.2ff)
D<-resid(fit.2ff)
plot(D)

AIC(fit.2ff)
AICc(fit.2ff)
##################################################################################################################################
##################### Add Summer PDO #############################################################################################

fit.2g<-gls(r~D.neg.75.May.June+I(FHS.lag.2^2)+D.neg.75.May.June*I(FHS.lag.2^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.2g)
D<-resid(fit.2g)
plot(D)

AIC(fit.2g)
AICc(fit.2g)

lm.2g<-glm(r~D.neg.75.May.June+I(FHS.lag.2^2)+D.neg.75.May.June*I(FHS.lag.2^2)+AO+pdos)
step(lm.2g)

##################################################################################################################################
##################### Add Summer PDO and swap in lag 1 FHS#############################################################################################

fit.2gg<-gls(r~D.neg.75.May.June+I(FHS.lag.1^2)+D.neg.75.May.June*I(FHS.lag.1^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.2gg)
D<-resid(fit.2gg)
plot(D)

AIC(fit.2gg)
AICc(fit.2gg)

lm.2g<-glm(r~D.neg.75.May.June+I(FHS.lag.2^2)+D.neg.75.May.June*I(FHS.lag.2^2)+AO+pdos)
step(lm.2g)
###############################################################################################################################
##################### Add interaction term between Summer PDO and minus 75 degree component ########################################################

fit.2h<-gls(r~D.neg.75.May.June+I(FHS.lag.2^2)+D.neg.75.May.June*I(FHS.lag.2^2)+AO+pdos+pdos*D.neg.75.May.June,correlation=corAR1(),method="ML")
summary(fit.2h)
D<-resid(fit.2h)
plot(D)

AIC(fit.2h)
AICc(fit.2h)

###############################################################################################################################
#################### Reinstate interaction term between minus 90 and AO #######################################################
fit.2i<-gls(r~D.neg.75.May.June+I(FHS.lag.2^2)+D.neg.75.May.June*I(FHS.lag.2^2)+AO+pdos+pdos*D.neg.75.May.June+AO*D.neg.75.May.June,correlation=corAR1(),method="ML")
summary(fit.2i)
D<-resid(fit.2i)
plot(D)
AIC(fit.2i)
AICc(fit.2i)

################################################################################################################################
#####################  Drop all interaction terms ##############################################################################

fit.2j<-gls(r~D.neg.75.May.June+I(FHS.lag.2^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.2j)
D<-resid(fit.2j)
plot(D)
AIC(fit.2j)
AICc(fit.2j)

################################################################################################################################
#####################  Drop all interaction terms and swap in FHS lag 1 ##############################################################################

fit.2jj<-gls(r~D.neg.75.May.June+I(FHS.lag.1^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.2jj)
D<-resid(fit.2jj)
plot(D)
AIC(fit.2jj)
AICc(fit.2jj)


################################################################################################################################
#####################  Drop all interaction terms AND PDOS and swap in FHS lag 1  ##############################################################################

fit.2jjj<-gls(r~D.neg.75.May.June+I(FHS.lag.1^2)+AO,correlation=corAR1(),method="ML")
summary(fit.2jjj)
D<-resid(fit.2jjj)
plot(D)
AIC(fit.2jjj)
AICc(fit.2jjj)

###############################################################################################################################
##################### Add May-June SST #########################################################################################

fit.2k<-gls(r~D.neg.75.May.June+I(FHS.lag.2^2)+May.June.anom+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.2k)
D<-resid(fit.2k)
plot(D)

AIC(fit.2k)
AICc(fit.2k)

################################################################################################################################
##################### Add interaction term for FHS and May-June -90 #########################################################################################

fit.2m<-gls(r~D.neg.75.May.June+I(FHS.lag.2^2)+May.June.anom+AO+pdos+D.neg.75.May.June*I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.2m)
D<-resid(fit.2m)
plot(D)

AIC(fit.2m)
AICc(fit.2m)

################################################################################################################################
#####################  Run step wise model #########################################################################################

fit.2m<-gls(r~D.neg.75.May.June+I(FHS.lag.1^2)+May.June.anom+AO+pdos+D.neg.75.May.June*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.2m)
D<-resid(fit.2m)
plot(D)

AIC(fit.2m)
AICc(fit.2m)

lm.5m<-glm(r~D.neg.75.May.June+I(FHS.lag.1^2)+May.June.anom+AO+pdos+D.neg.75.May.June*I(FHS.lag.1^2)+May.anom+lag.2.males+lag.1.males)
step(lm.5m)

###########################################################################################################################################
##################### Exchange neg 75 for neg 60 ###########################################################################################
#############################################################################################################################################

#############################################################################################################################
###################### Minus 60 degree component and lag 1 FHS with interaction term  #######################################

fit.3aa<-gls(r~D.neg.60.May.June+I(FHS.lag.1^2)+D.neg.60.May.June*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.3aa)
D<-resid(fit.3aa)
plot(D)

AIC(fit.3aa)
AICc(fit.3aa)
aic.1<-AIC(fit.3aa)



############################################################################################################################
################### Drop lag 1 FHS #########################################################################################

fit.3a<-gls(r~D.neg.60.May.June,correlation=corAR1(),method="ML")
summary(fit.3a)
D<-resid(fit.3a)
plot(D)
AIC(fit.3a)
AICc(fit.3a)
aic.1a<-AIC(fit.3a)

############################################################################################################################
################### Drop neg 60 and add AO #########################################################################################

fit.3aa<-gls(r~AO,correlation=corAR1(),method="ML")
summary(fit.3aa)
D<-resid(fit.3aa)
plot(D)
AIC(fit.3aa)
AICc(fit.3aa)
aic.1a<-AIC(fit.3aa)
############################################################################################################################
################### Drop minus 75 degree and add lag 1 FHS #################################################################

fit.3b<-gls(r~I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.3b)
D<-resid(fit.3b)
plot(D)
AIC(fit.3b)
AICc(fit.3b)
aic.1b<-AIC(fit.3b)
############################################################################################################################
################### Drop lag 1 FHS and add lag 2 FHS #################################################################

fit.3bb<-gls(r~I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.3bb)
D<-resid(fit.3bb)
plot(D)
AIC(fit.3bb)
AICc(fit.3bb)
aic.1b<-AIC(fit.3bb)
############################################################################################################################
################### Add minus 60 degree component #########################################################################

fit.3c<-gls(r~D.neg.60.May.June+I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.3c)
D<-resid(fit.3c)
plot(D)
AIC(fit.3c)
AICc(fit.3c)

aic.1c<-AIC(fit.3c)


model.1.aic<-c(aic.1,aic.1a,aic.1b,aic.1c)
model.1.aic

##################################################################################################################################
##################### Add interaction term between minus 75 degree component and lag 2 FHS ####################################

fit.3d<-gls(r~D.neg.60.May.June+I(FHS.lag.2^2)+D.neg.60.May.June*I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.3d)
D<-resid(fit.3d)
plot(D)

AIC(fit.3d)
AICc(fit.3d)

###############################################################################################################################
##################### Add arctic oscillation  #################################################################################

fit.3e<-gls(r~D.neg.60.May.June+I(FHS.lag.2^2)+D.neg.60.May.June*I(FHS.lag.2^2)+AO,correlation=corAR1(),method="ML")
summary(fit.3e)
D<-resid(fit.3e)
plot(D)

AIC(fit.3e)
AICc(fit.3e)

###############################################################################################################################
##################### swap lag 1 FHS for lag 2 FHS  #################################################################################

fit.3ee<-gls(r~D.neg.60.May.June+I(FHS.lag.1^2)+D.neg.60.May.June*I(FHS.lag.1^2)+AO,correlation=corAR1(),method="ML")
summary(fit.3ee)
D<-resid(fit.3ee)
plot(D)

AIC(fit.3ee)
AICc(fit.3ee)

###############################################################################################################################
##################### Add lag 2 FHS with interaction with lag 1  #################################################################################
#####################       NOTE: BAD model         ###########################################################################

fit.3e3<-gls(r~D.neg.60.May.June+I(FHS.lag.1^2)+D.neg.60.May.June*I(FHS.lag.1^2)+AO+I(FHS.lag.2^2)*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.3e3)
D<-resid(fit.3e3)
plot(D)

AIC(fit.3e3)
AICc(fit.3e3)
###############################################################################################################################
##################### Add interaction term between arctic oscillation and minus 60 degree component ###########################

fit.3f<-gls(r~D.neg.60.May.June+I(FHS.lag.2^2)+D.neg.60.May.June*I(FHS.lag.2^2)+AO+AO*D.neg.60.May.June,correlation=corAR1(),method="ML")
summary(fit.3f)
D<-resid(fit.3f)
plot(D)

AIC(fit.3f)
AICc(fit.3f)
###############################################################################################################################
##################### Add interaction term between arctic oscillation and minus 60 degree component AND swap in FHS lag 1 ###########################

fit.3ff<-gls(r~D.neg.60.May.June+I(FHS.lag.1^2)+D.neg.60.May.June*I(FHS.lag.1^2)+AO+AO*D.neg.60.May.June,correlation=corAR1(),method="ML")
summary(fit.3ff)
D<-resid(fit.3ff)
plot(D)

AIC(fit.3ff)
AICc(fit.3ff)
##################################################################################################################################
##################### Add Summer PDO #############################################################################################

fit.3g<-gls(r~D.neg.60.May.June+I(FHS.lag.2^2)+D.neg.60.May.June*I(FHS.lag.2^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.3g)
D<-resid(fit.3g)
plot(D)

AIC(fit.3g)
AICc(fit.3g)

lm.2g<-glm(r~D.neg.60.May.June+I(FHS.lag.2^2)+D.neg.60.May.June*I(FHS.lag.2^2)+AO+pdos)
step(lm.2g)
###############################################################################################################################
##################### Add uinteraction term between Summer PDO and minus 60 degree component ########################################################

fit.3h<-gls(r~D.neg.60.May.June+I(FHS.lag.2^2)+D.neg.60.May.June*I(FHS.lag.2^2)+AO+pdos+pdos*D.neg.60.May.June,correlation=corAR1(),method="ML")
summary(fit.3h)
D<-resid(fit.3h)
plot(D)

AIC(fit.3h)
AICc(fit.3h)

###############################################################################################################################
#################### Reinstate interaction term between minus 60 and AO #######################################################
fit.3i<-gls(r~D.neg.60.May.June+I(FHS.lag.2^2)+D.neg.60.May.June*I(FHS.lag.2^2)+AO+pdos+pdos*D.neg.60.May.June+AO*D.neg.60.May.June,correlation=corAR1(),method="ML")
summary(fit.3i)
D<-resid(fit.3i)
plot(D)
AIC(fit.3i)
AICc(fit.3i)

################################################################################################################################
#####################  Drop all interaction terms ##############################################################################

fit.3j<-gls(r~D.neg.60.May.June+I(FHS.lag.2^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.3j)
D<-resid(fit.3j)
plot(D)
AIC(fit.3j)
AICc(fit.3j)

################################################################################################################################
##################### AS EXPERIMENT: Drop pdos ##############################################################################

fit.3jj<-gls(r~D.neg.60.May.June+I(FHS.lag.2^2)+AO,correlation=corAR1(),method="ML")
summary(fit.3jj)
D<-resid(fit.3jj)
plot(D)
AIC(fit.3jj)
AICc(fit.3jj)

###############################################################################################################################
##################### Add May-June SST #########################################################################################

fit.3k<-gls(r~D.neg.60.May.June+I(FHS.lag.2^2)+May.June.anom+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.3k)
D<-resid(fit.3k)
plot(D)

AIC(fit.3k)
AICc(fit.3k)

################################################################################################################################
##################### Add interaction term for FHS and May-June -90 #########################################################################################

fit.3m<-gls(r~D.neg.60.May.June+I(FHS.lag.2^2)+May.June.anom+AO+pdos+D.neg.60.May.June*I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.3m)
D<-resid(fit.3m)
plot(D)

AIC(fit.3m)
AICc(fit.3m)



###########################################################################################################################################
##################### Exchange POSITIVE 90 for neg 60 ###########################################################################################
#############################################################################################################################################

#############################################################################################################################
###################### Minus 60 degree component and lag 1 FHS with interaction term  #######################################

fit.4aa<-gls(r~D.90.May.June+I(FHS.lag.1^2)+D.90.May.June*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.4aa)
D<-resid(fit.4aa)
plot(D)

AIC(fit.4aa)
AICc(fit.4aa)
aic.1<-AIC(fit.4aa)



############################################################################################################################
################### Drop lag 1 FHS #########################################################################################

fit.4a<-gls(r~D.90.May.June,correlation=corAR1(),method="ML")
summary(fit.4a)
D<-resid(fit.4a)
plot(D)
AIC(fit.4a)
AICc(fit.4a)
aic.1a<-AIC(fit.4a)

############################################################################################################################
################### Drop 90 degree and add lag 1 FHS #################################################################

fit.4b<-gls(r~I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.4b)
D<-resid(fit.4b)
plot(D)
AIC(fit.4b)
AICc(fit.4b)
aic.1b<-AIC(fit.3b)
############################################################################################################################
################### Drop lag 1 FHS and add lag 2 FHS #################################################################

fit.4bb<-gls(r~I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.4bb)
D<-resid(fit.4bb)
plot(D)
AIC(fit.4bb)
AICc(fit.4bb)
aic.1b<-AIC(fit.4bb)
############################################################################################################################
################### Add minus 90 degree component #########################################################################

fit.4c<-gls(r~D.90.May.June+I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.4c)
D<-resid(fit.4c)
plot(D)
AIC(fit.4c)
AICc(fit.4c)

aic.1c<-AIC(fit.4c)


model.1.aic<-c(aic.1,aic.1a,aic.1b,aic.1c)
model.1.aic

##################################################################################################################################
##################### Add interaction term between 90 degree component and lag 2 FHS ####################################

fit.4d<-gls(r~D.90.May.June+I(FHS.lag.2^2)+D.90.May.June*I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.4d)
D<-resid(fit.4d)
plot(D)

AIC(fit.4d)
AICc(fit.4d)

###############################################################################################################################
##################### Add arctic oscillation  #################################################################################

fit.4e<-gls(r~D.90.May.June+I(FHS.lag.2^2)+D.90.May.June*I(FHS.lag.2^2)+AO,correlation=corAR1(),method="ML")
summary(fit.4e)
D<-resid(fit.4e)
plot(D)

AIC(fit.4e)
AICc(fit.4e)

###############################################################################################################################
##################### swap lag 1 FHS for lag 2 FHS  #################################################################################

fit.4ee<-gls(r~D.90.May.June+I(FHS.lag.1^2)+D.90.May.June*I(FHS.lag.1^2)+AO,correlation=corAR1(),method="ML")
summary(fit.4ee)
D<-resid(fit.4ee)
plot(D)

AIC(fit.4ee)
AICc(fit.4ee)

###############################################################################################################################
##################### Add lag 2 FHS with interaction with lag 1  #################################################################################
#####################       NOTE: BAD model         ###########################################################################

fit.4e3<-gls(r~D.90.May.June+I(FHS.lag.1^2)+D.90.May.June*I(FHS.lag.1^2)+AO+I(FHS.lag.2^2)*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.4e3)
D<-resid(fit.4e3)
plot(D)

AIC(fit.4e3)
AICc(fit.4e3)
###############################################################################################################################
##################### Add interaction term between arctic oscillation and minus 90 degree component ###########################

fit.4f<-gls(r~D.90.May.June+I(FHS.lag.2^2)+D.90.May.June*I(FHS.lag.2^2)+AO+AO*D.90.May.June,correlation=corAR1(),method="ML")
summary(fit.4f)
D<-resid(fit.4f)
plot(D)

AIC(fit.4f)
AICc(fit.4f)
###############################################################################################################################
##################### Add interaction term between arctic oscillation and 90 degree component AND swap in FHS lag 1 ###########################

fit.4ff<-gls(r~D.90.May.June+I(FHS.lag.1^2)+D.90.May.June*I(FHS.lag.1^2)+AO+AO*D.90.May.June,correlation=corAR1(),method="ML")
summary(fit.4ff)
D<-resid(fit.4ff)
plot(D)

AIC(fit.4ff)
AICc(fit.4ff)

##################################################################################################################################
##################### Add Summer PDO #############################################################################################

fit.4g<-gls(r~D.90.May.June+I(FHS.lag.2^2)+D.90.May.June*I(FHS.lag.2^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.4g)
D<-resid(fit.4g)
plot(D)

AIC(fit.4g)
AICc(fit.4g)

lm.2g<-glm(r~D.neg.60.May.June+I(FHS.lag.2^2)+D.neg.60.May.June*I(FHS.lag.2^2)+AO+pdos)
step(lm.2g)

##################################################################################################################################
##################### Add Summer PDO and swap in lag 1 FHS #############################################################################################

fit.4gg<-gls(r~D.90.May.June+I(FHS.lag.1^2)+D.90.May.June*I(FHS.lag.1^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.4gg)
D<-resid(fit.4gg)
plot(D)

AIC(fit.4gg)
AICc(fit.4gg)

lm.2g<-glm(r~D.neg.60.May.June+I(FHS.lag.2^2)+D.neg.60.May.June*I(FHS.lag.2^2)+AO+pdos)
step(lm.2g)
###############################################################################################################################
##################### Add interaction term between Summer PDO and 90 degree component ########################################################

fit.4h<-gls(r~D.90.May.June+I(FHS.lag.2^2)+D.90.May.June*I(FHS.lag.2^2)+AO+pdos+pdos*D.90.May.June,correlation=corAR1(),method="ML")
summary(fit.4h)
D<-resid(fit.4h)
plot(D)

AIC(fit.4h)
AICc(fit.4h)

###############################################################################################################################
#################### Reinstate interaction term between 90 and AO #######################################################
fit.4i<-gls(r~D.90.May.June+I(FHS.lag.2^2)+D.90.May.June*I(FHS.lag.2^2)+AO+pdos+pdos*D.90.May.June+AO*D.90.May.June,correlation=corAR1(),method="ML")
summary(fit.4i)
D<-resid(fit.4i)
plot(D)
AIC(fit.4i)
AICc(fit.4i)

################################################################################################################################
#####################  Drop all interaction terms ##############################################################################

fit.4j<-gls(r~D.90.May.June+I(FHS.lag.2^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.4j)
D<-resid(fit.4j)
plot(D)
AIC(fit.4j)
AICc(fit.4j)

################################################################################################################################
#####################  Drop all interaction terms and swap in lag 1 FHS ##############################################################################

fit.4jj<-gls(r~D.90.May.June+I(FHS.lag.1^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.4jj)
D<-resid(fit.4jj)
plot(D)
AIC(fit.4jj)
AICc(fit.4jj)

###############################################################################################################################
##################### Drop all interaction terms and PDOS and swap in lag 1 FHS #########################################

fit.4jjj<-gls(r~D.90.May.June+I(FHS.lag.1^2)+AO,correlation=corAR1(),method="ML")
summary(fit.4jjj)
D<-resid(fit.4jjj)
plot(D)

AIC(fit.4jjj)
AICc(fit.4jjj)
###############################################################################################################################
##################### Add May-June SST #########################################################################################

fit.4k<-gls(r~D.90.May.June+I(FHS.lag.2^2)+May.June.anom+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.4k)
D<-resid(fit.4k)
plot(D)

AIC(fit.4k)
AICc(fit.4k)

################################################################################################################################
##################### Add interaction term for FHS and May-June 90 #########################################################################################

fit.4m<-gls(r~D.90.May.June+I(FHS.lag.2^2)+May.June.anom+AO+pdos+D.90.May.June*I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.4m)
D<-resid(fit.4m)
plot(D)

AIC(fit.4m)
AICc(fit.4m)

###############################################################################################################################
###################### Add lag 2 males #########################################################################################

fit.4n<-gls(r~D.90.May.June+I(FHS.lag.2^2)+lag.2.males+May.June.anom+AO+pdos+D.90.May.June*I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.4n)
D<-resid(fit.4n)
plot(D)

AIC(fit.4n)
AICc(fit.4n)
###############################################################################################################################
###################### TEST #########################################################################################

fit.4nn<-gls(r~D.90.May.June+I(FHS.lag.2^2)+lag.2.males+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.4nn)
D<-resid(fit.4nn)
plot(D)

AIC(fit.4nn)
AICc(fit.4nn)

################################################################################################################################
##################### Add RA3a NBT #########################################################################################

fit.4o<-gls(r~D.90.May.June+I(FHS.lag.2^2)+NBT.RA.3a+May.June.anom+AO+pdos+D.90.May.June*I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.4o)
D<-resid(fit.4o)
plot(D)

AIC(fit.4o)
AICc(fit.4o)

################################################################################################################################
##################### TEST #########################################################################################

fit.4oo<-gls(r~D.90.May.June+I(FHS.lag.1^2)+NBT.RA.3b+AO+pdos+D.90.May.June*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.4oo)
D<-resid(fit.4oo)
plot(D)

AIC(fit.4oo)
AICc(fit.4oo)

################################################################################################################################
##################### Add lag 2 NBT #########################################################################################

fit.4p<-gls(r~D.90.May.June+I(FHS.lag.2^2)+May.June.anom+AO+pdos+D.90.May.June*I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.4p)
D<-resid(fit.4p)
plot(D)

AIC(fit.4p)
AICc(fit.4p)


############################################################################################################################
###################### Drop 90 degrees and use POSITIVE 75 degrees ###################################################
##############################################################################################################################

fit.5aa<-gls(r~D.75.May.June+I(FHS.lag.1^2)+D.75.May.June*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.5aa)
D<-resid(fit.5aa)
plot(D)

AIC(fit.5aa)
AICc(fit.5aa)
aic.5<-AIC(fit.5aa)



############################################################################################################################
################### Drop lag 1 FHS #########################################################################################

fit.5a<-gls(r~D.75.May.June,correlation=corAR1(),method="ML")
summary(fit.5a)
D<-resid(fit.5a)
plot(D)
AIC(fit.5a)
AICc(fit.5a)
aic.5a<-AIC(fit.5a)

############################################################################################################################
################### Drop minus 90 degree and add lag 1 FHS #################################################################

fit.5b<-gls(r~I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.5b)
D<-resid(fit.5b)
plot(D)
AIC(fit.5b)
AICc(fit.5b)
aic.5b<-AIC(fit.5b)
############################################################################################################################
################### Drop lag 1 FHS and add lag 2 FHS #################################################################

fit.5bb<-gls(r~I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.5bb)
D<-resid(fit.5bb)
plot(D)
AIC(fit.5bb)
AICc(fit.5bb)
aic.5bb<-AIC(fit.5bb)
############################################################################################################################
################### Add minus 90 degree component #########################################################################

fit.5c<-gls(r~D.75.May.June+I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.5c)
D<-resid(fit.5c)
plot(D)
AIC(fit.5c)
AICc(fit.5c)
aic.1c<-AIC(fit.5c)


model.5.aic<-c(aic.5,aic.5a,aic.5b,aic.5c)
model.5.aic

##################################################################################################################################
##################### Add interaction term between minus 90 degree component and lag 2 FHS ####################################

fit.5d<-gls(r~D.75.May.June+I(FHS.lag.2^2)+D.75.May.June*I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.5d)
D<-resid(fit.5d)
plot(D)

AIC(fit.5d)
AICc(fit.5d)

###############################################################################################################################
##################### Add arctic oscillation  #################################################################################

fit.5e<-gls(r~D.75.May.June+I(FHS.lag.2^2)+D.75.May.June*I(FHS.lag.2^2)+AO,correlation=corAR1(),method="ML")
summary(fit.5e)
D<-resid(fit.5e)
plot(D)

AIC(fit.5e)
AICc(fit.5e)

###############################################################################################################################
##################### swap lag 1 FHS for lag 2 FHS  #################################################################################

fit.5ee<-gls(r~D.75.May.June+I(FHS.lag.1^2)+D.75.May.June*I(FHS.lag.1^2)+AO,correlation=corAR1(),method="ML")
summary(fit.5ee)
D<-resid(fit.5ee)
plot(D)

AIC(fit.5ee)
AICc(fit.5ee)

###############################################################################################################################
##################### Add lag 2 FHS with interaction with lag 1  #################################################################################
#####################       NOTE: BAD model         ###########################################################################

fit.5e3<-gls(r~D.75.May.June+I(FHS.lag.1^2)+D.75.May.June*I(FHS.lag.1^2)+AO+I(FHS.lag.2^2)*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.5e3)
D<-resid(fit.5e3)
plot(D)

AIC(fit.5e3)
AICc(fit.5e3)

###############################################################################################################################
##################### Add interaction term between arctic oscillation and minus 90 degree component ###########################

fit.5f<-gls(r~D.75.May.June+I(FHS.lag.2^2)+D.75.May.June*I(FHS.lag.2^2)+AO+AO*D.75.May.June,correlation=corAR1(),method="ML")
summary(fit.5f)
D<-resid(fit.5f)
plot(D)

AIC(fit.5f)
AICc(fit.5f)

###############################################################################################################################
##################### Add interaction term between arctic oscillation and minus 90 degree component AND swap in FHS lag 1 ###########################

fit.5ff<-gls(r~D.75.May.June+I(FHS.lag.1^2)+D.75.May.June*I(FHS.lag.1^2)+AO+AO*D.75.May.June,correlation=corAR1(),method="ML")
summary(fit.5ff)
D<-resid(fit.5ff)
plot(D)

AIC(fit.5ff)
AICc(fit.5ff)

##################################################################################################################################
##################### Add Summer PDO #############################################################################################

fit.5g<-gls(r~D.75.May.June+I(FHS.lag.2^2)+D.75.May.June*I(FHS.lag.2^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.5g)
D<-resid(fit.5g)
plot(D)

AIC(fit.5g)
AICc(fit.5g)

lm.1g<-glm(r~D.75.May.June+I(FHS.lag.2^2)+D.75.May.June*I(FHS.lag.2^2)+AO+pdos)
step(lm.1g)
###############################################################################################################################
##################### Add uinteraction term between Summer PDO and minus 90 degree component ########################################################

fit.5h<-gls(r~D.75.May.June+I(FHS.lag.2^2)+D.75.May.June*I(FHS.lag.2^2)+AO+pdos+pdos*D.75.May.June,correlation=corAR1(),method="ML")
summary(fit.5h)
D<-resid(fit.5h)
plot(D)

AIC(fit.5h)
AICc(fit.5h)

###############################################################################################################################
#################### Reinstate interaction term between minus 90 and AO #######################################################
fit.5i<-gls(r~D.75.May.June+I(FHS.lag.2^2)+D.75.May.June*I(FHS.lag.2^2)+AO+pdos+pdos*D.75.May.June+AO*D.75.May.June,correlation=corAR1(),method="ML")
summary(fit.5i)
D<-resid(fit.5i)
plot(D)
AIC(fit.5i)
AICc(fit.5i)

################################################################################################################################
#####################  Drop all interaction terms ##############################################################################

fit.5j<-gls(r~D.75.May.June+I(FHS.lag.2^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.5j)
D<-resid(fit.5j)
plot(D)
AIC(fit.5j)
AICc(fit.5j)

################################################################################################################################
#####################  Drop all interaction terms and swap in lag 1 FHS ##############################################################################

fit.5jj<-gls(r~D.75.May.June+I(FHS.lag.1^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.5jj)
D<-resid(fit.5jj)
plot(D)
AIC(fit.5jj)
AICc(fit.5jj)


###############################################################################################################################
##################### Add May-June SST #########################################################################################

fit.5k<-gls(r~D.75.May.June+I(FHS.lag.2^2)+May.June.anom+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.5k)
D<-resid(fit.5k)
plot(D)

AIC(fit.5k)
AICc(fit.5k)

################################################################################################################################
##################### Add interaction term for FHS and May-June -90 #########################################################################################

fit.5m<-gls(r~D.75.May.June+I(FHS.lag.2^2)+May.June.anom+AO+pdos+D.75.May.June*I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.5m)
D<-resid(fit.5m)
plot(D)

AIC(fit.5m)
AICc(fit.5m)




############################################################################################################################
###################### Drop 75 degrees and use POSITIVE 60 degrees ###################################################
##############################################################################################################################

fit.5aa<-gls(r~D.60.May.June+I(FHS.lag.1^2)+D.60.May.June*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.5aa)
D<-resid(fit.5aa)
plot(D)

AIC(fit.5aa)
AICc(fit.5aa)
aic.5<-AIC(fit.5aa)



############################################################################################################################
################### Drop lag 1 FHS #########################################################################################

fit.5a<-gls(r~D.60.May.June,correlation=corAR1(),method="ML")
summary(fit.5a)
D<-resid(fit.5a)
plot(D)
AIC(fit.5a)
AICc(fit.5a)
aic.5a<-AIC(fit.5a)

############################################################################################################################
################### Drop minus 90 degree and add lag 1 FHS #################################################################

fit.5b<-gls(r~I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.5b)
D<-resid(fit.5b)
plot(D)
AIC(fit.5b)
AICc(fit.5b)
aic.5b<-AIC(fit.5b)
############################################################################################################################
################### Drop lag 1 FHS and add lag 2 FHS #################################################################

fit.5bb<-gls(r~I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.5bb)
D<-resid(fit.5bb)
plot(D)
AIC(fit.5bb)
AICc(fit.5bb)
aic.5bb<-AIC(fit.5bb)

############################################################################################################################
################### Drop lag 1 FHS and add AO #################################################################

fit.5ba<-gls(r~AO,correlation=corAR1(),method="ML")
summary(fit.5ba)
D<-resid(fit.5ba)
plot(D)
AIC(fit.5ba)
AICc(fit.5ba)
aic.5bb<-AIC(fit.5ba)
############################################################################################################################
################### Add minus 90 degree component #########################################################################

fit.5c<-gls(r~D.60.May.June+I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.5c)
D<-resid(fit.5c)
plot(D)
AIC(fit.5c)
AICc(fit.5c)
aic.1c<-AIC(fit.5c)


model.5.aic<-c(aic.5,aic.5a,aic.5b,aic.5c)
model.5.aic

##################################################################################################################################
##################### Add interaction term between minus 90 degree component and lag 2 FHS ####################################

fit.5d<-gls(r~D.60.May.June+I(FHS.lag.2^2)+D.60.May.June*I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.5d)
D<-resid(fit.5d)
plot(D)

AIC(fit.5d)
AICc(fit.5d)

###############################################################################################################################
##################### Add arctic oscillation  #################################################################################

fit.5e<-gls(r~D.60.May.June+I(FHS.lag.2^2)+D.60.May.June*I(FHS.lag.2^2)+AO,correlation=corAR1(),method="ML")
summary(fit.5e)
D<-resid(fit.5e)
plot(D)

AIC(fit.5e)
AICc(fit.5e)

###############################################################################################################################
##################### swap lag 1 FHS for lag 2 FHS  #################################################################################

fit.5ee<-gls(r~D.60.May.June+I(FHS.lag.1^2)+D.60.May.June*I(FHS.lag.1^2)+AO,correlation=corAR1(),method="ML")
summary(fit.5ee)
D<-resid(fit.5ee)
plot(D)

AIC(fit.5ee)
AICc(fit.5ee)

###############################################################################################################################
##################### Add lag 2 FHS with interaction with lag 1  #################################################################################
#####################       NOTE: BAD model         ###########################################################################

fit.5e3<-gls(r~D.60.May.June+I(FHS.lag.1^2)+D.60.May.June*I(FHS.lag.1^2)+AO+I(FHS.lag.2^2)*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.5e3)
D<-resid(fit.5e3)
plot(D)

AIC(fit.5e3)
AICc(fit.5e3)

###############################################################################################################################
##################### Add interaction term between arctic oscillation and minus 90 degree component ###########################

fit.5f<-gls(r~D.60.May.June+I(FHS.lag.2^2)+D.60.May.June*I(FHS.lag.2^2)+AO+AO*D.60.May.June,correlation=corAR1(),method="ML")
summary(fit.5f)
D<-resid(fit.5f)
plot(D)

AIC(fit.5f)
AICc(fit.5f)

###############################################################################################################################
##################### Add interaction term between arctic oscillation and minus 90 degree component AND swap in FHS lag 1 ###########################

fit.5ff<-gls(r~D.60.May.June+I(FHS.lag.1^2)+D.60.May.June*I(FHS.lag.1^2)+AO+AO*D.60.May.June,correlation=corAR1(),method="ML")
summary(fit.5ff)
D<-resid(fit.5ff)
plot(D)

AIC(fit.5ff)
AICc(fit.5ff)

##################################################################################################################################
##################### Add Summer PDO #############################################################################################

fit.5g<-gls(r~D.60.May.June+I(FHS.lag.2^2)+D.60.May.June*I(FHS.lag.2^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.5g)
D<-resid(fit.5g)
plot(D)

AIC(fit.5g)
AICc(fit.5g)

lm.1g<-glm(r~D.60.May.June+I(FHS.lag.2^2)+D.60.May.June*I(FHS.lag.2^2)+AO+pdos)
step(lm.1g)
###############################################################################################################################
##################### Add uinteraction term between Summer PDO and minus 90 degree component ########################################################

fit.5h<-gls(r~D.60.May.June+I(FHS.lag.2^2)+D.60.May.June*I(FHS.lag.2^2)+AO+pdos+pdos*D.60.May.June,correlation=corAR1(),method="ML")
summary(fit.5h)
D<-resid(fit.5h)
plot(D)

AIC(fit.5h)
AICc(fit.5h)

###############################################################################################################################
#################### Reinstate interaction term between minus 90 and AO #######################################################
fit.5i<-gls(r~D.60.May.June+I(FHS.lag.2^2)+D.60.May.June*I(FHS.lag.2^2)+AO+pdos+pdos*D.60.May.June+AO*D.60.May.June,correlation=corAR1(),method="ML")
summary(fit.5i)
D<-resid(fit.5i)
plot(D)
AIC(fit.5i)
AICc(fit.5i)

################################################################################################################################
#####################  Drop all interaction terms ##############################################################################

fit.5j<-gls(r~D.60.May.June+I(FHS.lag.2^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.5j)
D<-resid(fit.5j)
plot(D)
AIC(fit.5j)
AICc(fit.5j)

################################################################################################################################
#####################  Drop all interaction terms and swap in lag 1 FHS ##############################################################################

fit.5jj<-gls(r~D.60.May.June+I(FHS.lag.1^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.5jj)
D<-resid(fit.5jj)
plot(D)
AIC(fit.5jj)
AICc(fit.5jj)

################################################################################################################################
#####################  Drop all interaction terms and swap in lag 1 FHS and drop 60 degree ##############################################################################

fit.5jjj<-gls(r~I(FHS.lag.1^2)+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.5jjj)
D<-resid(fit.5jjj)
plot(D)
AIC(fit.5jjj)
AICc(fit.5jjj)

################################################################################################################################
#####################  Drop all interaction terms and swap in lag 1 FHS and drop 60 degree and pdos ##############################################################################

fit.5jjjj<-gls(r~I(FHS.lag.1^2)+AO,correlation=corAR1(),method="ML")
summary(fit.5jjjj)
D<-resid(fit.5jjjj)
plot(D)
AIC(fit.5jjjj)
AICc(fit.5jjjj)

###############################################################################################################################
##################### Add May-June SST #########################################################################################

fit.5k<-gls(r~D.60.May.June+I(FHS.lag.2^2)+May.June.anom+AO+pdos,correlation=corAR1(),method="ML")
summary(fit.5k)
D<-resid(fit.5k)
plot(D)

AIC(fit.5k)
AICc(fit.5k)

################################################################################################################################
##################### Add interaction term for FHS and May-June -90 #########################################################################################

fit.5m<-gls(r~D.60.May.June+I(FHS.lag.2^2)+May.June.anom+AO+pdos+D.60.May.June*I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.5m)
D<-resid(fit.5m)
plot(D)

AIC(fit.5m)
AICc(fit.5m)






############################################################################################################################################
################################ Re-run using editted residual series ######################################################################
##########################################################################################################################################

r6


AO.ed

pdos.ed

FHS.lag.1.ed
FHS.lag.2.ed
FHS.lag.3.ed

lag.3.males.ed	
lag.2.males.ed	
lag.1.males.ed
RA.3.males.ed
RA.2a.males.ed	
RA.2b.males.ed


NBT.lag.4.ed
NBT.lag.3.ed
NBT.lag.2.ed
NBT.RA.3a.ed
NBT.RA.3b.ed
NBT.RA.2a.ed
NBT.RA.2b.ed

May.ed
June.ed
July.ed
April.May.ed
May.June.ed
June.July.ed
April.July.ed
May.July.ed


D.90.May.ed
D.90.June.ed
D.90.July.ed
D.90.May.June.ed
D.90.JJ.ed
D.90.MJ.ed

D.75.May.ed
D.75.June.ed
D.75.July.ed
D.75.May.June.ed
D.75.JJ.ed
D.75.MJ.ed


D.60.May.ed
D.60.June.ed
D.60.July.ed
D.60.May.June.ed
D.60.JJ.ed
D.60.MJ.ed

D.45.May.ed
D.45.June.ed
D.45.July.ed
D.45.May.June.ed
D.45.JJ.ed
D.45.MJ.ed

D.30.May.ed
D.30.June.ed
D.30.July.ed
D.30.May.June.ed
D.30.JJ.ed
D.30.MJ.ed

D.15.May.ed
D.15.June.ed
D.15.July.ed
D.15.May.June.ed
D.15.JJ.ed
D.15.MJ.ed

D.0.May.ed 
D.0.June.ed
D.0.July.ed
D.0.May.June.ed
D.0.JJ.ed
D.0.MJ.ed

D.neg.15.May.ed
D.neg.15.June.ed
D.neg.15.July.ed
D.neg.15.May.June.ed
D.neg.15.JJ.ed
D.neg.15.MJ.ed

D.neg.30.May.ed
D.neg.30.June.ed
D.neg.30.July.ed
D.neg.30.May.June.ed
D.neg.30.JJ.ed
D.neg.30.MJ.ed


D.neg.45.May.ed
D.neg.45.June.ed
D.neg.45.July.ed
D.neg.45.May.June.ed
D.neg.45.JJ.ed
D.neg.45.MJ.ed

D.neg.60.May.ed
D.neg.60.June.ed
D.neg.60.July.ed
D.neg.60.May.June.ed
D.neg.60.JJ.ed
D.neg.60.MJ.ed


D.neg.75.May.ed
D.neg.75.June.ed
D.neg.75.July.ed
D.neg.75.May.June.ed
D.neg.75.JJ.ed
D.neg.75.MJ.ed

D.neg.90.May.ed
D.neg.90.June.ed
D.neg.90.July.ed
D.neg.90.May.June.ed
D.neg.90.JJ.ed
D.neg.90.MJ.ed




Year.ed<-Year[-5]



############################################################################################################################
###################### Minus 90 degree component and lag 1 FHS with interaction term  #######################################

fit.1aa<-gls(r6~D.neg.90.May.June.ed+I(FHS.lag.1.ed^2)+D.neg.90.May.June.ed*I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.1aa)
D<-resid(fit.1aa)
plot(D)

AIC(fit.1aa)
AICc(fit.1aa)
aic.1<-AIC(fit.1aa)



############################################################################################################################
################### Drop lag 1 FHS #########################################################################################

fit.1a<-gls(r6~D.neg.90.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.1a)
D<-resid(fit.1a)
plot(D)
AIC(fit.1a)
AICc(fit.1a)
aic.1a<-AIC(fit.1a)

############################################################################################################################
################### Drop minus 90 degree and add lag 1 FHS #################################################################

##################### BEST REDUCED MODEL FOR EBS group #####################################################

par(mfrow=c(1,1),cex.lab=1.5,cex.axis=1.25,cex=1.25)
fit.1b<-gls(r6~I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.1b)
D<-resid(fit.1b)
plot(D~Year.ed,ylab="Reduced model residuals",xlab="Hatch Year",pch=16)
abline(h=0,lty=2)
AIC(fit.1b)
AICc(fit.1b)
aic.1b<-AIC(fit.1b)
############################################################################################################################
################### Drop lag 1 FHS and add lag 2 FHS #################################################################

fit.1bb<-gls(r6~I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.1bb)
D<-resid(fit.1bb)
plot(D)
AIC(fit.1bb)
AICc(fit.1bb)
aic.1b<-AIC(fit.1bb)

############################################################################################################################
################### Drop lag 1 FHS and add AO #################################################################

fit.1ba<-gls(r6~AO.ed,correlation=corAR1(),method="ML")
summary(fit.1ba)
D<-resid(fit.1ba)
plot(D)
AIC(fit.1ba)
AICc(fit.1ba)
aic.1b<-AIC(fit.1ba)

############################################################################################################################
################### Add minus 90 degree component #########################################################################

fit.1c<-gls(r6~D.neg.90.May.June.ed+I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.1c)
D<-resid(fit.1c)
plot(D)
AIC(fit.1c)
AICc(fit.1c)
aic.1c<-AIC(fit.1c)


model.1.aic<-c(aic.1,aic.1a,aic.1b,aic.1c)
model.1.aic

############################################################################################################################
################### Add minus 90 degree component WITH lag 1 FHS AS EXPERIMENT--NOT RECORDED #########################################################################

fit.1cc<-gls(r6~D.neg.90.May.June.ed+I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.1cc)
D<-resid(fit.1cc)
plot(D)
AIC(fit.1cc)
AICc(fit.1cc)
aic.1cc<-AIC(fit.1cc)


model.1.aic<-c(aic.1,aic.1a,aic.1b,aic.1c)
model.1.aic

##################################################################################################################################
##################### Add interaction term between minus 90 degree component and lag 2 FHS ####################################

fit.1d<-gls(r6~D.neg.90.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.90.May.June.ed*I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.1d)
D<-resid(fit.1d)
plot(D)

AIC(fit.1d)
AICc(fit.1d)

###############################################################################################################################
##################### Add arctic oscillation  #################################################################################

fit.1e<-gls(r6~D.neg.90.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.90.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed,correlation=corAR1(),method="ML")
summary(fit.1e)
D<-resid(fit.1e)
plot(D)

AIC(fit.1e)
AICc(fit.1e)

###############################################################################################################################
##################### swap lag 1 FHS for lag 2 FHS  #################################################################################

fit.1ee<-gls(r6~D.neg.90.May.June.ed+I(FHS.lag.1.ed^2)+D.neg.90.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed,correlation=corAR1(),method="ML")
summary(fit.1ee)
D<-resid(fit.1ee)
plot(D)

AIC(fit.1ee)
AICc(fit.1ee)

###############################################################################################################################
##################### Add lag 2 FHS with interaction with lag 1  #################################################################################
#####################       NOTE: BAD model         ###########################################################################

fit.1e3<-gls(r6~D.neg.90.May.June.ed+I(FHS.lag.1.ed^2)+D.neg.90.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed+I(FHS.lag.2.ed^2)*I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.1e3)
D<-resid(fit.1e3)
plot(D)

AIC(fit.1e3)
AICc(fit.1e3)

###############################################################################################################################
##################### swap lag 2 FHS for lag 1 FHS  #################################################################################

fit.1e4<-gls(r6~D.neg.90.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.90.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed,correlation=corAR1(),method="ML")
summary(fit.1e4)
D<-resid(fit.1e4)
plot(D)

AIC(fit.1e4)
AICc(fit.1e4)

###############################################################################################################################
##################### Add interaction term between arctic oscillation and minus 90 degree component ###########################

fit.1f<-gls(r6~D.neg.90.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.90.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+AO.ed*D.neg.90.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.1f)
D<-resid(fit.1f)
plot(D)

AIC(fit.1f)
AICc(fit.1f)
###############################################################################################################################
##################### Add interaction term between arctic oscillation and minus 90 degree component AND swap in FHS lag 1 ###########################

fit.1ff<-gls(r6~D.neg.90.May.June.ed+I(FHS.lag.1.ed^2)+D.neg.90.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed+AO.ed*D.neg.90.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.1ff)
D<-resid(fit.1ff)
plot(D)

AIC(fit.1ff)
AICc(fit.1ff)
##################################################################################################################################
##################### Add Summer PDO #############################################################################################

fit.1g<-gls(r6~D.neg.90.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.90.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.1g)
D<-resid(fit.1g)
plot(D)

AIC(fit.1g)
AICc(fit.1g)

lm.1g<-glm(r6~D.neg.90.May.June+I(FHS.lag.2^2)+D.neg.90.May.June*I(FHS.lag.2^2)+AO+pdos)
step(lm.1g)
###############################################################################################################################
##################### Add uinteraction term between Summer PDO and minus 90 degree component ########################################################

fit.1h<-gls(r6~D.neg.90.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.90.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed+pdos.ed*D.neg.90.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.1h)
D<-resid(fit.1h)
plot(D)

AIC(fit.1h)
AICc(fit.1h)

###############################################################################################################################
#################### Reinstate interaction term between minus 90 and AO #######################################################
fit.1i<-gls(r6~D.neg.90.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.90.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed+pdos.ed*D.neg.90.May.June.ed+AO.ed*D.neg.90.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.1i)
D<-resid(fit.1i)
plot(D)
AIC(fit.1i)
AICc(fit.1i)

################################################################################################################################
#####################  Drop all interaction terms ##############################################################################

fit.1j<-gls(r6~D.neg.90.May.June.ed+I(FHS.lag.2.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.1j)
D<-resid(fit.1j)
plot(D)
AIC(fit.1j)
AICc(fit.1j)

################################################################################################################################
#####################  Drop all interaction terms and swap in lag 1 FHS ##############################################################################

###################### NOTE: BEST EBS FULL MODEL ####################################################
par(mfrow=c(1,1),cex.lab=1.5,cex.axis=1.25,cex=1.25) #configure axis labels
fit.1jj<-gls(r6~D.neg.90.May.June.ed+I(FHS.lag.1.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.1jj)
D<-resid(fit.1jj)
plot(D~Year.ed, ylab="Full model residuals",xlab="Hatch Year",pch=16)
abline(h=0,lty=2)
AIC(fit.1jj)
AICc(fit.1jj)


###############################################################################################################################
##################### Add May-June SST #########################################################################################

fit.1k<-gls(r6~D.neg.90.May.June.ed+I(FHS.lag.2.ed^2)+May.June.ed+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.1k)
D<-resid(fit.1k)
plot(D)

AIC(fit.1k)
AICc(fit.1k)

################################################################################################################################
##################### Add interaction term for FHS and May-June -90 #########################################################################################

fit.1m<-gls(r6~D.neg.90.May.June.ed+I(FHS.lag.2.ed^2)+May.June.ed+AO.ed+pdos.ed+D.neg.90.May.June.ed*I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.1m)
D<-resid(fit.1m)
plot(D)

AIC(fit.1m)
AICc(fit.1m)


###########################################################################################################################################
##################### Exchange neg 75 for neg 90 ###########################################################################################
#############################################################################################################################################

#############################################################################################################################
###################### Minus 75 degree component and lag 1 FHS with interaction term  #######################################

fit.2aa<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.1.ed^2)+D.neg.75.May.June.ed*I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.2aa)
D<-resid(fit.2aa)
plot(D)

AIC(fit.2aa)
AICc(fit.2aa)
aic.1<-AIC(fit.2aa)



############################################################################################################################
################### Drop lag 1 FHS #########################################################################################

fit.2a<-gls(r6~D.neg.75.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.2a)
D<-resid(fit.2a)
plot(D)
AIC(fit.2a)
AICc(fit.2a)
aic.1a<-AIC(fit.2a)

############################################################################################################################
################### Drop minus 75 degree and add lag 1 FHS #################################################################

fit.2b<-gls(r6~I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.2b)
D<-resid(fit.2b)
plot(D)
AIC(fit.2b)
AICc(fit.2b)
aic.1b<-AIC(fit.2b)
############################################################################################################################
################### Drop lag 1 FHS and add lag 2 FHS #################################################################

fit.2bb<-gls(r6~I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.2bb)
D<-resid(fit.2bb)
plot(D)
AIC(fit.2bb)
AICc(fit.2bb)
aic.1b<-AIC(fit.2bb)
############################################################################################################################
################### Add minus 75 degree component #########################################################################

fit.2c<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.2c)
D<-resid(fit.2c)
plot(D)
AIC(fit.2c)
AICc(fit.2c)

aic.1c<-AIC(fit.1c)


model.1.aic<-c(aic.1,aic.1a,aic.1b,aic.1c)
model.1.aic

##################################################################################################################################
##################### Add interaction term between minus 75 degree component and lag 2 FHS ####################################

fit.2d<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.75.May.June.ed*I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.2d)
D<-resid(fit.2d)
plot(D)

AIC(fit.2d)
AICc(fit.2d)

###############################################################################################################################
##################### Add arctic oscillation  #################################################################################

fit.2e<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.75.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed,correlation=corAR1(),method="ML")
summary(fit.2e)
D<-resid(fit.2e)
plot(D)

AIC(fit.2e)
AICc(fit.2e)

###############################################################################################################################
##################### swap lag 1 FHS for lag 2 FHS  #################################################################################

fit.2ee<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.1.ed^2)+D.neg.75.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed,correlation=corAR1(),method="ML")
summary(fit.2ee)
D<-resid(fit.2ee)
plot(D)

AIC(fit.2ee)
AICc(fit.2ee)

###############################################################################################################################
##################### Add lag 2 FHS with interaction with lag 1  #################################################################################
#####################       NOTE: BAD model         ###########################################################################

fit.2e3<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.1.ed^2)+D.neg.75.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed+I(FHS.lag.2.ed^2)*I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.2e3)
D<-resid(fit.2e3)
plot(D)

AIC(fit.2e3)
AICc(fit.2e3)
###############################################################################################################################
##################### Add interaction term between arctic oscillation and minus 75 degree component ###########################

fit.2f<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.75.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+AO.ed*D.neg.75.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.2f)
D<-resid(fit.2f)
plot(D)

AIC(fit.2f)
AICc(fit.2f)
###############################################################################################################################
##################### Add interaction term between arctic oscillation and minus 75 degree component AND swap in FHS lag 1 ###########################

fit.2ff<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.1.ed^2)+D.neg.75.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed+AO.ed*D.neg.75.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.2ff)
D<-resid(fit.2ff)
plot(D)

AIC(fit.2ff)
AICc(fit.2ff)
##################################################################################################################################
##################### Add Summer PDO #############################################################################################

fit.2g<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.75.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.2g)
D<-resid(fit.2g)
plot(D)

AIC(fit.2g)
AICc(fit.2g)

lm.2g<-glm(r6~D.neg.75.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.75.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed)
step(lm.2g)

##################################################################################################################################
##################### Add Summer PDO AND swap lag 1 FHS for lag 2  #############################################################################################

fit.2gg<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.1.ed^2)+D.neg.75.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.2gg)
D<-resid(fit.2gg)
plot(D)

AIC(fit.2gg)
AICc(fit.2gg)

lm.2gg<-glm(r6~D.neg.75.May.June.ed+I(FHS.lag.1.ed^2)+D.neg.75.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed+pdos.ed)
step(lm.2gg)
###############################################################################################################################
##################### Add interaction term between Summer PDO and minus 75 degree component ########################################################

fit.2h<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.75.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed+pdos.ed*D.neg.75.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.2h)
D<-resid(fit.2h)
plot(D)

AIC(fit.2h)
AICc(fit.2h)

###############################################################################################################################
##################### AS EXPERIMENT Add interaction term between Summer PDO and minus 75 degree component and drop interaction between FHS lag 2 and neg 75 ########################################################

fit.2hh<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.2.ed^2)+AO.ed+pdos.ed+pdos.ed*D.neg.75.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.2hh)
D<-resid(fit.2hh)
plot(D)

AIC(fit.2hh)
AICc(fit.2hh)

###############################################################################################################################
##################### AS EXPERIMENT Add interaction term between Summer PDO and minus 75 degree component and drop interaction between FHS lag 2 and neg 75 and swap in lag 1 FHS########################################################

fit.2hhh<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.1.ed^2)+AO.ed+pdos.ed+pdos.ed*D.neg.75.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.2hhh)
D<-resid(fit.2hhh)
plot(D)

AIC(fit.2hhh)
AICc(fit.2hhh)

###############################################################################################################################
#################### Reinstate interaction term between minus 75 and AO #######################################################
fit.2i<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.75.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed+pdos.ed*D.neg.75.May.June.ed+
AO.ed*D.neg.75.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.2i)
D<-resid(fit.2i)
plot(D)
AIC(fit.2i)
AICc(fit.2i)

################################################################################################################################
#####################  Drop all interaction terms ##############################################################################

fit.2j<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.2.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.2j)
D<-resid(fit.2j)
plot(D)
AIC(fit.2j)
AICc(fit.2j)

################################################################################################################################
#####################  Drop all interaction terms and swap in lag 1 FHS ##############################################################################

fit.2jj<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.1.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.2jj)
D<-resid(fit.2jj)
plot(D)
AIC(fit.2jj)
AICc(fit.2jj)

###############################################################################################################################
##################### Add May-June SST #########################################################################################

fit.2k<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.2.ed^2)+May.June.ed+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.2k)
D<-resid(fit.2k)
plot(D)

AIC(fit.2k)
AICc(fit.2k)

###############################################################################################################################
##################### Add May-June SST and swap in lag 1 FHS  #########################################################################################

fit.2kk<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.1.ed^2)+May.June.ed+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.2kk)
D<-resid(fit.2kk)
plot(D)

AIC(fit.2kk)
AICc(fit.2kk)
################################################################################################################################
##################### Add interaction term for FHS and May-June -90 #########################################################################################

fit.2m<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.2.ed^2)+May.June.ed+AO.ed+pdos.ed+D.neg.75.May.June.ed*I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.2m)
D<-resid(fit.2m)
plot(D)

AIC(fit.2m)
AICc(fit.2m)

################################################################################################################################
#####################  Drop all interaction terms and AO and swap in lag 1 FHS ##############################################################################

fit.2n<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.1.ed^2)+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.2n)
D<-resid(fit.2n)
plot(D)
AIC(fit.2n)
AICc(fit.2n)

################################################################################################################################
#####################  Drop all interaction terms add lag 1 males ##############################################################################

fit.2o<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.2.ed^2)+AO.ed+pdos.ed+lag.1.males.ed,correlation=corAR1(),method="ML")
summary(fit.2o)
D<-resid(fit.2o)
plot(D)
AIC(fit.2o)
AICc(fit.2o)

################################################################################################################################
#####################  Drop all interaction terms add lag 1 and 2 males ################################################################

fit.2p<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.2.ed^2)+AO.ed+pdos.ed+lag.1.males.ed+lag.2.males.ed,correlation=corAR1(),method="ML")
summary(fit.2p)
D<-resid(fit.2p)
plot(D)
AIC(fit.2p)
AICc(fit.2p)
################################################################################################################################
#####################  Add interaction between lag 1 and 2 males ################################################################

fit.2q<-gls(r6~D.neg.75.May.June.ed+I(FHS.lag.2.ed^2)+AO.ed+pdos.ed+lag.1.males.ed+lag.2.males.ed+lag.1.males.ed*lag.2.males.ed,correlation=corAR1(),method="ML")
summary(fit.2q)
D<-resid(fit.2q)
plot(D)
AIC(fit.2q)
AICc(fit.2q)


###########################################################################################################################################
##################### Exchange neg 60 for neg 75 ###########################################################################################
#############################################################################################################################################

#############################################################################################################################
###################### Minus 60 degree component and lag 1 FHS with interaction term  #######################################

fit.3aa<-gls(r6~D.neg.60.May.June.ed+I(FHS.lag.1.ed^2)+D.neg.60.May.June.ed*I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.3aa)
D<-resid(fit.3aa)
plot(D)

AIC(fit.3aa)
AICc(fit.3aa)
aic.1<-AIC(fit.3aa)



############################################################################################################################
################### Drop lag 1 FHS #########################################################################################

fit.3a<-gls(r6~D.neg.60.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.3a)
D<-resid(fit.3a)
plot(D)
AIC(fit.3a)
AICc(fit.3a)
aic.1a<-AIC(fit.3a)

############################################################################################################################
################### Drop neg 60 and add AO #########################################################################################

fit.3aa<-gls(r6~AO.ed,correlation=corAR1(),method="ML")
summary(fit.3aa)
D<-resid(fit.3aa)
plot(D)
AIC(fit.3aa)
AICc(fit.3aa)
aic.1a<-AIC(fit.3aa)
############################################################################################################################
################### Drop minus 60 degree and add lag 1 FHS #################################################################

fit.3b<-gls(r6~I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.3b)
D<-resid(fit.3b)
plot(D)
AIC(fit.3b)
AICc(fit.3b)
aic.1b<-AIC(fit.3b)
############################################################################################################################
################### Drop lag 1 FHS and add lag 2 FHS #################################################################

fit.3bb<-gls(r6~I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.3bb)
D<-resid(fit.3bb)
plot(D)
AIC(fit.3bb)
AICc(fit.3bb)
aic.1b<-AIC(fit.3bb)
############################################################################################################################
################### Add minus 60 degree component #########################################################################

fit.3c<-gls(r6~D.neg.60.May.June.ed+I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.3c)
D<-resid(fit.3c)
plot(D)
AIC(fit.3c)
AICc(fit.3c)

aic.1c<-AIC(fit.3c)


model.1.aic<-c(aic.1,aic.1a,aic.1b,aic.1c)
model.1.aic

##################################################################################################################################
##################### Add interaction term between minus 60 degree component and lag 2 FHS ####################################

fit.3d<-gls(r6~D.neg.60.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.60.May.June.ed*I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.3d)
D<-resid(fit.3d)
plot(D)

AIC(fit.3d)
AICc(fit.3d)

###############################################################################################################################
##################### Add arctic oscillation  #################################################################################

fit.3e<-gls(r6~D.neg.60.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.60.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed,correlation=corAR1(),method="ML")
summary(fit.3e)
D<-resid(fit.3e)
plot(D)

AIC(fit.3e)
AICc(fit.3e)

###############################################################################################################################
##################### swap lag 1 FHS for lag 2 FHS  #################################################################################

fit.3ee<-gls(r6~D.neg.60.May.June.ed+I(FHS.lag.1.ed^2)+D.neg.60.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed,correlation=corAR1(),method="ML")
summary(fit.3ee)
D<-resid(fit.3ee)
plot(D)

AIC(fit.3ee)
AICc(fit.3ee)

###############################################################################################################################
##################### Add lag 2 FHS with interaction with lag 1  #################################################################################
#####################       NOTE: BAD model         ###########################################################################

fit.3e3<-gls(r6~D.neg.60.May.June.ed+I(FHS.lag.1.ed^2)+D.neg.60.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed+I(FHS.lag.2.ed^2)*I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.3e3)
D<-resid(fit.3e3)
plot(D)

AIC(fit.3e3)
AICc(fit.3e3)
###############################################################################################################################
##################### Add interaction term between arctic oscillation and minus 60 degree component ###########################

fit.3f<-gls(r6~D.neg.60.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.60.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+AO.ed*D.neg.60.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.3f)
D<-resid(fit.3f)
plot(D)

AIC(fit.3f)
AICc(fit.3f)
#####################################################################################################################################################
##################### Add interaction term between arctic oscillation and minus 60 degree component AND swap in FHS lag 1 ###########################

fit.3ff<-gls(r6~D.neg.60.May.June.ed+I(FHS.lag.1.ed^2)+D.neg.60.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed+AO.ed*D.neg.60.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.3ff)
D<-resid(fit.3ff)
plot(D)

AIC(fit.3ff)
AICc(fit.3ff)
########################################################################################################################################################
##################### Add Summer PDO ####################################################################################################################

fit.3g<-gls(r6~D.neg.60.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.60.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.3g)
D<-resid(fit.3g)
plot(D)

AIC(fit.3g)
AICc(fit.3g)

lm.2g<-glm(r~D.neg.60.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.60.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed)
step(lm.2g)
################################################################################################################################################
##################### Add uinteraction term between Summer PDO and minus 60 degree component ########################################################

fit.3h<-gls(r6~D.neg.60.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.60.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed+pdos.ed*D.neg.60.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.3h)
D<-resid(fit.3h)
plot(D)

AIC(fit.3h)
AICc(fit.3h)

###############################################################################################################################
#################### Reinstate interaction term between minus 60 and AO #######################################################
fit.3i<-gls(r6~D.neg.60.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.60.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed+pdos.ed*D.neg.60.May.June.ed
+AO.ed*D.neg.60.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.3i)
D<-resid(fit.3i)
plot(D)
AIC(fit.3i)
AICc(fit.3i)

################################################################################################################################
#####################  Drop all interaction terms ##############################################################################

fit.3j<-gls(r6~D.neg.60.May.June.ed+I(FHS.lag.2.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.3j)
D<-resid(fit.3j)
plot(D)
AIC(fit.3j)
AICc(fit.3j)

################################################################################################################################
##################### AS EXPERIMENT: Drop pdos ##############################################################################

fit.3jj<-gls(r6~D.neg.60.May.June.ed+I(FHS.lag.2.ed^2)+AO.ed,correlation=corAR1(),method="ML")
summary(fit.3jj)
D<-resid(fit.3jj)
plot(D)
AIC(fit.3jj)
AICc(fit.3jj)
################################################################################################################################
#####################  Drop all interaction terms and swap FHS lag 1 in ##############################################################################

fit.3jjj<-gls(r6~D.neg.60.May.June.ed+I(FHS.lag.1.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.3jjj)
D<-resid(fit.3jjj)
plot(D)
AIC(fit.3jjj)
AICc(fit.3jjj)

###############################################################################################################################
##################### Add May-June SST #########################################################################################

fit.3k<-gls(r6~D.neg.60.May.June.ed+I(FHS.lag.2.ed^2)+May.June.ed+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.3k)
D<-resid(fit.3k)
plot(D)

AIC(fit.3k)
AICc(fit.3k)

################################################################################################################################
##################### Add interaction term for FHS and May-June -90 #########################################################################################

fit.3m<-gls(r6~D.neg.60.May.June.ed+I(FHS.lag.2.ed^2)+May.June.ed+AO.ed+pdos.ed+D.neg.60.May.June.ed*I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.3m)
D<-resid(fit.3m)
plot(D)

AIC(fit.3m)
AICc(fit.3m)

################################################################################################################################
##################### Add interaction term for FHS and May-June -90 and swap in lag 1 FHS #########################################################################################

fit.3mm<-gls(r6~D.neg.60.May.June.ed+I(FHS.lag.1.ed^2)+May.June.ed+AO.ed+pdos.ed+D.neg.60.May.June.ed*I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.3mm)
D<-resid(fit.3mm)
plot(D)

AIC(fit.3mm)
AICc(fit.3mm)

###########################################################################################################################################
##################### Exchange POSITIVE 90 for neg 60 ###########################################################################################
#############################################################################################################################################

#############################################################################################################################
###################### POSITIVE 90 degree component and lag 1 FHS with interaction term  #######################################

fit.4aa<-gls(r6~D.90.May.June.ed+I(FHS.lag.1.ed^2)+D.90.May.June.ed*I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.4aa)
D<-resid(fit.4aa)
plot(D)

AIC(fit.4aa)
AICc(fit.4aa)
aic.1<-AIC(fit.4aa)



############################################################################################################################
################### Drop lag 1 FHS #########################################################################################

fit.4a<-gls(r6~D.90.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.4a)
D<-resid(fit.4a)
plot(D)
AIC(fit.4a)
AICc(fit.4a)
aic.1a<-AIC(fit.4a)

############################################################################################################################
################### Drop 90 degree and add lag 1 FHS #################################################################

fit.4b<-gls(r6~I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.4b)
D<-resid(fit.4b)
plot(D)
AIC(fit.4b)
AICc(fit.4b)
aic.1b<-AIC(fit.3b)
############################################################################################################################
################### Drop lag 1 FHS and add lag 2 FHS #################################################################

fit.4bb<-gls(r6~I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.4bb)
D<-resid(fit.4bb)
plot(D)
AIC(fit.4bb)
AICc(fit.4bb)
aic.1b<-AIC(fit.4bb)
############################################################################################################################
################### Add minus 90 degree component #########################################################################

fit.4c<-gls(r6~D.90.May.June.ed+I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.4c)
D<-resid(fit.4c)
plot(D)
AIC(fit.4c)
AICc(fit.4c)

aic.1c<-AIC(fit.4c)


model.1.aic<-c(aic.1,aic.1a,aic.1b,aic.1c)
model.1.aic
############################################################################################################################
################### Add minus 90 degree component and swap in lag 1 FHS #########################################################################

fit.4cc<-gls(r6~D.90.May.June.ed+I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.4cc)
D<-resid(fit.4cc)
plot(D)
AIC(fit.4cc)
AICc(fit.4cc)

aic.1c<-AIC(fit.4c)


model.1.aic<-c(aic.1,aic.1a,aic.1b,aic.1c)
model.1.aic
###################################################################################################################################
##################### Add interaction term between 90 degree component and lag 2 FHS ##############################################

fit.4d<-gls(r6~D.90.May.June.ed+I(FHS.lag.2.ed^2)+D.90.May.June.ed*I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.4d)
D<-resid(fit.4d)
plot(D)

AIC(fit.4d)
AICc(fit.4d)

###################################################################################################################################
##################### Add arctic oscillation  #####################################################################################

fit.4e<-gls(r6~D.90.May.June.ed+I(FHS.lag.2.ed^2)+D.90.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed,correlation=corAR1(),method="ML")
summary(fit.4e)
D<-resid(fit.4e)
plot(D)

AIC(fit.4e)
AICc(fit.4e)

#####################################################################################################################################
##################### swap lag 1 FHS for lag 2 FHS  #################################################################################

fit.4ee<-gls(r6~D.90.May.June.ed+I(FHS.lag.1.ed^2)+D.90.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed,correlation=corAR1(),method="ML")
summary(fit.4ee)
D<-resid(fit.4ee)
plot(D)

AIC(fit.4ee)
AICc(fit.4ee)

###############################################################################################################################################
##################### Add lag 2 FHS with interaction with lag 1  ##############################################################################
#####################       NOTE: BAD model         ###########################################################################################

fit.4e3<-gls(r6~D.90.May.June.ed+I(FHS.lag.1.ed^2)+D.90.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed+I(FHS.lag.2.ed^2)*I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.4e3)
D<-resid(fit.4e3)
plot(D)

AIC(fit.4e3)
AICc(fit.4e3)
###############################################################################################################################
##################### Add interaction term between arctic oscillation and minus 90 degree component ###########################

fit.4f<-gls(r6~D.90.May.June.ed+I(FHS.lag.2.ed^2)+D.90.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+AO.ed*D.90.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.4f)
D<-resid(fit.4f)
plot(D)

AIC(fit.4f)
AICc(fit.4f)

###############################################################################################################################
##################### Add interaction term between arctic oscillation and 90 degree component AND swap in FHS lag 1 ###########################

fit.4ff<-gls(r6~D.90.May.June.ed+I(FHS.lag.1.ed^2)+D.90.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed+AO.ed*D.90.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.4ff)
D<-resid(fit.4ff)
plot(D)

AIC(fit.4ff)
AICc(fit.4ff)
##################################################################################################################################
##################### Add Summer PDO #############################################################################################

fit.4g<-gls(r6~D.90.May.June.ed+I(FHS.lag.2.ed^2)+D.90.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.4g)
D<-resid(fit.4g)
plot(D)

AIC(fit.4g)
AICc(fit.4g)

lm.2g<-glm(r6~D.neg.60.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.60.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed)
step(lm.2g)
##################################################################################################################################
##################### Add Summer PDO and swap in lag 1 FHS #############################################################################################

fit.4gg<-gls(r6~D.90.May.June.ed+I(FHS.lag.1.ed^2)+D.90.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.4gg)
D<-resid(fit.4gg)
plot(D)

AIC(fit.4gg)
AICc(fit.4gg)

lm.2g<-glm(r6~D.neg.60.May.June.ed+I(FHS.lag.2.ed^2)+D.neg.60.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed)
step(lm.2g)
###############################################################################################################################
##################### Add uinteraction term between Summer PDO and 90 degree component ########################################################

fit.4h<-gls(r6~D.90.May.June.ed+I(FHS.lag.2.ed^2)+D.90.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed+pdos.ed*D.90.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.4h)
D<-resid(fit.4h)
plot(D)

AIC(fit.4h)
AICc(fit.4h)

###############################################################################################################################
#################### Reinstate interaction term between 90 and AO #######################################################
fit.4i<-gls(r6~D.90.May.June.ed+I(FHS.lag.2.ed^2)+D.90.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed+pdos.ed*D.90.May.June.ed+AO.ed*D.90.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.4i)
D<-resid(fit.4i)
plot(D)
AIC(fit.4i)
AICc(fit.4i)

################################################################################################################################
#####################  Drop all interaction terms ##############################################################################

fit.4j<-gls(r6~D.90.May.June.ed+I(FHS.lag.2.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.4j)
D<-resid(fit.4j)
plot(D)
AIC(fit.4j)
AICc(fit.4j)

################################################################################################################################
#####################  Drop all interaction terms and swap in FHS lag 1##############################################################################

fit.4jj<-gls(r6~D.90.May.June.ed+I(FHS.lag.1.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.4jj)
D<-resid(fit.4jj)
plot(D)
AIC(fit.4jj)
AICc(fit.4jj)
###############################################################################################################################
##################### Add May-June SST #########################################################################################

fit.4k<-gls(r6~D.90.May.June.ed+I(FHS.lag.2.ed^2)+May.June.ed+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.4k)
D<-resid(fit.4k)
plot(D)

AIC(fit.4k)
AICc(fit.4k)

################################################################################################################################
##################### Add interaction term for FHS and May-June 90 #########################################################################################

fit.4m<-gls(r6~D.90.May.June.ed+I(FHS.lag.2.ed^2)+May.June.ed+AO.ed+pdos.ed+D.90.May.June.ed*I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.4m)
D<-resid(fit.4m)
plot(D)

AIC(fit.4m)
AICc(fit.4m)




############################################################################################################################
###################### Drop 90 degrees and use POSITIVE 75 degrees ###################################################
##############################################################################################################################

fit.5aa<-gls(r6~D.75.May.June.ed+I(FHS.lag.1.ed^2)+D.75.May.June.ed*I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.5aa)
D<-resid(fit.5aa)
plot(D)

AIC(fit.5aa)
AICc(fit.5aa)
aic.5<-AIC(fit.5aa)



############################################################################################################################
################### Drop lag 1 FHS #########################################################################################

fit.5a<-gls(r6~D.75.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.5a)
D<-resid(fit.5a)
plot(D)
AIC(fit.5a)
AICc(fit.5a)
aic.5a<-AIC(fit.5a)

############################################################################################################################
################### Drop minus 90 degree and add lag 1 FHS #################################################################

fit.5b<-gls(r6~I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.5b)
D<-resid(fit.5b)
plot(D)
AIC(fit.5b)
AICc(fit.5b)
aic.5b<-AIC(fit.5b)
############################################################################################################################
################### Drop lag 1 FHS and add lag 2 FHS #################################################################

fit.5bb<-gls(r6~I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.5bb)
D<-resid(fit.5bb)
plot(D)
AIC(fit.5bb)
AICc(fit.5bb)
aic.5bb<-AIC(fit.5bb)
############################################################################################################################
################### Add minus 90 degree component #########################################################################

fit.5c<-gls(r6~D.75.May.June.ed+I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.5c)
D<-resid(fit.5c)
plot(D)
AIC(fit.5c)
AICc(fit.5c)
aic.1c<-AIC(fit.5c)


model.5.aic<-c(aic.5,aic.5a,aic.5b,aic.5c)
model.5.aic

##################################################################################################################################
##################### Add interaction term between minus 90 degree component and lag 2 FHS ####################################

fit.5d<-gls(r6~D.75.May.June.ed+I(FHS.lag.2.ed^2)+D.75.May.June.ed*I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.5d)
D<-resid(fit.5d)
plot(D)

AIC(fit.5d)
AICc(fit.5d)

###############################################################################################################################
##################### Add arctic oscillation  #################################################################################

fit.5e<-gls(r6~D.75.May.June.ed+I(FHS.lag.2.ed^2)+D.75.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed,correlation=corAR1(),method="ML")
summary(fit.5e)
D<-resid(fit.5e)
plot(D)

AIC(fit.5e)
AICc(fit.5e)

###############################################################################################################################
##################### swap lag 1 FHS for lag 2 FHS  #################################################################################

fit.5ee<-gls(r6~D.75.May.June.ed+I(FHS.lag.1.ed^2)+D.75.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed,correlation=corAR1(),method="ML")
summary(fit.5ee)
D<-resid(fit.5ee)
plot(D)

AIC(fit.5ee)
AICc(fit.5ee)

###############################################################################################################################
##################### Add lag 2 FHS with interaction with lag 1  #################################################################################
#####################       NOTE: BAD model         ###########################################################################

fit.5e3<-gls(r6~D.75.May.June.ed+I(FHS.lag.1.ed^2)+D.75.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed+I(FHS.lag.2.ed^2)*I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.5e3)
D<-resid(fit.5e3)
plot(D)

AIC(fit.5e3)
AICc(fit.5e3)


###############################################################################################################################
##################### Add interaction term between arctic oscillation and 75 degree component ###########################

fit.5f<-gls(r6~D.75.May.June.ed+I(FHS.lag.2.ed^2)+D.75.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+AO.ed*D.75.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.5f)
D<-resid(fit.5f)
plot(D)

AIC(fit.5f)
AICc(fit.5f)

###############################################################################################################################
##################### Add interaction term between arctic oscillation and minus 90 degree component AND swap in FHS lag 1 ###########################

fit.5ff<-gls(r6~D.75.May.June.ed+I(FHS.lag.1.ed^2)+D.75.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed+AO.ed*D.75.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.5ff)
D<-resid(fit.5ff)
plot(D)

AIC(fit.5ff)
AICc(fit.5ff)

###############################################################################################################################
##################### AS EXPERIMENT: remove all interaction terms and AND swap in FHS lag 1 ###########################

fit.5fff<-gls(r6~D.75.May.June.ed+I(FHS.lag.1.ed^2)+AO.ed,correlation=corAR1(),method="ML")
summary(fit.5fff)
D<-resid(fit.5fff)
plot(D)

AIC(fit.5fff)
AICc(fit.5fff)
##################################################################################################################################
##################### Add Summer PDO #############################################################################################

fit.5g<-gls(r6~D.75.May.June.ed+I(FHS.lag.2.ed^2)+D.75.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.5g)
D<-resid(fit.5g)
plot(D)

AIC(fit.5g)
AICc(fit.5g)

lm.1g<-glm(r6~D.75.May.June+I(FHS.lag.2^2)+D.75.May.June*I(FHS.lag.2^2)+AO+pdos)
step(lm.1g)

##################################################################################################################################
##################### Add Summer PDO and swap in lag 1 FHS #############################################################################################

fit.5gg<-gls(r6~D.75.May.June.ed+I(FHS.lag.1.ed^2)+D.75.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.5gg)
D<-resid(fit.5gg)
plot(D)

AIC(fit.5gg)
AICc(fit.5gg)

lm.1g<-glm(r6~D.75.May.June+I(FHS.lag.2^2)+D.75.May.June*I(FHS.lag.2^2)+AO+pdos)
step(lm.1g)

###############################################################################################################################
##################### Add interaction term between Summer PDO and minus 90 degree component ########################################################

fit.5h<-gls(r6~D.75.May.June.ed+I(FHS.lag.2.ed^2)+D.75.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed+pdos.ed*D.75.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.5h)
D<-resid(fit.5h)
plot(D)

AIC(fit.5h)
AICc(fit.5h)

###############################################################################################################################
#################### Reinstate interaction term between minus 90 and AO #######################################################
fit.5i<-gls(r6~D.75.May.June.ed+I(FHS.lag.2.ed^2)+D.75.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed+pdos.ed*D.75.May.June.ed+AO.ed*D.75.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.5i)
D<-resid(fit.5i)
plot(D)
AIC(fit.5i)
AICc(fit.5i)

################################################################################################################################
#####################  Drop all interaction terms ##############################################################################

fit.5j<-gls(r6~D.75.May.June.ed+I(FHS.lag.2.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.5j)
D<-resid(fit.5j)
plot(D)
AIC(fit.5j)
AICc(fit.5j)

################################################################################################################################
#####################  Drop all interaction terms and swap in lag 1 FHS ##############################################################################

fit.5j<-gls(r6~D.75.May.June.ed+I(FHS.lag.1.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.5j)
D<-resid(fit.5j)
plot(D)
AIC(fit.5j)
AICc(fit.5j)

###############################################################################################################################
##################### Add May-June SST #########################################################################################

fit.5k<-gls(r6~D.75.May.June.ed+I(FHS.lag.2.ed^2)+May.June.ed+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.5k)
D<-resid(fit.5k)
plot(D)

AIC(fit.5k)
AICc(fit.5k)

################################################################################################################################
##################### Add interaction term for FHS and May-June -90 #########################################################################################

fit.5m<-gls(r6~D.75.May.June.ed+I(FHS.lag.2.ed^2)+May.June.ed+AO.ed+pdos.ed+D.75.May.June.ed*I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.5m)
D<-resid(fit.5m)
plot(D)

AIC(fit.5m)
AICc(fit.5m)







###########################################################################################################################################
##################### Exchange 60 degree component for 75 ###########################################################################################
#############################################################################################################################################






#############################################################################################################################
###################### 60 degree component and lag 1 FHS with interaction term  #######################################

fit.3aa<-gls(r6~D.60.May.June.ed+I(FHS.lag.1.ed^2)+D.60.May.June.ed*I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.3aa)
D<-resid(fit.3aa)
plot(D)

AIC(fit.3aa)
AICc(fit.3aa)
aic.1<-AIC(fit.3aa)



############################################################################################################################
################### Drop lag 1 FHS #########################################################################################

fit.3a<-gls(r6~D.60.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.3a)
D<-resid(fit.3a)
plot(D)
AIC(fit.3a)
AICc(fit.3a)
aic.1a<-AIC(fit.3a)

############################################################################################################################
################### Drop neg 60 and add AO #########################################################################################

fit.3aa<-gls(r6~AO.ed,correlation=corAR1(),method="ML")
summary(fit.3aa)
D<-resid(fit.3aa)
plot(D)
AIC(fit.3aa)
AICc(fit.3aa)
aic.1a<-AIC(fit.3aa)
############################################################################################################################
################### Drop minus 60 degree and add lag 1 FHS #################################################################

fit.3b<-gls(r6~I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.3b)
D<-resid(fit.3b)
plot(D)
AIC(fit.3b)
AICc(fit.3b)
aic.1b<-AIC(fit.3b)
############################################################################################################################
################### Drop lag 1 FHS and add lag 2 FHS #################################################################

fit.3bb<-gls(r6~I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.3bb)
D<-resid(fit.3bb)
plot(D)
AIC(fit.3bb)
AICc(fit.3bb)
aic.1b<-AIC(fit.3bb)
############################################################################################################################
################### Add 60 degree component #########################################################################

fit.3c<-gls(r6~D.60.May.June.ed+I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.3c)
D<-resid(fit.3c)
plot(D)
AIC(fit.3c)
AICc(fit.3c)

aic.1c<-AIC(fit.3c)


model.1.aic<-c(aic.1,aic.1a,aic.1b,aic.1c)
model.1.aic

##################################################################################################################################
##################### Add interaction term between 60 degree component and lag 2 FHS ####################################

fit.3d<-gls(r6~D.60.May.June.ed+I(FHS.lag.2.ed^2)+D.60.May.June.ed*I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.3d)
D<-resid(fit.3d)
plot(D)

AIC(fit.3d)
AICc(fit.3d)

###############################################################################################################################
##################### Add arctic oscillation  #################################################################################

fit.3e<-gls(r6~D.60.May.June.ed+I(FHS.lag.2.ed^2)+D.60.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed,correlation=corAR1(),method="ML")
summary(fit.3e)
D<-resid(fit.3e)
plot(D)

AIC(fit.3e)
AICc(fit.3e)

###############################################################################################################################
##################### swap lag 1 FHS for lag 2 FHS  #################################################################################

fit.3ee<-gls(r6~D.60.May.June.ed+I(FHS.lag.1.ed^2)+D.60.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed,correlation=corAR1(),method="ML")
summary(fit.3ee)
D<-resid(fit.3ee)
plot(D)

AIC(fit.3ee)
AICc(fit.3ee)

###############################################################################################################################
##################### Add lag 2 FHS with interaction with lag 1  #################################################################################
#####################       NOTE: BAD model         ###########################################################################

fit.3e3<-gls(r6~D.60.May.June.ed+I(FHS.lag.1.ed^2)+D.60.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed+I(FHS.lag.2.ed^2)*I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.3e3)
D<-resid(fit.3e3)
plot(D)

AIC(fit.3e3)
AICc(fit.3e3)
###############################################################################################################################
##################### Add interaction term between arctic oscillation and 60 degree component ###########################

fit.3f<-gls(r6~D.60.May.June.ed+I(FHS.lag.2.ed^2)+D.60.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+AO.ed*D.60.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.3f)
D<-resid(fit.3f)
plot(D)

AIC(fit.3f)
AICc(fit.3f)
#####################################################################################################################################################
##################### Add interaction term between arctic oscillation and 60 degree component AND swap in FHS lag 1 ###########################

fit.3ff<-gls(r6~D.60.May.June.ed+I(FHS.lag.1.ed^2)+D.60.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed+AO.ed*D.60.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.3ff)
D<-resid(fit.3ff)
plot(D)

AIC(fit.3ff)
AICc(fit.3ff)
########################################################################################################################################################
##################### Add Summer PDO ####################################################################################################################

fit.3g<-gls(r6~D.60.May.June.ed+I(FHS.lag.2.ed^2)+D.60.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.3g)
D<-resid(fit.3g)
plot(D)

AIC(fit.3g)
AICc(fit.3g)

lm.2g<-glm(r~D.60.May.June.ed+I(FHS.lag.2.ed^2)+D.60.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed)
step(lm.2g)

########################################################################################################################################################
##################### Add Summer PDO and swap in lag 2 FHS ####################################################################################################################

fit.3gg<-gls(r6~D.60.May.June.ed+I(FHS.lag.1.ed^2)+D.60.May.June.ed*I(FHS.lag.1.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.3gg)
D<-resid(fit.3gg)
plot(D)

AIC(fit.3gg)
AICc(fit.3gg)

lm.2g<-glm(r~D.60.May.June.ed+I(FHS.lag.2.ed^2)+D.60.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed)
step(lm.2g)
################################################################################################################################################
##################### Add uinteraction term between Summer PDO and 60 degree component ########################################################

fit.3h<-gls(r6~D.60.May.June.ed+I(FHS.lag.2.ed^2)+D.60.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed+pdos.ed*D.60.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.3h)
D<-resid(fit.3h)
plot(D)

AIC(fit.3h)
AICc(fit.3h)

###############################################################################################################################
#################### Reinstate interaction term between 60 and AO #######################################################
fit.3i<-gls(r6~D.60.May.June.ed+I(FHS.lag.2.ed^2)+D.60.May.June.ed*I(FHS.lag.2.ed^2)+AO.ed+pdos.ed+pdos.ed*D.60.May.June.ed
+AO.ed*D.60.May.June.ed,correlation=corAR1(),method="ML")
summary(fit.3i)
D<-resid(fit.3i)
plot(D)
AIC(fit.3i)
AICc(fit.3i)

################################################################################################################################
#####################  Drop all interaction terms ##############################################################################

fit.3j<-gls(r6~D.60.May.June.ed+I(FHS.lag.2.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.3j)
D<-resid(fit.3j)
plot(D)
AIC(fit.3j)
AICc(fit.3j)

################################################################################################################################
##################### AS EXPERIMENT: Drop pdos ##############################################################################

fit.3jj<-gls(r6~D.60.May.June.ed+I(FHS.lag.2.ed^2)+AO.ed,correlation=corAR1(),method="ML")
summary(fit.3jj)
D<-resid(fit.3jj)
plot(D)
AIC(fit.3jj)
AICc(fit.3jj)
################################################################################################################################
#####################  Drop all interaction terms and swap FHS lag 1 in ##############################################################################

fit.3jjj<-gls(r6~D.60.May.June.ed+I(FHS.lag.1.ed^2)+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.3jjj)
D<-resid(fit.3jjj)
plot(D)
AIC(fit.3jjj)
AICc(fit.3jjj)

################################################################################################################################
#####################  Drop all interaction terms and 60 degree and swap FHS lag 1 in ##############################################################################

fit.3jjjj<-gls(r6~I(FHS.lag.1.ed^2)+AO.ed,correlation=corAR1(),method="ML")
summary(fit.3jjjj)
D<-resid(fit.3jjjj)
plot(D)
AIC(fit.3jjjj)
AICc(fit.3jjjj)
###############################################################################################################################
##################### Add May-June SST #########################################################################################

fit.3k<-gls(r6~D.60.May.June.ed+I(FHS.lag.2.ed^2)+May.June.ed+AO.ed+pdos.ed,correlation=corAR1(),method="ML")
summary(fit.3k)
D<-resid(fit.3k)
plot(D)

AIC(fit.3k)
AICc(fit.3k)

################################################################################################################################
##################### Add interaction term for FHS and May-June -90 #########################################################################################

fit.3m<-gls(r6~D.60.May.June.ed+I(FHS.lag.2.ed^2)+May.June.ed+AO.ed+pdos.ed+D.60.May.June.ed*I(FHS.lag.2.ed^2),correlation=corAR1(),method="ML")
summary(fit.3m)
D<-resid(fit.3m)
plot(D)

AIC(fit.3m)
AICc(fit.3m)

################################################################################################################################
##################### Add interaction term for FHS and May-June -90 and swap in lag 1 FHS #########################################################################################

fit.3mm<-gls(r6~D.60.May.June.ed+I(FHS.lag.1.ed^2)+May.June.ed+AO.ed+pdos.ed+D.60.May.June.ed*I(FHS.lag.1.ed^2),correlation=corAR1(),method="ML")
summary(fit.3mm)
D<-resid(fit.3mm)
plot(D)

AIC(fit.3mm)
AICc(fit.3mm)



























#################################################################################################################################
fit.4<-gls(r~D.neg.90.May.June+I(FHS.lag.2^2)+May.June.anom+D.neg.75.May.June+D.neg.90.May.June*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.4)
D<-resid(fit.4)
plot(D)

############################################################################################################################
##################### target D.neg.75 in interaction term + drop SST terms + add lag 1 FHS effect ##########################

fit.5<-gls(r~I(FHS.lag.2^2)+I(FHS.lag.1^2)+D.neg.75.May.June+D.neg.75.May.June*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.5)
D<-resid(fit.5)
plot(D)

################################################################################################################################
##################### add lag 1 and 2 FHS interaction term #####################################################################

fit.6<-gls(r~I(FHS.lag.2^2)*I(FHS.lag.1^2)+I(FHS.lag.2^2)+I(FHS.lag.1^2)+D.neg.75.May.June+D.neg.75.May.June*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.6)
D<-resid(fit.6)
plot(D)

############################################################################################################################
###################### remove lag 2 FHS ###################################################################################

fit.7<-gls(r~I(FHS.lag.1^2)+D.neg.75.May.June+D.neg.75.May.June*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.7)
D<-resid(fit.7)
plot(D)
aic.7<-AIC(fit.7)
aic.7


###############################################################################################################################
##################### Drop minus 75 degree component-FHS lag 1 interaction, add minus 60 degree component #####################


fit.7<-gls(r~I(FHS.lag.1^2)+D.neg.75.May.June+D.neg.60.May.June,correlation=corAR1(),method="ML")
summary(fit.7)
D<-resid(fit.7)
plot(D)

 
###############################################################################################################################
##################### drop minus 75 and 60 degree components and add May-June SST anomaly and male 3 year rolling average #######
fit.8<-gls(r~I(FHS.lag.2^2)+May.June.anom+RA.3.males,correlation=corAR1())
summary(fit.8)




###############################################################################################################################
################### Drop minus 90 degree component and add minus 75 degree component #########################################
fit.10<-gls(r~D.neg.75.May.June+I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.10)
D<-resid(fit.10)
plot(D)

###############################################################################################################################
################### Add interaction term between minus 75 degree component and lag 2 FHS ######################################
fit.11<-gls(r~D.neg.75.May.June+I(FHS.lag.2^2)+D.neg.75.May.June*I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.11)
D<-resid(fit.11)
plot(D)

###############################################################################################################################
################### drop neg 75 and interaction term and add minus 60 degree component #######################################

fit.12<-gls(r~D.neg.60.May.June+I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.12)
D<-resid(fit.12)
plot(D)

###############################################################################################################################
################### Add interaction term between minus 60 degree component and lag 2 FHS ######################################
fit.13<-gls(r~D.neg.60.May.June+I(FHS.lag.2^2)+D.neg.60.May.June*I(FHS.lag.2^2),correlation=corAR1(),method="ML")
summary(fit.13)
D<-resid(fit.13)
plot(D)


###############################################################################################################################
################## Substitute lag 1 FHS for lag 2 FHS #########################################################################
fit.16<-gls(r~D.neg.60.May.June+I(FHS.lag.1^2)+D.neg.60.May.June*I(FHS.lag.1^1),correlation=corAR1(),method="ML")
summary(fit.16)
D<-resid(fit.16)
plot(D)



###############################################################################################################################
fit.19<-gls(r~D.neg.60.May.June+I(FHS.lag.1^2)+D.neg.60.May.June*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.19)
D<-resid(fit.19)
plot(D)


###############################################################################################################################
fit.20<-gls(r~D.neg.60.May.June+I(FHS.lag.1^2)+D.neg.60.May.June*I(FHS.lag.1^1),correlation=corAR1(),method="ML")
summary(fit.20)
D<-resid(fit.20)
plot(D)

#################################################################################################################################
####################### 90 degree component and lag 1 FHS  ######################################################################

fit.21<-gls(r~D.90.May.June+I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.21)
D<-resid(fit.21)
plot(D)

###############################################################################################################################
################## Add interaction term between 90 degree and lag 1 FHS #################################################
fit.22<-gls(r~D.90.May.June+I(FHS.lag.1^2)+D.90.May.June*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.22)
D<-resid(fit.22)
plot(D)


###############################################################################################################################
################## Add lag 2 FHS with interaction terms with 90 degree component and lag 1 FHS #####################################
fit.23<-gls(r~I(FHS.lag.2^2)*I(FHS.lag.1^2)+I(FHS.lag.2^2)+I(FHS.lag.1^2)+D.90.May.June+D.90.May.June*I(FHS.lag.2^2)+D.90.May.June*I(FHS.lag.1^2),correlation=corAR1(),method="ML")
summary(fit.23)
D<-resid(fit.23)
plot(D)













##############################################################################################################################
#################################### GLM models ##############################################################################
fit.1<-glm(r~D.neg.90.May.June+I(FHS.lag.2^2)+May.June.anom+D.neg.75.May.June)
summary(fit.1)
step(fit.1)
D<-resid(fit.1)
plot(D)

fit.2<-glm(r~I(FHS.lag.2^2)+May.June.anom+D.neg.75.May.June+)
summary(fit.2)
step(fit.2)
D<-resid(fit.2)
plot(D)

fit.3<-glm(r~I(FHS.lag.2^2)+D.neg.75.May.June+D.neg.60.May.June)
summary(fit.3)
step(fit.3)
D<-resid(fit.3)
plot(D)

fit.4<-glm(r~I(FHS.lag.2^2)+I(FHS.lag.1^2)+D.neg.75.May.June+D.neg.60.May.June)
summary(fit.4)
step(fit.4)
D<-resid(fit.4)
plot(D)

fit.5<-glm(r~I(FHS.lag.2^2)+I(FHS.lag.1^2)+D.neg.75.May.June+D.neg.60.May.June+RA.3.males)
summary(fit.5)
step(fit.5)
D<-resid(fit.5)
plot(D)


fit.6<-glm(r~D.neg.90.May.June+I(FHS.lag.1^2)+D.neg.90.May.June*I(FHS.lag.1^2))
summary(fit.6)
step(fit.6)
D<-resid(fit.6)
plot(D)
AIC(step(fit.6))

fit.8<-lm(r~I(FHS.lag.1^2)+I(FHS.lag.1^2)+AO+AO*I(FHS.lag.1^2))
summary(fit.8)
D<-resid(fit.8)
plot(D)

AIC(fit.8)
AICc(fit.8)
